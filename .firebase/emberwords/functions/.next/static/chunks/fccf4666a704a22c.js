(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,57960,(e,t,r)=>{var n={675:function(e,t){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,s=u(e),a=s[0],o=s[1],l=new i((a+o)*3/4-o),h=0,c=o>0?a-4:a;for(r=0;r<c;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;return 2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[h++]=255&t),1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],a=0,o=n-i;a<o;a+=16383)s.push(function(e,t,n){for(var i,s=[],a=t;a<n;a+=3)i=(e[a]<<16&0xff0000)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[i>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}(e,a,a+16383>o?o:a+16383));return 1===i?s.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&s.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};for(var r=[],n=[],i="u">typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)r[a]=s[a],n[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n[45]=62,n[95]=63},72:function(e,t,r){"use strict";var n=r(675),i=r(783),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return h(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e){var n=e,i=t;if(("string"!=typeof i||""===i)&&(i="utf8"),!o.isEncoding(i))throw TypeError("Unknown encoding: "+i);var s=0|f(n,i),u=a(s),l=u.write(n,i);return l!==s&&(u=u.slice(0,l)),u}if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(D(e,ArrayBuffer)||e&&D(e.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(D(e,SharedArrayBuffer)||e&&D(e.buffer,SharedArrayBuffer)))return function(e,t,r){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),o.prototype),n}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var h=e.valueOf&&e.valueOf();if(null!=h&&h!==e)return o.from(h,t,r);var p=function(e){if(o.isBuffer(e)){var t=0|d(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?a(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(p)return p;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),a(e<0?0:0|d(e))}function c(e){for(var t=e.length<0?0:0|d(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!o.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return(l(e),e<=0)?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},o.allocUnsafe=function(e){return h(e)},o.allocUnsafeSlow=function(e){return h(e)};function d(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||D(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return C(e).length;default:if(i)return n?-1:S(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var i,s,a,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=k[e[s]];return i}(this,t,r);case"utf8":case"utf-8":return w(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":return i=this,s=t,a=r,0===s&&a===i.length?n.fromByteArray(i):n.fromByteArray(i.slice(s,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}(this,t,r);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){var s;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(s=r*=1)!=s&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(i)return -1;else r=e.length-1;else if(r<0)if(!i)return -1;else r=0;if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(i)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return y(e,[t],r,n,i)}throw TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var s,a=1,o=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;a=2,o/=2,u/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var h=-1;for(s=r;s<o;s++)if(l(e,s)===l(t,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===u)return h*a}else -1!==h&&(s-=s-h),h=-1}else for(r+u>o&&(r=o-u),s=r;s>=0;s--){for(var c=!0,d=0;d<u;d++)if(l(e,s+d)!==l(t,d)){c=!1;break}if(c)return s}return -1}o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(D(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),D(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:+(n<r)},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(D(s,Uint8Array)&&(s=o.from(s)),!o.isBuffer(s))throw TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?w(this,0,e):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(o.prototype[s]=o.prototype.inspect),o.prototype.compare=function(e,t,r,n,i){if(D(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,a=r-t,u=Math.min(s,a),l=this.slice(n,i),h=e.slice(t,r),c=0;c<u;++c)if(l[c]!==h[c]){s=l[c],a=h[c];break}return s<a?-1:+(a<s)},o.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)};function w(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,a,o,u,l=e[i],h=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(h=l);break;case 2:(192&(s=e[i+1]))==128&&(u=(31&l)<<6|63&s)>127&&(h=u);break;case 3:s=e[i+1],a=e[i+2],(192&s)==128&&(192&a)==128&&(u=(15&l)<<12|(63&s)<<6|63&a)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:s=e[i+1],a=e[i+2],o=e[i+3],(192&s)==128&&(192&a)==128&&(192&o)==128&&(u=(15&l)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}var d=n,f=d.length;if(f<=4096)return String.fromCharCode.apply(String,d);for(var p="",g=0;g<f;)p+=String.fromCharCode.apply(String,d.slice(g,g+=4096));return p}function v(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function b(e,t,r,n,i,s){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function _(e,t,r,n,i,s){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function E(e,t,r,n,s){return t*=1,r>>>=0,s||_(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function I(e,t,r,n,s){return t*=1,r>>>=0,s||_(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i,s,a,o,u,l,h,c,d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var a=0;a<n;++a){var o,u=parseInt(t.substr(2*a,2),16);if((o=u)!=o)break;e[r+a]=u}return a}(this,e,t,r);case"utf8":case"utf-8":return i=t,s=r,A(S(e,this.length-i),this,i,s);case"ascii":return a=t,o=r,A(x(e),this,a,o);case"latin1":case"binary":return function(e,t,r,n){return A(x(t),e,r,n)}(this,e,t,r);case"base64":return u=t,l=r,A(C(e),this,u,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=t,c=r,A(function(e,t){for(var r,n,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i.push(r%256),i.push(n);return i}(e,this.length-h),this,h,c);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return e>>>=0,t||v(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},o.prototype.readInt8=function(e,t){return(e>>>=0,t||v(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||v(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||v(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||v(e,4,this.length),i.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||v(e,4,this.length),i.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||v(e,8,this.length),i.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||v(e,8,this.length),i.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;b(this,e,t,r,i,0)}var s=1,a=0;for(this[t]=255&e;++a<r&&(s*=256);)this[t+a]=e/s&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;b(this,e,t,r,i,0)}var s=r-1,a=1;for(this[t+s]=255&e;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);b(this,e,t,r,i-1,-i)}var s=0,a=1,o=0;for(this[t]=255&e;++s<r&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t>>>=0,!n){var i=Math.pow(2,8*r-1);b(this,e,t,r,i-1,-i)}var s=r-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a|0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||b(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return E(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return E(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return I(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return I(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var s=i-1;s>=0;--s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var i,s=e.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(e=s)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var a=o.isBuffer(e)?e:o.from(e,n),u=a.length;if(0===u)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%u]}return this};var T=/[^+/0-9A-Za-z-_]/g;function S(e,t){t=t||1/0;for(var r,n=e.length,i=null,s=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319||a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function x(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function C(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(T,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function D(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var k=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},783:function(e,t){t.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,u=(1<<o)-1,l=u>>1,h=-7,c=r?i-1:0,d=r?-1:1,f=e[t+c];for(c+=d,s=f&(1<<-h)-1,f>>=-h,h+=o;h>0;s=256*s+e[t+c],c+=d,h-=8);for(a=s&(1<<-h)-1,s>>=-h,h+=n;h>0;a=256*a+e[t+c],c+=d,h-=8);if(0===s)s=1-l;else{if(s===u)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),s-=l}return(f?-1:1)*a*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var a,o,u,l=8*s-i-1,h=(1<<l)-1,c=h>>1,d=5960464477539062e-23*(23===i),f=n?0:s-1,p=n?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(o=+!!isNaN(t),a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+c>=1?t+=d/u:t+=d*Math.pow(2,1-c),t*u>=2&&(a++,u/=2),a+c>=h?(o=0,a=h):a+c>=1?(o=(t*u-1)*Math.pow(2,i),a+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&o,f+=p,o/=256,i-=8);for(a=a<<i|o,l+=i;l>0;e[r+f]=255&a,f+=p,a/=256,l-=8);e[r+f-p]|=128*g}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}},a=!0;try{n[e](r,r.exports,s),a=!1}finally{a&&delete i[e]}return r.exports}s.ab="/ROOT/node_modules/next/dist/compiled/buffer/",t.exports=s(72)},46897,36180,98925,27215,61086,59141,77560,47104,e=>{"use strict";let t,r,n,i=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>i],46897);var s,a,o,u,l,h,c,d,f,p,g,m,y,w,v,b,_,E,I,T,S=e.i(47167);let x=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},C=function(e){let t=[],r=0,n=0;for(;r<e.length;){let i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=((7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},A={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,u=o?e[t+2]:0,l=i>>2,h=(3&i)<<4|a>>4,c=(15&a)<<2|u>>6,d=63&u;!o&&(d=64,s||(c=64)),n.push(r[l],r[h],r[c],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(x(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):C(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let i=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new D;let u=i<<2|s>>4;if(n.push(u),64!==a){let e=s<<4&240|a>>2;if(n.push(e),64!==o){let e=a<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class D extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let k=function(e){let t=x(e);return A.encodeByteArray(t,!0)},N=function(e){return k(e).replace(/\./g,"")},R=function(e){try{return A.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function O(){return"u">typeof self?self:"u">typeof window?window:e.g}let L=()=>{try{return O().__FIREBASE_DEFAULTS__||(()=>{if(void 0===S.default||void 0===S.default.env)return;let e=S.default.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("u"<typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&R(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},M=e=>{let t=L()?.emulatorHosts?.[e];if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]},P=()=>L()?.config;class F{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function V(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function U(e){return(await fetch(e,{credentials:"include"})).ok}function B(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[N(JSON.stringify({alg:"none",type:"JWT"})),N(JSON.stringify(s)),""].join(".")}let q={},j=!1;function z(e,t){if("u"<typeof window||"u"<typeof document||!V(window.location.host)||q[e]===t||q[e]||j)return;function r(e){return`__firebase__banner__${e}`}q[e]=t;let n="__firebase__banner",i=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(q))q[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(n),t=!1,e||((e=document.createElement("div")).setAttribute("id",n),t=!0),{created:t,element:e}),a=r("text"),o=document.getElementById(a)||document.createElement("span"),u=r("learnmore"),l=document.getElementById(u)||document.createElement("a"),h=r("preprendIcon"),c=document.getElementById(h)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e,t=s.element;t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center",l.setAttribute("id",u),l.innerText="Learn more",l.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",l.setAttribute("target","__blank"),l.style.paddingLeft="5px",l.style.textDecoration="underline";let r=((e=document.createElement("span")).style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{let e;j=!0,(e=document.getElementById(n))&&e.remove()},e);c.setAttribute("width","24"),c.setAttribute("id",h),c.setAttribute("height","24"),c.setAttribute("viewBox","0 0 24 24"),c.setAttribute("fill","none"),c.style.marginLeft="-6px",t.append(c,o,l,r),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",c.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(c.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,o.innerText="Preview backend running in this workspace."),o.setAttribute("id",a)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function $(){return"u">typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function K(){let t=L()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}function G(){return"u">typeof WorkerGlobalScope&&"u">typeof self&&self instanceof WorkerGlobalScope}function H(){return!K()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Q(){return!K()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function W(){try{return"object"==typeof indexedDB}catch(e){return!1}}class J extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,J.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Y.prototype.create)}}class Y{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,n;let i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?(r=a,n=i,r.replace(X,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",u=`${this.serviceName}: ${o} (${s}).`;return new J(s,u,i)}}let X=/\{\$([^}]+)}/g;function Z(e,t){if(e===t)return!0;let r=Object.keys(e),n=Object.keys(t);for(let i of r){if(!n.includes(i))return!1;let r=e[i],s=t[i];if(ee(r)&&ee(s)){if(!Z(r,s))return!1}else if(r!==s)return!1}for(let e of n)if(!r.includes(e))return!1;return!0}function ee(e){return null!==e&&"object"==typeof e}function et(e){return e&&e._delegate?e._delegate:e}class er{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let en="[DEFAULT]";class ei{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new F;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:en})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=en){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=en){return this.instances.has(e)}getOptions(e=en){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),n=this.onInitCallbacks.get(r)??new Set;n.add(e),this.onInitCallbacks.set(r,n);let i=this.instances.get(r);return i&&e(i,r),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let n of r)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===en?void 0:r,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=en){return this.component?this.component.multipleInstances?e:en:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class es{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ei(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let ea=[];(s=u||(u={}))[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT";let eo={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},eu=u.INFO,el={[u.DEBUG]:"log",[u.VERBOSE]:"log",[u.INFO]:"info",[u.WARN]:"warn",[u.ERROR]:"error"},eh=(e,t,...r)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),i=el[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ec{constructor(e){this.name=e,this._logLevel=eu,this._logHandler=eh,this._userLogHandler=null,ea.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in u))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?eo[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,u.DEBUG,...e),this._logHandler(this,u.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,u.VERBOSE,...e),this._logHandler(this,u.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,u.INFO,...e),this._logHandler(this,u.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,u.WARN,...e),this._logHandler(this,u.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,u.ERROR,...e),this._logHandler(this,u.ERROR,...e)}}let ed=new WeakMap,ef=new WeakMap,ep=new WeakMap,eg=new WeakMap,em=new WeakMap,ey={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return ef.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ep.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ew(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ew(e){if(e instanceof IDBRequest){let t;return(t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(ew(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)})).then(t=>{t instanceof IDBCursor&&ed.set(t,e)}).catch(()=>{}),em.set(t,e),t}if(eg.has(e))return eg.get(e);let n=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ev(this),t),ew(ed.get(this))}:function(...t){return ew(e.apply(ev(this),t))}:function(t,...r){let n=e.call(ev(this),t,...r);return ep.set(n,t.sort?t.sort():[t]),ew(n)};return e instanceof IDBTransaction&&function(e){if(ef.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});ef.set(e,t)}(e),(t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,ey):e}(e);return n!==e&&(eg.set(e,n),em.set(n,e)),n}let ev=e=>em.get(e),eb=["get","getKey","getAll","getAllKeys","count"],e_=["put","add","delete","clear"],eE=new Map;function eI(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(eE.get(t))return eE.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=e_.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||eb.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),a=s.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),i&&s.done]))[0]};return eE.set(t,s),s}ey={...n=ey,get:(e,t,r)=>eI(e,t)||n.get(e,t,r),has:(e,t)=>!!eI(e,t)||n.has(e,t)};class eT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if(t=e.getComponent(),t?.type!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let eS="@firebase/app",ex="0.14.7",eC=new ec("@firebase/app"),eA="[DEFAULT]",eD={[eS]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ek=new Map,eN=new Map,eR=new Map;function eO(e,t){try{e.container.addComponent(t)}catch(r){eC.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function eL(e,t){e.container.addOrOverwriteComponent(t)}function eM(e){let t=e.name;if(eR.has(t))return eC.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(eR.set(t,e),ek.values()))eO(r,e);for(let t of eN.values())eO(t,e);return!0}function eP(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function eF(e,t,r=eA){eP(e,t).clearInstance(r)}function eV(e){return void 0!==e.options}function eU(e){return!eV(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}function eB(e){return null!=e&&void 0!==e.settings}function eq(){eR.clear()}let ej=new Y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ez{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new er("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ej.create("app-deleted",{appName:this._name})}}function e$(e,t){let r=R(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class eK extends ez{constructor(e,t,r,n){const i=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:i};void 0!==e.apiKey?super(e,s,n):super(e.options,s,n),this._serverConfig={automaticDataCollectionEnabled:i,...t},this._serverConfig.authIdToken&&e$(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&e$(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"u">typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,eX(eS,ex,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){eY(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ej.create("server-app-deleted")}}let eG="12.8.0";function eH(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let n={name:eA,automaticDataCollectionEnabled:!0,...t},i=n.name;if("string"!=typeof i||!i)throw ej.create("bad-app-name",{appName:String(i)});if(r||(r=P()),!r)throw ej.create("no-options");let s=ek.get(i);if(s)if(Z(r,s.options)&&Z(n,s.config))return s;else throw ej.create("duplicate-app",{appName:i});let a=new es(i);for(let e of eR.values())a.addComponent(e);let o=new ez(r,n,a);return ek.set(i,o),o}function eQ(e,t={}){let r;if(("u">typeof window||G())&&!G())throw ej.create("invalid-server-app-environment");let n=t||{};if(e&&(eV(e)?r=e.options:eU(e)?n=e:r=e),void 0===n.automaticDataCollectionEnabled&&(n.automaticDataCollectionEnabled=!0),r||(r=P()),!r)throw ej.create("no-options");let i={...n,...r};if(void 0!==i.releaseOnDeref&&delete i.releaseOnDeref,void 0!==n.releaseOnDeref&&"u"<typeof FinalizationRegistry)throw ej.create("finalization-registry-not-supported",{});let s=""+[...JSON.stringify(i)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),a=eN.get(s);if(a)return a.incRefCount(n.releaseOnDeref),a;let o=new es(s);for(let e of eR.values())o.addComponent(e);let u=new eK(r,n,s,o);return eN.set(s,u),u}function eW(e=eA){let t=ek.get(e);if(!t&&e===eA&&P())return eH();if(!t)throw ej.create("no-app",{appName:e});return t}function eJ(){return Array.from(ek.values())}async function eY(e){let t=!1,r=e.name;ek.has(r)?(t=!0,ek.delete(r)):eN.has(r)&&0>=e.decRefCount()&&(eN.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function eX(e,t,r){let n=eD[e]??e;r&&(n+=`-${r}`);let i=n.match(/\s|\//),s=t.match(/\s|\//);if(i||s){let e=[`Unable to register library "${n}" with version "${t}":`];i&&e.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),eC.warn(e.join(" "));return}eM(new er(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}function eZ(e,t){if(null!==e&&"function"!=typeof e)throw ej.create("invalid-log-argument");for(let r of ea){let n=null;t&&t.level&&(n=eo[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...i)=>{let s=i.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(n??t.logLevel)&&e({level:u[r].toLowerCase(),message:s,args:i,type:t.name})}}}function e0(e){ea.forEach(t=>{t.setLogLevel(e)})}let e1="firebase-heartbeat-store",e2=null;function e3(){return e2||(e2=(function(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(e,1),o=ew(a);return n&&a.addEventListener("upgradeneeded",e=>{n(ew(a.result),e.oldVersion,e.newVersion,ew(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(e1)}catch(e){console.warn(e)}}}).catch(e=>{throw ej.create("idb-open",{originalErrorMessage:e.message})})),e2}async function e8(e){try{let t=(await e3()).transaction(e1),r=await t.objectStore(e1).get(e4(e));return await t.done,r}catch(e){if(e instanceof J)eC.warn(e.message);else{let t=ej.create("idb-get",{originalErrorMessage:e?.message});eC.warn(t.message)}}}async function e6(e,t){try{let r=(await e3()).transaction(e1,"readwrite"),n=r.objectStore(e1);await n.put(t,e4(e)),await r.done}catch(e){if(e instanceof J)eC.warn(e.message);else{let t=ej.create("idb-set",{originalErrorMessage:e?.message});eC.warn(t.message)}}}function e4(e){return`${e.name}!${e.options.appId}`}class e5{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new e9(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=e7();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){eC.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=e7(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){let r=[],n=e.slice();for(let i of e){let e=r.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),te(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),te(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),n=N(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(e){return eC.warn(e),""}}}function e7(){return new Date().toISOString().substring(0,10)}class e9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!W()&&new Promise((e,t)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}}).then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await e8(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return e6(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return e6(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function te(e){return N(JSON.stringify({version:2,heartbeats:e})).length}eM(new er("platform-logger",e=>new eT(e),"PRIVATE")),eM(new er("heartbeat",e=>new e5(e),"PRIVATE")),eX(eS,ex,""),eX(eS,ex,"esm2020"),eX("fire-js",""),e.s(["SDK_VERSION",()=>eG,"_DEFAULT_ENTRY_NAME",()=>eA,"_addComponent",()=>eO,"_addOrOverwriteComponent",()=>eL,"_apps",()=>ek,"_clearComponents",()=>eq,"_components",()=>eR,"_getProvider",()=>eP,"_isFirebaseApp",()=>eV,"_isFirebaseServerApp",()=>eB,"_isFirebaseServerAppSettings",()=>eU,"_registerComponent",()=>eM,"_removeServiceInstance",()=>eF,"_serverApps",()=>eN,"deleteApp",()=>eY,"getApp",()=>eW,"getApps",()=>eJ,"initializeApp",()=>eH,"initializeServerApp",()=>eQ,"onLog",()=>eZ,"registerVersion",()=>eX,"setLogLevel",()=>e0],92953),eX("firebase","12.8.0","app"),e.i(92953);var tt=e.i(57960),tr="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,tn={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var t=function(){this.blockSize=-1};function r(){}function n(e,t,r){r||(r=0);let n=Array(16);if("string"==typeof t)for(var i=0;i<16;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;i<16;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];let s=e.g[3],a;a=t+(s^r&(i^s))+n[0]+0xd76aa478|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[1]+0xe8c7b756|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[2]+0x242070db|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[3]+0xc1bdceee|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[4]+0xf57c0faf|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[5]+0x4787c62a|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[6]+0xa8304613|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[7]+0xfd469501|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[8]+0x698098d8|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[9]+0x8b44f7af|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[10]+0xffff5bb1|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[11]+0x895cd7be|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[12]+0x6b901122|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[13]+0xfd987193|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[14]+0xa679438e|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[15]+0x49b40821|0,r=i+(a<<22|a>>>10),a=t+(i^s&(r^i))+n[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[11]+0x265e5a51|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[0]+0xe9b6c7aa|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[15]+0xd8a1e681|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[4]+0xe7d3fbc8|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[3]+0xf4d50d87|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[8]+0x455a14ed|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[7]+0x676f02d9|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[12]+0x8d2a4c8a|0,a=t+((r=i+(a<<20|a>>>12))^i^s)+n[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[8]+0x8771f681|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[11]+0x6d9d6122|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[14]+0xfde5380c|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[4]+0x4bdecfa9|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[7]+0xf6bb4b60|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[10]+0xbebfbc70|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[0]+0xeaa127fa|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[3]+0xd4ef3085|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[6]+0x4881d05|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[12]+0xe6db99e5|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[15]+0x1fa27cf8|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[2]+0xc4ac5665|0,r=i+(a<<23|a>>>9),a=t+(i^(r|~s))+n[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[14]+0xab9423a7|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[5]+0xfc93a039|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[10]+0xffeff47d|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[1]+0x85845dd1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[6]+0xa3014314|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[13]+0x4e0811a1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[2]+0x2ad7d2bb|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(i+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+i|0,e.g[3]=e.g[3]+s|0}function i(e,t){this.h=t;let r=[],n=!0;for(let i=e.length-1;i>=0;i--){let s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}r.prototype=t.prototype,e.F=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.D=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)},e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,t){void 0===t&&(t=e.length);let r=t-this.blockSize,i=this.C,s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let n=0;n<32;n+=8)e[t++]=this.g[r]>>>n&255;return e};var s,a={};function o(e){var t;return -128<=e&&e<128?(t=function(e){return new i([0|e],e<0?-1:0)},Object.prototype.hasOwnProperty.call(a,e)?a[e]:a[e]=t(e)):new i([0|e],e<0?-1:0)}function u(e){if(isNaN(e)||!isFinite(e))return c;if(e<0)return m(u(-e));let t=[],r=1;for(let n=0;e>=r;n++)t[n]=e/r|0,r*=0x100000000;return new i(t,0)}var c=o(0),d=o(1),f=o(0x1000000);function p(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function g(e){return -1==e.h}function m(e){let t=e.g.length,r=[];for(let n=0;n<t;n++)r[n]=~e.g[n];return new i(r,~e.h).add(d)}function y(e,t){return e.add(m(t))}function w(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function b(e,t){if(p(t))throw Error("division by zero");if(p(e))return new v(c,c);if(g(e))return t=b(m(e),t),new v(m(t.g),m(t.h));if(g(t))return t=b(e,m(t)),new v(m(t.g),t.h);if(e.g.length>30){if(g(e)||g(t))throw Error("slowDivide_ only works with positive integers.");for(var r=d,n=t;0>=n.l(e);)r=_(r),n=_(n);var i=E(r,1),s=E(n,1);for(n=E(n,2),r=E(r,2);!p(n);){var a=s.add(n);0>=a.l(e)&&(i=i.add(r),s=a),n=E(n,1),r=E(r,1)}return t=y(e,i.j(t)),new v(i,t)}for(i=c;e.l(t)>=0;){for(n=(n=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,n-48),a=(s=u(r)).j(t);g(a)||a.l(e)>0;)r-=n,a=(s=u(r)).j(t);p(s)&&(s=d),i=i.add(s),e=y(e,a)}return new v(i,e)}function _(e){let t=e.g.length+1,r=[];for(let n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new i(r,e.h)}function E(e,t){let r=t>>5;t%=32;let n=e.g.length-r,s=[];for(let i=0;i<n;i++)s[i]=t>0?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new i(s,e.h)}(s=i.prototype).m=function(){if(g(this))return-m(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let n=this.i(r);e+=(n>=0?n:0x100000000+n)*t,t*=0x100000000}return e},s.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(g(this))return"-"+m(this).toString(e);let t=u(Math.pow(e,6));var r=this;let n="";for(;;){let i=b(r,t).g,s=(((r=y(r,i.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(p(r=i))return s+n;for(;s.length<6;)s="0"+s;n=s+n}},s.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},s.l=function(e){return g(e=y(this,e))?-1:+!p(e)},s.abs=function(){return g(this)?m(this):this},s.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],n=0;for(let i=0;i<=t;i++){let t=n+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);n=s>>>16,t&=65535,s&=65535,r[i]=s<<16|t}return new i(r,-0x80000000&r[r.length-1]?-1:0)},s.j=function(e){if(p(this)||p(e))return c;if(g(this))return g(e)?m(this).j(m(e)):m(m(this).j(e));if(g(e))return m(this.j(m(e)));if(0>this.l(f)&&0>e.l(f))return u(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(let t=0;t<e.g.length;t++){let i=this.i(n)>>>16,s=65535&this.i(n),a=e.i(t)>>>16,o=65535&e.i(t);r[2*n+2*t]+=s*o,w(r,2*n+2*t),r[2*n+2*t+1]+=i*o,w(r,2*n+2*t+1),r[2*n+2*t+1]+=s*a,w(r,2*n+2*t+1),r[2*n+2*t+2]+=i*a,w(r,2*n+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new i(r,0)},s.B=function(e){return b(this,e).h},s.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new i(r,this.h&e.h)},s.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new i(r,this.h|e.h)},s.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new i(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,h=tn.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=u,i.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return m(e(t.substring(1),r));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');let n=u(Math.pow(r,8)),i=c;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);let a=parseInt(t.substring(e,e+s),r);s<8?(s=u(Math.pow(r,s)),i=i.j(s).add(u(a))):i=(i=i.j(n)).add(u(a))}return i},l=tn.Integer=i}).apply(void 0!==tr?tr:"u">typeof self?self:"u">typeof window?window:{});var ti="u">typeof globalThis?globalThis:"u">typeof window?window:e.g,ts={};(function(){var e,t,r=Object.defineProperty,n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ti&&ti];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function i(e,t){if(t)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&r(i,e,{configurable:!0,writable:!0,value:t})}}i("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(e){return e||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push([t,e[t]]);return r}});var s=s||{},a=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function u(e,t,r){return e.call.apply(e.bind,arguments)}function l(e,t,r){return(l=u).apply(null,arguments)}function h(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function v(e,t){function r(){}r.prototype=t.prototype,e.Z=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Ob=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}var b="u">typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function _(e){let t=e.length;if(t>0){let r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function E(e,t){for(let t=1;t<arguments.length;t++){let n=arguments[t];var r=typeof n;if("array"==(r="object"!=r?r:n?Array.isArray(n)?"array":r:"null")||"object"==r&&"number"==typeof n.length){r=e.length||0;let t=n.length||0;e.length=r+t;for(let i=0;i<t;i++)e[r+i]=n[i]}else e.push(n)}}var I=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new T,e=>e.reset());class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let S,x=!1,C=new class{constructor(){this.h=this.g=null}add(e,t){let r=I.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},A=()=>{let e=Promise.resolve(void 0);S=()=>{e.then(D)}};function D(){let e;for(var t;e=null,C.g&&(e=C.g,C.g=C.g.next,C.g||(C.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(e){!function(e){a.setTimeout(()=>{throw e},0)}(e)}I.j(t),I.h<100&&(I.h++,t.next=I.g,I.g=t)}x=!1}function k(){this.u=this.u,this.C=this.C}function N(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},N.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(e){}return e}();function O(e){return/^[\s\xa0]*$/.test(e)}function L(e,t){N.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}v(L,N),L.prototype.init=function(e,t){let r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement)),this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&L.Z.h.call(this)},L.prototype.h=function(){L.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),P=0;function F(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++P,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function U(e,t,r){for(let n in e)t.call(r,e[n],n,e)}function B(e){let t={};for(let r in e)t[r]=e[r];return t}let q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(e,t){let r,n;for(let t=1;t<arguments.length;t++){for(r in n=arguments[t])e[r]=n[r];for(let t=0;t<q.length;t++)r=q[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function z(e){this.src=e,this.g={},this.h=0}function $(e,t){let r=t.type;if(r in e.g){var n,i=e.g[r],s=Array.prototype.indexOf.call(i,t,void 0);(n=s>=0)&&Array.prototype.splice.call(i,s,1),n&&(V(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function K(e,t,r,n){for(let i=0;i<e.length;++i){let s=e[i];if(!s.da&&s.listener==t&&!!r==s.capture&&s.ha==n)return i}return -1}z.prototype.add=function(e,t,r,n,i){let s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);let a=K(e,t,n,i);return a>-1?(t=e[a],r||(t.fa=!1)):((t=new F(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var G="closure_lm_"+(1e6*Math.random()|0),H={};function Q(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");let a=o(i)?!!i.capture:!!i,u=X(e);if(u||(e[G]=u=new z(e)),(r=u.add(t,r,n,a,s)).proxy)return r;if(n=function e(t){return Y.call(e.src,e.listener,t)},r.proxy=n,n.src=e,n.listener=r,e.addEventListener)R||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function W(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])$(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(J(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=X(t))?($(r,e),0==r.h&&(r.src=null,t[G]=null)):V(e)}}}function J(e){return e in H?H[e]:H[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new L(t,this);let r=e.listener,n=e.ha||e.src;e.fa&&W(e),e=r.call(n,t)}return e}function X(e){return(e=e[G])instanceof z?e:null}var Z="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(e){return"function"==typeof e?e:(e[Z]||(e[Z]=function(t){return e.handleEvent(t)}),e[Z])}function et(){k.call(this),this.i=new z(this),this.M=this,this.G=null}function er(e,t){let r,n;var i,s=e.G;if(s)for(i=[];s;s=s.G)i.push(s);if(e=e.M,s=t.type||t,"string"==typeof t)t=new N(t,e);else if(t instanceof N)t.target=t.target||e;else{var a=t;j(t=new N(s,e),a)}if(a=!0,i)for(n=i.length-1;n>=0;n--)a=en(r=t.g=i[n],s,!0,t)&&a;if(a=en(r=t.g=e,s,!0,t)&&a,a=en(r,s,!1,t)&&a,i)for(n=0;n<i.length;n++)a=en(r=t.g=i[n],s,!1,t)&&a}function en(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){let a=t[s];if(a&&!a.da&&a.capture==r){let t=a.listener,r=a.ha||a.src;a.fa&&$(e.i,a),i=!1!==t.call(r,n)&&i}}return i&&!n.defaultPrevented}v(et,k),et.prototype[M]=!0,et.prototype.removeEventListener=function(e,t,r,n){!function e(t,r,n,i,s){if(Array.isArray(r))for(var a=0;a<r.length;a++)e(t,r[a],n,i,s);else(i=o(i)?!!i.capture:!!i,n=ee(n),t&&t[M])?(t=t.i,(a=String(r).toString())in t.g&&(n=K(r=t.g[a],n,i,s))>-1&&(V(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[a],t.h--))):t&&(t=X(t))&&(r=t.g[r.toString()],t=-1,r&&(t=K(r,n,i,s)),(n=t>-1?r[t]:null)&&W(n))}(this,e,t,r,n)},et.prototype.N=function(){if(et.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let r=e.g[t];for(let e=0;e<r.length;e++)V(r[e]);delete e.g[t],e.h--}}this.G=null},et.prototype.J=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},et.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class ei extends k{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=function(e,t){if("function"!=typeof e)if(e&&"function"==typeof e.handleEvent)e=l(e.handleEvent,e);else throw Error("Invalid listener argument");return Number(t)>0x7fffffff?-1:a.setTimeout(e,t||0)}(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);let r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function es(e){k.call(this),this.h=e,this.g={}}v(es,k);var ea=[];function eo(e){U(e.g,function(e,t){this.g.hasOwnProperty(t)&&W(e)},e),e.g={}}es.prototype.N=function(){es.Z.N.call(this),eo(this)},es.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var eu=a.JSON.stringify,el=a.JSON.parse,eh=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function ec(){}function ed(){}var ef={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ep(){N.call(this,"d")}function eg(){N.call(this,"c")}v(ep,N),v(eg,N);var em={},ey=null;function ew(){return ey=ey||new et}function ev(e){N.call(this,em.Ia,e)}function eb(e){let t=ew();er(t,new ev(t))}function e_(e,t){N.call(this,em.STAT_EVENT,e),this.stat=t}function eE(e){let t=ew();er(t,new e_(t,e))}function eI(e,t){N.call(this,em.Ja,e),this.size=t}function eT(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function eS(){this.g=!0}function ex(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{let s=JSON.parse(t);if(s){for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var r=s[e];if(!(r.length<2)){var n=r[1];if(Array.isArray(n)&&!(n.length<1)){var i=n[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<n.length;e++)n[e]=""}}}}return eu(s)}catch(e){return t}}(e,r)+(n?" "+n:"")})}em.Ia="serverreachability",v(ev,N),em.STAT_EVENT="statevent",v(e_,N),em.Ja="timingevent",v(eI,N),eS.prototype.ua=function(){this.g=!1},eS.prototype.info=function(){};var eC={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},eA={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function eD(){}function ek(e){return encodeURIComponent(String(e))}function eN(e,t,r,n){this.j=e,this.i=t,this.l=r,this.S=n||1,this.V=new es(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new eR}function eR(){this.i=null,this.g="",this.h=!1}v(eD,ec),eD.prototype.g=function(){return new XMLHttpRequest},e=new eD;var eO={},eL={};function eM(e,t,r){e.M=1,e.A=e6(e0(t)),e.u=r,e.R=!0,eP(e,null)}function eP(e,t){e.F=Date.now(),eV(e),e.B=e0(e.A);var r,n,i,s,a,u,h=e.B,c=e.S;Array.isArray(c)||(c=[String(c)]),tc(h.i,"t",c),e.C=0,h=e.j.L,e.h=new eR,e.g=tY(e.j,h?t:null,!e.u),e.P>0&&(e.O=new ei(l(e.Y,e,e.g),e.P)),t=e.V,h=e.g,c=e.ba;var d="readystatechange";Array.isArray(d)||(d&&(ea[0]=d.toString()),d=ea);for(let e=0;e<d.length;e++){let r=function e(t,r,n,i,s){if(i&&i.once)return function e(t,r,n,i,s){if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=ee(n),t&&t[M]?t.K(r,n,o(i)?!!i.capture:!!i,s):Q(t,r,n,!0,i,s)}(t,r,n,i,s);if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=ee(n),t&&t[M]?t.J(r,n,o(i)?!!i.capture:!!i,s):Q(t,r,n,!1,i,s)}(h,d[e],c||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}t=e.J?B(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),eb(),r=e.i,n=e.v,i=e.B,s=e.l,a=e.S,u=e.u,r.info(function(){if(r.g)if(u){var e="",t=u.split("&");for(let r=0;r<t.length;r++){var o=t[r].split("=");if(o.length>1){let t=o[0];o=o[1];let r=t.split("_");e=r.length>=2&&"type"==r[1]?e+(t+"=")+o+"&":e+(t+"=redacted&")}}}else e=null;else e=u;return"XMLHTTP REQ ("+s+") [attempt "+a+"]: "+n+"\n"+i+"\n"+e})}function eF(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function eV(e){e.T=Date.now()+e.H,eU(e,e.H)}function eU(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=eT(l(e.aa,e),t)}function eB(e){e.D&&(a.clearTimeout(e.D),e.D=null)}function eq(e){0==e.j.I||e.K||tG(e.j,e)}function ej(e){eB(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,eo(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function ez(e,t){try{var r=e.j;if(0!=r.I&&(r.g==e||eQ(r.h,e))){if(!e.L&&eQ(r.h,e)&&3==r.I){try{var n=r.Ba.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.v){if(r.g)if(r.g.F+3e3<e.F)tK(r),tM(r);else break e;tj(r),eE(18)}}else r.xa=i[1],0<r.xa-r.K&&i[2]<37500&&r.F&&0==r.A&&!r.C&&(r.C=eT(l(r.Va,r),6e3));1>=eH(r.h)&&r.ta&&(r.ta=void 0)}else tQ(r,11)}else if((e.L||r.g==e)&&tK(r),!O(t))for(i=r.Ba.g.parse(t),t=0;t<i.length;t++){let o=i[t],u=o[0];if(!(u<=r.K))if(r.K=u,o=o[1],2==r.I)if("c"==o[0]){r.M=o[1],r.ba=o[2];let t=o[3];null!=t&&(r.ka=t,r.j.info("VER="+r.ka));let i=o[4];null!=i&&(r.za=i,r.j.info("SVER="+r.za));let u=o[5];null!=u&&"number"==typeof u&&u>0&&(r.O=n=1.5*u,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;let l=e.g;if(l){let e=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(eW(s,s.h),s.h=null))}if(n.G){let e=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.wa=e,e8(n.J,n.G,e))}}if(r.I=3,r.l&&r.l.ra(),r.aa&&(r.T=Date.now()-e.F,r.j.info("Handshake RTT: "+r.T+"ms")),(n=r).na=tJ(n,n.L?n.ba:null,n.W),e.L){eJ(n.h,e);var a=n.O;a&&(e.H=a),e.D&&(eB(e),eV(e)),n.g=e}else tq(n);r.i.length>0&&tF(r)}else"stop"!=o[0]&&"close"!=o[0]||tQ(r,7);else 3==r.I&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?tQ(r,7):tL(r):"noop"!=o[0]&&r.l&&r.l.qa(o),r.A=0)}}eb(4)}catch(e){}}eN.prototype.ba=function(e){e=e.target;let t=this.O;t&&3==tk(e)?t.j():this.Y(e)},eN.prototype.Y=function(e){try{if(e==this.g)e:{let f=tk(this.g),p=this.g.ya(),g=this.g.ca();if(!(f<3)&&(3!=f||this.g&&(this.h.h||this.g.la()||tN(this.g)))){this.K||4!=f||7==p||(8==p||g<=0?eb(3):eb(2)),eB(this);var t=this.g.ca();this.X=t;var r=function(e){if(!eF(e))return e.g.la();let t=tN(e.g);if(""===t)return"";let r="",n=t.length,i=4==tk(e.g);if(!e.h.i){if("u"<typeof TextDecoder)return ej(e),eq(e),"";e.h.i=new a.TextDecoder}for(let s=0;s<n;s++)e.h.h=!0,r+=e.h.i.decode(t[s],{stream:!(i&&s==n-1)});return t.length=0,e.h.g+=r,e.C=0,e.h.g}(this);if(this.o=200==t,n=this.i,i=this.v,s=this.B,o=this.l,u=this.S,n.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+u+"]: "+i+"\n"+s+"\n"+f+" "+t}),this.o){if(this.U&&!this.L){t:{if(this.g){var n,i,s,o,u,l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(l)){var c=l;break t}}c=null}if(e=c)ex(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ez(this,e);else{this.o=!1,this.m=3,eE(12),ej(this),eq(this);break e}}if(this.R){let t;for(e=!0;!this.K&&this.C<r.length;)if((t=function(e,t){var r=e.C,n=t.indexOf("\n",r);return -1==n?eL:isNaN(r=Number(t.substring(r,n)))?eO:(n+=1)+r>t.length?eL:(t=t.slice(n,n+r),e.C=n+r,t)}(this,r))==eL){4==f&&(this.m=4,eE(14),e=!1),ex(this.i,this.l,null,"[Incomplete Response]");break}else if(t==eO){this.m=4,eE(15),ex(this.i,this.l,r,"[Invalid Chunk]"),e=!1;break}else ex(this.i,this.l,t,null),ez(this,t);if(eF(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=r.length||this.h.h||(this.m=1,eE(16),e=!1),this.o=this.o&&e,e){if(r.length>0&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.aa&&!d.P&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+r.length),tz(d),d.P=!0,eE(11))}}else ex(this.i,this.l,r,"[Invalid Chunked Response]"),ej(this),eq(this)}else ex(this.i,this.l,r,null),ez(this,r);4==f&&ej(this),this.o&&!this.K&&(4==f?tG(this.j,this):(this.o=!1,eV(this)))}else(function(e){let t={};e=(e.g&&tk(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(O(e[n]))continue;var r=function(e){var t=1;e=e.split(":");let r=[];for(;t>0&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}(e[n]);let i=r[0];if("string"!=typeof(r=r[1]))continue;r=r.trim();let s=t[i]||[];t[i]=s,s.push(r)}var n=function(e){return e.join(", ")};for(let e in t)n.call(void 0,t[e],e,t)})(this.g),400==t&&r.indexOf("Unknown SID")>0?(this.m=3,eE(12)):(this.m=0,eE(13)),ej(this),eq(this)}}}catch(e){}finally{}},eN.prototype.cancel=function(){this.K=!0,ej(this)},eN.prototype.aa=function(){var e,t;this.D=null;let r=Date.now();r-this.T>=0?(e=this.i,t=this.B,e.info(function(){return"TIMEOUT: "+t}),2!=this.M&&(eb(),eE(17)),ej(this),this.m=2,eq(this)):eU(this,this.T-r)};var e$=class{constructor(e,t){this.g=e,this.map=t}};function eK(e){this.l=e||10,e=a.PerformanceNavigationTiming?(e=a.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function eG(e){return!!e.h||!!e.g&&e.g.size>=e.j}function eH(e){return e.h?1:e.g?e.g.size:0}function eQ(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eW(e,t){e.g?e.g.add(t):e.h=t}function eJ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function eY(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let r of e.g.values())t=t.concat(r.G);return t}return _(e.i)}eK.prototype.cancel=function(){if(this.i=eY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eX=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eZ(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof eZ?(this.l=e.l,e1(this,e.j),this.o=e.o,this.g=e.g,e2(this,e.u),this.h=e.h,e3(this,td(e.i)),this.m=e.m):e&&(t=String(e).match(eX))?(this.l=!1,e1(this,t[1]||"",!0),this.o=e4(t[2]||""),this.g=e4(t[3]||"",!0),e2(this,t[4]),this.h=e4(t[5]||"",!0),e3(this,t[6]||"",!0),this.m=e4(t[7]||"")):(this.l=!1,this.i=new ta(null,this.l))}function e0(e){return new eZ(e)}function e1(e,t,r){e.j=r?e4(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function e2(e,t){if(t){if(isNaN(t=Number(t))||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function e3(e,t,r){var n,i;t instanceof ta?(e.i=t,n=e.i,(i=e.l)&&!n.j&&(to(n),n.i=null,n.g.forEach(function(e,t){let r=t.toLowerCase();t!=r&&(tu(this,t),tc(this,r,e))},n)),n.j=i):(r||(t=e5(t,tr)),e.i=new ta(t,e.l))}function e8(e,t,r){e.i.set(t,r)}function e6(e){return e8(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function e4(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function e5(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,e7),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function e7(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}eZ.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(e5(t,e9,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(e5(t,e9,!0),"@"),e.push(ek(r).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.u)&&e.push(":",String(r))),(r=this.h)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(e5(r,"/"==r.charAt(0)?tt:te,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",e5(r,tn)),e.join("")},eZ.prototype.resolve=function(e){let t=e0(this),r=!!e.j;r?e1(t,e.j):r=!!e.o,r?t.o=e.o:r=!!e.g,r?t.g=e.g:r=null!=e.u;var n=e.h;if(r)e2(t,e.u);else if(r=!!e.h){if("/"!=n.charAt(0))if(this.g&&!this.h)n="/"+n;else{var i=t.h.lastIndexOf("/");-1!=i&&(n=t.h.slice(0,i+1)+n)}if(".."==(i=n)||"."==i)n="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){n=0==i.lastIndexOf("/",0),i=i.split("/");let e=[];for(let t=0;t<i.length;){let r=i[t++];"."==r?n&&t==i.length&&e.push(""):".."==r?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),n&&t==i.length&&e.push("")):(e.push(r),n=!0)}n=e.join("/")}else n=i}return r?t.h=n:r=""!==e.i.toString(),r?e3(t,td(e.i)):r=!!e.m,r&&(t.m=e.m),t};var e9=/[#\/\?@]/g,te=/[#\?:]/g,tt=/[#\?]/g,tr=/[#\?@]/g,tn=/#/g;function ta(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function to(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let r=0;r<e.length;r++){let n=e[r].indexOf("="),i,s=null;n>=0?(i=e[r].substring(0,n),s=e[r].substring(n+1)):i=e[r],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function tu(e,t){to(e),t=tf(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tl(e,t){return to(e),t=tf(e,t),e.g.has(t)}function th(e,t){to(e);let r=[];if("string"==typeof t)tl(e,t)&&(r=r.concat(e.g.get(tf(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)r=r.concat(e[t]);return r}function tc(e,t,r){tu(e,t),r.length>0&&(e.i=null,e.g.set(tf(e,t),_(r)),e.h+=r.length)}function td(e){let t=new ta;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function tf(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function tp(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(e){}}function tg(){this.g=new eh}function tm(e){this.i=e.Sb||null,this.h=e.ab||!1}function ty(e,t){et.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function tw(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function tv(e){e.readyState=4,e.l=null,e.j=null,e.B=null,tb(e)}function tb(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function t_(e){let t="";return U(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function tE(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=t_(r),"string"==typeof e?null!=r&&ek(r):e8(e,t,r))}function tI(e){et.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(t=ta.prototype).add=function(e,t){to(this),this.i=null,e=tf(this,e);let r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},t.forEach=function(e,t){to(this),this.g.forEach(function(r,n){r.forEach(function(r){e.call(t,r,n,this)},this)},this)},t.set=function(e,t){return to(this),this.i=null,tl(this,e=tf(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&(e=th(this,e)).length>0?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(let n=0;n<t.length;n++){var r=t[n];let i=ek(r);r=th(this,r);for(let t=0;t<r.length;t++){let n=i;""!==r[t]&&(n+="="+ek(r[t])),e.push(n)}}return this.i=e.join("&")},v(tm,ec),tm.prototype.g=function(){return new ty(this.i,this.h)},v(ty,et),(t=ty.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,tb(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||a).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,tv(this)),this.readyState=0},t.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tb(this)),this.g&&(this.readyState=3,tb(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tw(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},t.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?tv(this):tb(this),3==this.readyState&&tw(this)}},t.Oa=function(e){this.g&&(this.response=this.responseText=e,tv(this))},t.Na=function(e){this.g&&(this.response=e,tv(this))},t.ga=function(){this.g&&tv(this)},t.setRequestHeader=function(e,t){this.A.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var r=t.next();!r.done;)e.push((r=r.value)[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(ty.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),v(tI,et);var tT=/^https?$/i,tS=["POST","PUT"];function tx(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,tC(e),tD(e)}function tC(e){e.A||(e.A=!0,er(e,"complete"),er(e,"error"))}function tA(e){if(e.h&&void 0!==s){if(e.v&&4==tk(e))setTimeout(e.Ca.bind(e),0);else if(er(e,"readystatechange"),4==tk(e)){e.h=!1;try{let s=e.ca();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,r,n=!0;break;default:n=!1}if(!(t=n)){if(r=0===s){let t=String(e.D).match(eX)[1]||null;!t&&a.self&&a.self.location&&(t=a.self.location.protocol.slice(0,-1)),r=!tT.test(t?t.toLowerCase():"")}t=r}if(t)er(e,"complete"),er(e,"success");else{e.o=6;try{var i=tk(e)>2?e.g.statusText:""}catch(e){i=""}e.l=i+" ["+e.ca()+"]",tC(e)}}finally{tD(e)}}}}function tD(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let r=e.g;e.g=null,t||er(e,"ready");try{r.onreadystatechange=null}catch(e){}}}function tk(e){return e.g?e.g.readyState:0}function tN(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tR(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tO(e){this.za=0,this.i=[],this.j=new eS,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tR("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tR("baseRetryDelayMs",5e3,e),this.Za=tR("retryDelaySeedMs",1e4,e),this.Ta=tR("forwardChannelMaxRetries",2,e),this.va=tR("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new eK(e&&e.concurrentRequestLimit),this.Ba=new tg,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function tL(e){if(tP(e),3==e.I){var t=e.V++,r=e0(e.J);if(e8(r,"SID",e.M),e8(r,"RID",t),e8(r,"TYPE","terminate"),tU(e,r),(t=new eN(e,e.j,t)).M=2,t.A=e6(e0(r)),r=!1,a.navigator&&a.navigator.sendBeacon)try{r=a.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!r&&a.Image&&((new Image).src=t.A,r=!0),r||(t.g=tY(t.j,null),t.g.ea(t.A)),t.F=Date.now(),eV(t)}tW(e)}function tM(e){e.g&&(tz(e),e.g.cancel(),e.g=null)}function tP(e){tM(e),e.v&&(a.clearTimeout(e.v),e.v=null),tK(e),e.h.cancel(),e.m&&("number"==typeof e.m&&a.clearTimeout(e.m),e.m=null)}function tF(e){if(!eG(e.h)&&!e.m){e.m=!0;var t=e.Ea;S||A(),x||(S(),x=!0),C.add(t,e),e.D=0}}function tV(e,t){var r;r=t?t.l:e.V++;let n=e0(e.J);e8(n,"SID",e.M),e8(n,"RID",r),e8(n,"AID",e.K),tU(e,n),e.u&&e.o&&tE(n,e.u,e.o),r=new eN(e,e.j,r,e.D+1),null===e.u&&(r.J=e.o),t&&(e.i=t.G.concat(e.i)),t=tB(e,r,1e3),r.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),eW(e.h,r),eM(r,n,t)}function tU(e,t){e.H&&U(e.H,function(e,r){e8(t,r,e)}),e.l&&U({},function(e,r){e8(t,r,e)})}function tB(e,t,r){r=Math.min(e.i.length,r);let n=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){let e=["count="+r];-1==t?r>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let u=!0;for(let l=0;l<r;l++){var s=i[l].g;let r=i[l].map;if((s-=t)<0)t=Math.max(0,i[l].g-100),u=!1;else try{s="req"+s+"_";try{var a=r instanceof Map?r:Object.entries(r);for(let[t,r]of a){let n=r;o(r)&&(n=eu(r)),e.push(s+t+"="+encodeURIComponent(n))}}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}catch(e){n&&n(r)}}if(u){a=e.join("&");break e}}a=void 0}return t.G=e=e.i.splice(0,r),a}function tq(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;S||A(),x||(S(),x=!0),C.add(t,e),e.A=0}}function tj(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=eT(l(e.Da,e),tH(e,e.A)),e.A++,!0)}function tz(e){null!=e.B&&(a.clearTimeout(e.B),e.B=null)}function t$(e){e.g=new eN(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=e0(e.na);e8(t,"RID","rpc"),e8(t,"SID",e.M),e8(t,"AID",e.K),e8(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&e8(t,"TO",e.ia),e8(t,"TYPE","xmlhttp"),tU(e,t),e.u&&e.o&&tE(t,e.u,e.o),e.O&&(e.g.H=e.O);var r=e.g;e=e.ba,r.M=1,r.A=e6(e0(t)),r.u=null,r.R=!0,eP(r,e)}function tK(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function tG(e,t){var r,n=null;if(e.g==t){tK(e),tz(e),e.g=null;var i=2}else{if(!eQ(e.h,t))return;n=t.G,eJ(e.h,t),i=1}if(0!=e.I){if(t.o)if(1==i){n=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;er(i=ew(),new eI(i,n)),tF(e)}else tq(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==i&&(r=t,!(eH(e.h)>=e.h.j-!!e.m)&&(e.m?(e.i=r.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=eT(l(e.Ea,e,r),tH(e,e.D)),e.D++,!0)))||2==i&&tj(e)))switch(n&&n.length>0&&((t=e.h).i=t.i.concat(n)),s){case 1:tQ(e,5);break;case 4:tQ(e,10);break;case 3:tQ(e,6);break;default:tQ(e,2)}}}function tH(e,t){let r=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(r*=2),r*t}function tQ(e,t){if(e.j.info("Error code "+t),2==t){let t,s,o;var r,n=l(e.bb,e),i=e.Ua;let u=!i;i=new eZ(i||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||e1(i,"https"),e6(i),u?function(e,t){let r=new eS;if(a.Image){let n=new Image;n.onload=h(tp,r,"TestLoadImage: loaded",!0,t,n),n.onerror=h(tp,r,"TestLoadImage: error",!1,t,n),n.onabort=h(tp,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=h(tp,r,"TestLoadImage: timeout",!1,t,n),a.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}(i.toString(),n):(r=i.toString(),t=new eS,s=new AbortController,o=setTimeout(()=>{s.abort(),tp(t,"TestPingServer: timeout",!1,n)},1e4),fetch(r,{signal:s.signal}).then(e=>{clearTimeout(o),e.ok?tp(t,"TestPingServer: ok",!0,n):tp(t,"TestPingServer: server error",!1,n)}).catch(()=>{clearTimeout(o),tp(t,"TestPingServer: error",!1,n)}))}else eE(2);e.I=0,e.l&&e.l.pa(t),tW(e),tP(e)}function tW(e){if(e.I=0,e.ja=[],e.l){let t=eY(e.h);(0!=t.length||0!=e.i.length)&&(E(e.ja,t),E(e.ja,e.i),e.h.i.length=0,_(e.i),e.i.length=0),e.l.oa()}}function tJ(e,t,r){var n=r instanceof eZ?e0(r):new eZ(r);if(""!=n.g)t&&(n.g=t+"."+n.g),e2(n,n.u);else{var i=a.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;let e=new eZ(null);n&&e1(e,n),t&&(e.g=t),i&&e2(e,i),r&&(e.h=r),n=e}return r=e.G,t=e.wa,r&&t&&e8(n,r,t),e8(n,"VER",e.ka),tU(e,n),n}function tY(e,t,r){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new tI(e.Aa&&!e.ma?new tm({ab:r}):e.ma)).Fa(e.L),t}function tX(){}function tZ(){}function t0(e,t){et.call(this),this.g=new tO(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!O(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!O(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new t3(this)}function t1(e){ep.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(let r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function t2(){eg.call(this),this.status=1}function t3(e){this.g=e}(t=tI.prototype).Fa=function(e){this.H=e},t.ea=function(t,r,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);r=r?r.toUpperCase():"GET",this.D=t,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e.g(),this.g.onreadystatechange=b(l(this.Ca,this));try{this.B=!0,this.g.open(r,String(t),!0),this.B=!1}catch(e){tx(this,e);return}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else if("function"==typeof i.keys&&"function"==typeof i.get)for(let e of i.keys())n.set(e,i.get(e));else throw Error("Unknown input type for opt_headers: "+String(i));for(let[e,o]of(i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=a.FormData&&t instanceof a.FormData,!(Array.prototype.indexOf.call(tS,r,void 0)>=0)||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(e,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(t),this.v=!1}catch(e){tx(this,e)}},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,er(this,"complete"),er(this,"abort"),tD(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tD(this,!0)),tI.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?tA(this):this.Xa())},t.Xa=function(){tA(this)},t.isActive=function(){return!!this.g},t.ca=function(){try{return tk(this)>2?this.g.status:-1}catch(e){return -1}},t.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),el(t)}},t.ya=function(){return this.o},t.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=tO.prototype).ka=8,t.I=1,t.connect=function(e,t,r,n){eE(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.J=tJ(this,null,this.W),tF(this)},t.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let i=new eN(this,this.j,e),s=this.o;if(this.U&&(s?j(s=B(s),this.U):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,r=0;r<this.i.length;r++){t:{var n=this.i[r];if("__data__"in n.map&&"string"==typeof(n=n.map.__data__)){n=n.length;break t}n=void 0}if(void 0===n)break;if((t+=n)>4096){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tB(this,i,t),e8(r=e0(this.J),"RID",e),e8(r,"CVER",22),this.G&&e8(r,"X-HTTP-Session-Id",this.G),tU(this,r),s&&(this.R?t="headers="+ek(t_(s))+"&"+t:this.u&&tE(r,this.u,s)),eW(this.h,i),this.Ra&&e8(r,"TYPE","init"),this.S?(e8(r,"$req",t),e8(r,"SID","null"),i.U=!0,eM(i,r,null)):eM(i,r,t),this.I=2}}else 3==this.I&&(e?tV(this,e):0==this.i.length||eG(this.h)||tV(this))},t.Da=function(){if(this.v=null,t$(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=eT(l(this.Wa,this),e)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,eE(10),tM(this),t$(this))},t.Va=function(){null!=this.C&&(this.C=null,tM(this),tj(this),eE(19))},t.bb=function(e){e?(this.j.info("Successfully pinged google.com"),eE(2)):(this.j.info("Failed to ping google.com"),eE(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=tX.prototype).ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){},tZ.prototype.g=function(e,t){return new t0(e,t)},v(t0,et),t0.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},t0.prototype.close=function(){tL(this.g)},t0.prototype.o=function(e){var t=this.g;if("string"==typeof e){var r={};r.__data__=e,e=r}else this.v&&((r={}).__data__=eu(e),e=r);t.i.push(new e$(t.Ya++,e)),3==t.I&&tF(t)},t0.prototype.N=function(){this.g.l=null,delete this.j,tL(this.g),delete this.g,t0.Z.N.call(this)},v(t1,ep),v(t2,eg),v(t3,tX),t3.prototype.ra=function(){er(this.g,"a")},t3.prototype.qa=function(e){er(this.g,new t1(e))},t3.prototype.pa=function(e){er(this.g,new t2)},t3.prototype.oa=function(){er(this.g,"b")},tZ.prototype.createWebChannel=tZ.prototype.g,t0.prototype.send=t0.prototype.o,t0.prototype.open=t0.prototype.m,t0.prototype.close=t0.prototype.close,w=ts.createWebChannelTransport=function(){return new tZ},y=ts.getStatEventTarget=function(){return ew()},m=ts.Event=em,g=ts.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},eC.NO_ERROR=0,eC.TIMEOUT=8,eC.HTTP_ERROR=6,p=ts.ErrorCode=eC,eA.COMPLETE="complete",f=ts.EventType=eA,ed.EventType=ef,ef.OPEN="a",ef.CLOSE="b",ef.ERROR="c",ef.MESSAGE="d",et.prototype.listen=et.prototype.J,d=ts.WebChannel=ed,ts.FetchXmlHttpFactory=tm,tI.prototype.listenOnce=tI.prototype.K,tI.prototype.getLastError=tI.prototype.Ha,tI.prototype.getLastErrorCode=tI.prototype.ya,tI.prototype.getStatus=tI.prototype.ca,tI.prototype.getResponseJson=tI.prototype.La,tI.prototype.getResponseText=tI.prototype.la,tI.prototype.send=tI.prototype.ea,tI.prototype.setWithCredentials=tI.prototype.Fa,c=ts.XhrIo=tI}).apply(void 0!==ti?ti:"u">typeof self?self:"u">typeof window?window:{});class ta{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ta.UNAUTHENTICATED=new ta(null),ta.GOOGLE_CREDENTIALS=new ta("google-credentials-uid"),ta.FIRST_PARTY=new ta("first-party-uid"),ta.MOCK_USER=new ta("mock-user");let to="12.8.0",tu=new ec("@firebase/firestore");function tl(){return tu.logLevel}function th(e,...t){if(tu.logLevel<=u.DEBUG){let r=t.map(tf);tu.debug(`Firestore (${to}): ${e}`,...r)}}function tc(e,...t){if(tu.logLevel<=u.ERROR){let r=t.map(tf);tu.error(`Firestore (${to}): ${e}`,...r)}}function td(e,...t){if(tu.logLevel<=u.WARN){let r=t.map(tf);tu.warn(`Firestore (${to}): ${e}`,...r)}}function tf(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function tp(e,t,r){let n="Unexpected state";"string"==typeof t?n=t:r=t,tg(e,n,r)}function tg(e,t,r){let n=`FIRESTORE (${to}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{n+=" CONTEXT: "+JSON.stringify(r)}catch(e){n+=" CONTEXT: "+r}throw tc(n),Error(n)}function tm(e,t,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,e||tg(t,i,n)}let ty={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tw extends J{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class tv{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class tb{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class t_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ta.UNAUTHENTICATED))}shutdown(){}}class tE{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class tI{constructor(e){this.t=e,this.currentUser=ta.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){tm(void 0===this.o,42304);let r=this.i,n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve(),i=new tv;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new tv,e.enqueueRetryable(()=>n(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},a=e=>{th("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?a(e):(th("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new tv)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(th("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(tm("string"==typeof t.accessToken,31837,{l:t}),new tb(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return tm(null===e||"string"==typeof e,2055,{h:e}),new ta(e)}}class tT{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ta.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class tS{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new tT(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ta.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,eB(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){tm(void 0===this.o,3512);let r=e=>{null!=e.error&&th("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.m;return this.m=e.token,th("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};let n=e=>{th("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?n(e):th("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tx(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(tm("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new tx(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class tA{static newId(){let e=62*Math.floor(256/62),t="";for(;t.length<20;){let r=function(e){let t="u">typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let e=0;e<40;e++)r[e]=Math.floor(256*Math.random());return r}(0);for(let n=0;n<r.length;++n)t.length<20&&r[n]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[n]%62))}return t}}function tD(e,t){return e<t?-1:+(e>t)}function tk(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=e.charAt(n),i=t.charAt(n);if(r!==i)return tN(r)===tN(i)?tD(r,i):tN(r)?1:-1}return tD(e.length,t.length)}function tN(e){let t=e.charCodeAt(0);return t>=55296&&t<=57343}function tR(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}let tO="__name__";class tL{constructor(e,t,r){void 0===t?t=0:t>e.length&&tp(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&tp(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===tL.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof tL?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=tL.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return tD(e.length,t.length)}static compareSegments(e,t){let r=tL.isNumericId(e),n=tL.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?tL.extractNumericId(e).compare(tL.extractNumericId(t)):tk(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return l.fromString(e.substring(4,e.length-2))}}class tM extends tL{construct(e,t,r){return new tM(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new tw(ty.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new tM(t)}static emptyPath(){return new tM([])}}let tP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tF extends tL{construct(e,t,r){return new tF(e,t,r)}static isValidIdentifier(e){return tP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tF.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===tO}static keyField(){return new tF([tO])}static fromServerFormat(e){let t=[],r="",n=0,i=()=>{if(0===r.length)throw new tw(ty.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;n<e.length;){let t=e[n];if("\\"===t){if(n+1===e.length)throw new tw(ty.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new tw(ty.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?s=!s:"."!==t||s?r+=t:i(),n++}if(i(),s)throw new tw(ty.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tF(t)}static emptyPath(){return new tF([])}}class tV{constructor(e){this.path=e}static fromPath(e){return new tV(tM.fromString(e))}static fromName(e){return new tV(tM.fromString(e).popFirst(5))}static empty(){return new tV(tM.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===tM.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return tM.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tV(new tM(e.slice()))}}function tU(e,t,r){if(!r)throw new tw(ty.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function tB(e){if(!tV.isDocumentKey(e))throw new tw(ty.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function tq(e){if(tV.isDocumentKey(e))throw new tw(ty.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function tj(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function tz(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}}return"function"==typeof e?"a function":tp(12329,{type:typeof e})}function t$(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new tw(ty.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=tz(e);throw new tw(ty.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function tK(e,t){if(t<=0)throw new tw(ty.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function tG(e,t){let r={typeString:e};return t&&(r.value=t),r}function tH(e,t){let r;if(!tj(e))throw new tw(ty.INVALID_ARGUMENT,"JSON must be an object");for(let n in t)if(t[n]){let i=t[n].typeString,s="value"in t[n]?{value:t[n].value}:void 0;if(!(n in e)){r=`JSON missing required field: '${n}'`;break}let a=e[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new tw(ty.INVALID_ARGUMENT,r);return!0}class tQ{static now(){return tQ.fromMillis(Date.now())}static fromDate(e){return tQ.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new tQ(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new tw(ty.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new tw(ty.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tD(this.nanoseconds,e.nanoseconds):tD(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:tQ._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(tH(e,tQ._jsonSchema))return new tQ(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}tQ._jsonSchemaVersion="firestore/timestamp/1.0",tQ._jsonSchema={type:tG("string",tQ._jsonSchemaVersion),seconds:tG("number"),nanoseconds:tG("number")};class tW{static fromTimestamp(e){return new tW(e)}static min(){return new tW(new tQ(0,0))}static max(){return new tW(new tQ(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class tJ{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}function tY(e){return e.fields.find(e=>2===e.kind)}function tX(e){return e.fields.filter(e=>2!==e.kind)}function tZ(e,t){let r=tD(e.collectionGroup,t.collectionGroup);if(0!==r)return r;for(let n=0;n<Math.min(e.fields.length,t.fields.length);++n)if(0!==(r=function(e,t){let r=tF.comparator(e.fieldPath,t.fieldPath);return 0!==r?r:tD(e.kind,t.kind)}(e.fields[n],t.fields[n])))return r;return tD(e.fields.length,t.fields.length)}tJ.UNKNOWN_ID=-1;class t0{constructor(e,t){this.fieldPath=e,this.kind=t}}class t1{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new t1(0,t8.min())}}function t2(e,t){let r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1;return new t8(tW.fromTimestamp(1e9===n?new tQ(r+1,0):new tQ(r,n)),tV.empty(),t)}function t3(e){return new t8(e.readTime,e.key,-1)}class t8{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new t8(tW.min(),tV.empty(),-1)}static max(){return new t8(tW.max(),tV.empty(),-1)}}function t6(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=tV.comparator(e.documentKey,t.documentKey))?r:tD(e.largestBatchId,t.largestBatchId)}let t4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class t5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function t7(e){if(e.code!==ty.FAILED_PRECONDITION||e.message!==t4)throw e;th("LocalStore","Unexpectedly lost primary lease")}class t9{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&tp(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new t9((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof t9?t:t9.resolve(t)}catch(e){return t9.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):t9.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):t9.reject(t)}static resolve(e){return new t9((t,r)=>{t(e)})}static reject(e){return new t9((t,r)=>{r(e)})}static waitFor(e){return new t9((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=t9.resolve(!1);for(let r of e)t=t.next(e=>e?t9.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new t9((r,n)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let u=o;t(e[u]).next(e=>{s[u]=e,++a===i&&r(s)},e=>n(e))}})}static doWhile(e,t){return new t9((r,n)=>{let i=()=>{!0===e()?t().next(()=>{i()},n):r()};i()})}}let re="SimpleDb";class rt{static open(e,t,r,n){try{return new rt(t,e.transaction(n,r))}catch(e){throw new rs(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new tv,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new rs(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{let r=rh(t.target.error);this.S.reject(new rs(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(th(re,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new ro(this.transaction.objectStore(e))}}class rr{static delete(e){return th(re,"Removing database:",e),ru(O().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!W())return!1;if(rr.F())return!0;let e=$(),t=rr.M(e),r=rn(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<t&&t<10||0<r&&r<4.5)}static F(){return void 0!==S.default&&"YES"===S.default.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(t?t[1].split("_").slice(0,2).join("."):"-1")}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,12.2===rr.M($())&&tc("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(th(re,"Opening database:",this.name),this.db=await new Promise((t,r)=>{let n=indexedDB.open(this.name,this.version);n.onsuccess=e=>{t(e.target.result)},n.onblocked=()=>{r(new rs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=t=>{let n=t.target.error;"VersionError"===n.name?r(new tw(ty.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new tw(ty.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new rs(e,n))},n.onupgradeneeded=e=>{th(re,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.N.k(t,n.transaction,e.oldVersion,this.version).next(()=>{th(re,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=e=>this.K(e)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,n){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.L(e);let t=rt.open(this.db,e,i?"readonly":"readwrite",r),s=n(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),t9.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(t){let e="FirebaseError"!==t.name&&s<3;if(th(re,"Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function rn(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}class ri{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return ru(this.U.delete())}}class rs extends tw{constructor(e,t){super(ty.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ra(e){return"IndexedDbTransactionError"===e.name}class ro{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(th(re,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(th(re,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ru(r)}add(e){return th(re,"ADD",this.store.name,e,e),ru(this.store.add(e))}get(e){return ru(this.store.get(e)).next(t=>(void 0===t&&(t=null),th(re,"GET",this.store.name,e,t),t))}delete(e){return th(re,"DELETE",this.store.name,e),ru(this.store.delete(e))}count(){return th(re,"COUNT",this.store.name),ru(this.store.count())}H(e,t){let r=this.options(e,t),n=r.index?this.store.index(r.index):this.store;if("function"==typeof n.getAll){let e=n.getAll(r.range);return new t9((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(r),t=[];return this.J(e,(e,r)=>{t.push(r)}).next(()=>t)}}Z(e,t){let r=this.store.getAll(e,null===t?void 0:t);return new t9((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}X(e,t){th(re,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let n=this.cursor(r);return this.J(n,(e,t,r)=>r.delete())}ee(e,t){let r;t?r=e:(r={},t=e);let n=this.cursor(r);return this.J(n,t)}te(e){let t=this.cursor({});return new t9((r,n)=>{t.onerror=e=>{n(rh(e.target.error))},t.onsuccess=t=>{let n=t.target.result;n?e(n.primaryKey,n.value).next(e=>{e?n.continue():r()}):r()}})}J(e,t){let r=[];return new t9((n,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void n();let s=new ri(i),a=t(i.primaryKey,i.value,s);if(a instanceof t9){let e=a.catch(e=>(s.done(),t9.reject(e)));r.push(e)}s.isDone?n():null===s.G?i.continue():i.continue(s.G)}}).next(()=>t9.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ru(e){return new t9((t,r)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{r(rh(e.target.error))}})}let rl=!1;function rh(e){let t=rr.M($());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new tw("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rl||(rl=!0,setTimeout(()=>{throw e},0)),e}}return e}let rc="IndexBackfiller";class rd{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){th(rc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.ne.ie();th(rc,`Documents written: ${e}`)}catch(e){ra(e)?th(rc,"Ignoring IndexedDB error during index backfill: ",e):await t7(e)}await this.re(6e4)})}}class rf{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){let r=new Set,n=t,i=!0;return t9.doWhile(()=>!0===i&&n>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return th(rc,`Processing collection: ${t}`),this.oe(e,t,n).next(e=>{n-=e,r.add(t)});i=!1})).next(()=>t-n)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(n=>this.localStore.localDocuments.getNextDocuments(e,t,n,r).next(r=>{let i=r.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this._e(n,r)).next(r=>(th(rc,`Updating offset: ${r}`),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>i.size)}))}_e(e,t){let r=e;return t.changes.forEach((e,t)=>{let n=t3(t);t6(n,r)>0&&(r=n)}),new t8(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class rp{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}}function rg(e){return null==e}function rm(e){return 0===e&&1/e==-1/0}function ry(e){return"number"==typeof e&&Number.isInteger(e)&&!rm(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function rw(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t+="\x01\x01"),t=function(e,t){let r=t,n=e.length;for(let t=0;t<n;t++){let n=e.charAt(t);switch(n){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=n}}return r}(e.get(r),t);return t+"\x01\x01"}rp.ce=-1;function rv(e){let t=e.length;if(tm(t>=2,64408,{path:e}),2===t)return tm("\x01"===e.charAt(0)&&"\x01"===e.charAt(1),56145,{path:e}),tM.emptyPath();let r=t-2,n=[],i="";for(let s=0;s<t;){let t=e.indexOf("\x01",s);switch((t<0||t>r)&&tp(50515,{path:e}),e.charAt(t+1)){case"\x01":let a,o=e.substring(s,t);0===i.length?a=o:(i+=o,a=i,i=""),n.push(a);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:tp(61167,{path:e})}s=t+2}return new tM(n)}let rb="remoteDocuments",r_="owner",rE="owner",rI="mutationQueues",rT="mutations",rS="batchId",rx="userMutationsIndex",rC=["userId","batchId"],rA={},rD="documentMutations",rk="remoteDocumentsV14",rN=["prefixPath","collectionGroup","readTime","documentId"],rR="documentKeyIndex",rO=["prefixPath","collectionGroup","documentId"],rL="collectionGroupIndex",rM=["collectionGroup","readTime","prefixPath","documentId"],rP="remoteDocumentGlobal",rF="remoteDocumentGlobalKey",rV="targets",rU="queryTargetsIndex",rB=["canonicalId","targetId"],rq="targetDocuments",rj=["targetId","path"],rz="documentTargetsIndex",r$=["path","targetId"],rK="targetGlobalKey",rG="targetGlobal",rH="collectionParents",rQ=["collectionId","parent"],rW="clientMetadata",rJ="bundles",rY="namedQueries",rX="indexConfiguration",rZ="collectionGroupIndex",r0="indexState",r1=["indexId","uid"],r2="sequenceNumberIndex",r3=["uid","sequenceNumber"],r8="indexEntries",r6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],r4="documentKeyIndex",r5=["indexId","uid","orderedDocumentKey"],r7="documentOverlays",r9=["userId","collectionPath","documentId"],ne="collectionPathOverlayIndex",nt=["userId","collectionPath","largestBatchId"],nr="collectionGroupOverlayIndex",nn=["userId","collectionGroup","largestBatchId"],ni="globals",ns=[rI,rT,rD,rb,rV,r_,rG,rq,rW,rP,rH,rJ,rY],na=[...ns,r7],no=[rI,rT,rD,rk,rV,r_,rG,rq,rW,rP,rH,rJ,rY,r7],nu=[...no,rX,r0,r8],nl=[...nu,ni];class nh extends t5{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function nc(e,t){return rr.O(e.le,t)}function nd(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function nf(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function np(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ng{constructor(e,t){this.comparator=e,this.root=t||ny.EMPTY}insert(e,t){return new ng(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ny.BLACK,null,null))}remove(e){return new ng(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ny.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nm(this.root,e,this.comparator,!1)}getReverseIterator(){return new nm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nm(this.root,e,this.comparator,!0)}}class nm{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ny{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:ny.RED,this.left=null!=n?n:ny.EMPTY,this.right=null!=i?i:ny.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new ny(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return ny.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(0>t(e,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return ny.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,ny.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,ny.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw tp(43730,{key:this.key,value:this.value});if(this.right.isRed())throw tp(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw tp(27949);return e+ +!this.isRed()}}ny.EMPTY=null,ny.RED=!0,ny.BLACK=!1,ny.EMPTY=new class{constructor(){this.size=0}get key(){throw tp(57766)}get value(){throw tp(16141)}get color(){throw tp(16727)}get left(){throw tp(29726)}get right(){throw tp(36894)}copy(e,t,r,n,i){return this}insert(e,t,r){return new ny(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class nw{constructor(e){this.comparator=e,this.data=new ng(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nv(this.data.getIterator())}getIteratorFrom(e){return new nv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof nw)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new nw(this.comparator);return t.data=e,t}}class nv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nb(e){return e.hasNext()?e.getNext():void 0}class n_{constructor(e){this.fields=e,e.sort(tF.comparator)}static empty(){return new n_([])}unionWith(e){let t=new nw(tF.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new n_(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tR(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class nE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class nI{constructor(e){this.binaryString=e}static fromBase64String(e){return new nI(function(e){try{return atob(e)}catch(e){throw"u">typeof DOMException&&e instanceof DOMException?new nE("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new nI(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tD(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nI.EMPTY_BYTE_STRING=new nI("");let nT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nS(e){if(tm(!!e,39018),"string"==typeof e){let t=0,r=nT.exec(e);if(tm(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:nx(e.seconds),nanos:nx(e.nanos)}}function nx(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function nC(e){return"string"==typeof e?nI.fromBase64String(e):nI.fromUint8Array(e)}let nA="server_timestamp",nD="__type__",nk="__previous_value__",nN="__local_write_time__";function nR(e){return(e?.mapValue?.fields||{})[nD]?.stringValue===nA}function nO(e){let t=e.mapValue.fields[nk];return nR(t)?nO(t):t}function nL(e){let t=nS(e.mapValue.fields[nN].timestampValue);return new tQ(t.seconds,t.nanos)}class nM{constructor(e,t,r,n,i,s,a,o,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=u,this.isUsingEmulator=l,this.apiKey=h}}let nP="(default)";class nF{constructor(e,t){this.projectId=e,this.database=t||nP}static empty(){return new nF("","")}get isDefaultDatabase(){return this.database===nP}isEqual(e){return e instanceof nF&&e.projectId===this.projectId&&e.database===this.database}}let nV="__type__",nU="__max__",nB={mapValue:{fields:{__type__:{stringValue:nU}}}},nq="__vector__",nj="value",nz={nullValue:"NULL_VALUE"};function n$(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?nR(e)?4:n6(e)?0x1fffffffffffff:n3(e)?10:11:tp(28295,{value:e})}function nK(e,t){if(e===t)return!0;let r=n$(e);if(r!==n$(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return nL(e).isEqual(nL(t));case 3:if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=nS(e.timestampValue),i=nS(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos;case 5:return e.stringValue===t.stringValue;case 6:return nC(e.bytesValue).isEqual(nC(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return nx(e.geoPointValue.latitude)===nx(t.geoPointValue.latitude)&&nx(e.geoPointValue.longitude)===nx(t.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in t)return nx(e.integerValue)===nx(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=nx(e.doubleValue),n=nx(t.doubleValue);return r===n?rm(r)===rm(n):isNaN(r)&&isNaN(n)}return!1;case 9:return tR(e.arrayValue.values||[],t.arrayValue.values||[],nK);case 10:case 11:let s=e.mapValue.fields||{},a=t.mapValue.fields||{};if(nd(s)!==nd(a))return!1;for(let e in s)if(s.hasOwnProperty(e)&&(void 0===a[e]||!nK(s[e],a[e])))return!1;return!0;default:return tp(52216,{left:e})}}function nG(e,t){return void 0!==(e.values||[]).find(e=>nK(e,t))}function nH(e,t){var r,n,i,s,a,o;if(e===t)return 0;let u=n$(e),l=n$(t);if(u!==l)return tD(u,l);switch(u){case 0:case 0x1fffffffffffff:return 0;case 1:return tD(e.booleanValue,t.booleanValue);case 2:let h,c;return h=nx(e.integerValue||e.doubleValue),h<(c=nx(t.integerValue||t.doubleValue))?-1:h>c?1:h===c?0:isNaN(h)?isNaN(c)?0:-1:1;case 3:return nQ(e.timestampValue,t.timestampValue);case 4:return nQ(nL(e),nL(t));case 5:return tk(e.stringValue,t.stringValue);case 6:let d,f;return r=e.bytesValue,n=t.bytesValue,d=nC(r),f=nC(n),d.compareTo(f);case 7:return function(e,t){let r=e.split("/"),n=t.split("/");for(let e=0;e<r.length&&e<n.length;e++){let t=tD(r[e],n[e]);if(0!==t)return t}return tD(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:let p;return i=e.geoPointValue,s=t.geoPointValue,0!==(p=tD(nx(i.latitude),nx(s.latitude)))?p:tD(nx(i.longitude),nx(s.longitude));case 9:return nW(e.arrayValue,t.arrayValue);case 10:let g,m,y,w,v;return a=e.mapValue,o=t.mapValue,g=a.fields||{},m=o.fields||{},y=g[nj]?.arrayValue,w=m[nj]?.arrayValue,0!==(v=tD(y?.values?.length||0,w?.values?.length||0))?v:nW(y,w);case 11:return function(e,t){if(e===nB.mapValue&&t===nB.mapValue)return 0;if(e===nB.mapValue)return 1;if(t===nB.mapValue)return -1;let r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let e=0;e<n.length&&e<s.length;++e){let t=tk(n[e],s[e]);if(0!==t)return t;let a=nH(r[n[e]],i[s[e]]);if(0!==a)return a}return tD(n.length,s.length)}(e.mapValue,t.mapValue);default:throw tp(23264,{he:u})}}function nQ(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return tD(e,t);let r=nS(e),n=nS(t),i=tD(r.seconds,n.seconds);return 0!==i?i:tD(r.nanos,n.nanos)}function nW(e,t){let r=e.values||[],n=t.values||[];for(let e=0;e<r.length&&e<n.length;++e){let t=nH(r[e],n[e]);if(t)return t}return tD(r.length,n.length)}function nJ(e){var t,r;let n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(n=nS(e.timestampValue),`time(${n.seconds},${n.nanos})`):"stringValue"in e?e.stringValue:"bytesValue"in e?nC(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,tV.fromName(t).toString()):"geoPointValue"in e?(r=e.geoPointValue,`geo(${r.latitude},${r.longitude})`):"arrayValue"in e?function(e){let t="[",r=!0;for(let n of e.values||[])r?r=!1:t+=",",t+=nJ(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(let i of t)n?n=!1:r+=",",r+=`${i}:${nJ(e.fields[i])}`;return r+"}"}(e.mapValue):tp(61005,{value:e})}function nY(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function nX(e){return!!e&&"integerValue"in e}function nZ(e){return!!e&&"arrayValue"in e}function n0(e){return!!e&&"nullValue"in e}function n1(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function n2(e){return!!e&&"mapValue"in e}function n3(e){return(e?.mapValue?.fields||{})[nV]?.stringValue===nq}function n8(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return nf(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=n8(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=n8(e.arrayValue.values[r]);return t}return{...e}}function n6(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===nU}let n4={mapValue:{fields:{[nV]:{stringValue:nq},[nj]:{arrayValue:{}}}}};function n5(e,t){let r=nH(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function n7(e,t){let r=nH(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class n9{constructor(e){this.value=e}static empty(){return new n9({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!n2(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=n8(t)}setAll(e){let t=tF.emptyPath(),r={},n=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=n8(e):n.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){let t=this.field(e.popLast());n2(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nK(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];n2(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){for(let n of(nf(t,(t,r)=>e[t]=r),r))delete e[n]}clone(){return new n9(n8(this.value))}}class ie{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new ie(e,0,tW.min(),tW.min(),tW.min(),n9.empty(),0)}static newFoundDocument(e,t,r,n){return new ie(e,1,t,tW.min(),r,n,0)}static newNoDocument(e,t){return new ie(e,2,t,tW.min(),tW.min(),n9.empty(),0)}static newUnknownDocument(e,t){return new ie(e,3,t,tW.min(),tW.min(),n9.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(tW.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=n9.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=n9.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tW.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ie&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ie(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class it{constructor(e,t){this.position=e,this.inclusive=t}}function ir(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(n=s.field.isKeyField()?tV.comparator(tV.fromName(a.referenceValue),r.key):nH(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function ii(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!nK(e.position[r],t.position[r]))return!1;return!0}class is{constructor(e,t="asc"){this.field=e,this.dir=t}}class ia{}class io extends ia{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new ig(e,t,r):"array-contains"===t?new iv(e,r):"in"===t?new ib(e,r):"not-in"===t?new i_(e,r):"array-contains-any"===t?new iE(e,r):new io(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new im(e,r):new iy(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(nH(t,this.value)):null!==t&&n$(this.value)===n$(t)&&this.matchesComparison(nH(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return tp(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class iu extends ia{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new iu(e,t)}matches(e){return il(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function il(e){return"and"===e.op}function ih(e){return"or"===e.op}function ic(e){return id(e)&&il(e)}function id(e){for(let t of e.filters)if(t instanceof iu)return!1;return!0}function ip(e,t){let r=e.filters.concat(t);return iu.create(r,e.op)}class ig extends io{constructor(e,t,r){super(e,t,r),this.key=tV.fromName(r.referenceValue)}matches(e){let t=tV.comparator(e.key,this.key);return this.matchesComparison(t)}}class im extends io{constructor(e,t){super(e,"in",t),this.keys=iw("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class iy extends io{constructor(e,t){super(e,"not-in",t),this.keys=iw("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function iw(e,t){return(t.arrayValue?.values||[]).map(e=>tV.fromName(e.referenceValue))}class iv extends io{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return nZ(t)&&nG(t.arrayValue,this.value)}}class ib extends io{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&nG(this.value.arrayValue,t)}}class i_ extends io{constructor(e,t){super(e,"not-in",t)}matches(e){if(nG(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!nG(this.value.arrayValue,t)}}class iE extends io{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!nZ(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>nG(this.value.arrayValue,e))}}class iI{constructor(e,t=null,r=[],n=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.Te=null}}function iT(e,t=null,r=[],n=[],i=null,s=null,a=null){return new iI(e,t,r,n,i,s,a)}function iS(e){if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(e=>(function e(t){if(t instanceof io)return t.field.canonicalString()+t.op.toString()+nJ(t.value);if(ic(t))return t.filters.map(t=>e(t)).join(",");{let r=t.filters.map(t=>e(t)).join(",");return`${t.op}(${r})`}})(e)).join(","),t+="|ob:",t+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),rg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>nJ(e)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>nJ(e)).join(",")),e.Te=t}return e.Te}function ix(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++){var r,n;if(r=e.orderBy[i],n=t.orderBy[i],!(r.dir===n.dir&&r.field.isEqual(n.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){return t instanceof io?r instanceof io&&t.op===r.op&&t.field.isEqual(r.field)&&nK(t.value,r.value):t instanceof iu?r instanceof iu&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((t,n,i)=>t&&e(n,r.filters[i]),!0):void tp(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ii(e.startAt,t.startAt)&&ii(e.endAt,t.endAt)}function iC(e){return tV.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function iA(e,t){return e.filters.filter(e=>e instanceof io&&e.field.isEqual(t))}function iD(e,t,r){let n=nz,i=!0;for(let r of iA(e,t)){let e=nz,t=!0;switch(r.op){case"<":case"<=":var s;e="nullValue"in(s=r.value)?nz:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?nY(nF.empty(),tV.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?n3(s)?n4:{mapValue:{}}:tp(35942,{value:s});break;case"==":case"in":case">=":e=r.value;break;case">":e=r.value,t=!1;break;case"!=":case"not-in":e=nz}0>n5({value:n,inclusive:i},{value:e,inclusive:t})&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];0>n5({value:n,inclusive:i},{value:e,inclusive:r.inclusive})&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}function ik(e,t,r){let n=nB,i=!0;for(let r of iA(e,t)){let e=nB,t=!0;switch(r.op){case">=":case">":var s;e="nullValue"in(s=r.value)?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?nY(nF.empty(),tV.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?n4:"mapValue"in s?n3(s)?{mapValue:{}}:nB:tp(61959,{value:s}),t=!1;break;case"==":case"in":case"<=":e=r.value;break;case"<":e=r.value,t=!1;break;case"!=":case"not-in":e=nB}n7({value:n,inclusive:i},{value:e,inclusive:t})>0&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];n7({value:n,inclusive:i},{value:e,inclusive:r.inclusive})>0&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}class iN{constructor(e,t=null,r=[],n=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function iR(e){return new iN(e)}function iO(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function iL(e){return null!==e.collectionGroup}function iM(e){if(null===e.Ie){let t;e.Ie=[];let r=new Set;for(let t of e.explicitOrderBy)e.Ie.push(t),r.add(t.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new nw(tF.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.Ie.push(new is(t,n))}),r.has(tF.keyField().canonicalString())||e.Ie.push(new is(tF.keyField(),n))}return e.Ie}function iP(e){return e.Ee||(e.Ee=iF(e,iM(e))),e.Ee}function iF(e,t){if("F"===e.limitType)return iT(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new is(e.field,t)});let r=e.endAt?new it(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new it(e.startAt.position,e.startAt.inclusive):null;return iT(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function iV(e,t){let r=e.filters.concat([t]);return new iN(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function iU(e,t,r){return new iN(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function iB(e,t){return ix(iP(e),iP(t))&&e.limitType===t.limitType}function iq(e){return`${iS(iP(e))}|lt:${e.limitType}`}function ij(e){var t;let r;return`Query(target=${r=(t=iP(e)).path.canonicalString(),null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof io?`${t.field.canonicalString()} ${t.op} ${nJ(t.value)}`:t instanceof iu?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),rg(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(e=>nJ(e)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(e=>nJ(e)).join(",")),`Target(${r})`}; limitType=${e.limitType})`}function iz(e,t){var r,n,i,s;let a,o,u;return t.isFoundDocument()&&(a=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(a):tV.isDocumentKey(e.path)?e.path.isEqual(a):e.path.isImmediateParentOf(a))&&function(e,t){for(let r of iM(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(r=e,n=t,(!r.startAt||(i=r.startAt,o=ir(i,iM(r),n),i.inclusive?!!(o<=0):!!(o<0)))&&(!r.endAt||(s=r.endAt,u=ir(s,iM(r),n),s.inclusive?!!(u>=0):!!(u>0))))}function i$(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function iK(e){return(t,r)=>{let n=!1;for(let i of iM(e)){let e=function(e,t,r){var n;let i,s,a=e.field.isKeyField()?tV.comparator(t.key,r.key):(n=e.field,i=t.data.field(n),s=r.data.field(n),null!==i&&null!==s?nH(i,s):tp(42886));switch(e.dir){case"asc":return a;case"desc":return -1*a;default:return tp(19790,{direction:e.dir})}}(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}class iG{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,n]of r)if(this.equalsFn(t,e))return n}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){nf(this.inner,(t,r)=>{for(let[t,n]of r)e(t,n)})}isEmpty(){return np(this.inner)}size(){return this.innerSize}}let iH=new ng(tV.comparator),iQ=new ng(tV.comparator);function iW(...e){let t=iQ;for(let r of e)t=t.insert(r.key,r);return t}function iJ(e){let t=iQ;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function iY(){return new iG(e=>e.toString(),(e,t)=>e.isEqual(t))}let iX=new ng(tV.comparator),iZ=new nw(tV.comparator);function i0(...e){let t=iZ;for(let r of e)t=t.add(r);return t}let i1=new nw(tD);function i2(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rm(t)?"-0":t}}function i3(e){return{integerValue:""+e}}class i8{constructor(){this._=void 0}}function i6(e,t){return e instanceof st?nX(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class i4 extends i8{}class i5 extends i8{constructor(e){super(),this.elements=e}}function i7(e,t){let r=sn(t);for(let t of e.elements)r.some(e=>nK(e,t))||r.push(t);return{arrayValue:{values:r}}}class i9 extends i8{constructor(e){super(),this.elements=e}}function se(e,t){let r=sn(t);for(let t of e.elements)r=r.filter(e=>!nK(e,t));return{arrayValue:{values:r}}}class st extends i8{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function sr(e){return nx(e.integerValue||e.doubleValue)}function sn(e){return nZ(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class si{constructor(e,t){this.field=e,this.transform=t}}class ss{constructor(e,t){this.version=e,this.transformResults=t}}class sa{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sa}static exists(e){return new sa(void 0,e)}static updateTime(e){return new sa(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function so(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class su{}function sl(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new sy(e.key,sa.none()):new sd(e.key,e.data,sa.none());{let r=e.data,n=n9.empty(),i=new nw(tF.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new sf(e.key,n,new n_(i.toArray()),sa.none())}}function sh(e,t,r,n){return e instanceof sd?function(e,t,r,n){if(!so(e.precondition,t))return r;let i=e.value.clone(),s=sm(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,r,n):e instanceof sf?function(e,t,r,n){if(!so(e.precondition,t))return r;let i=sm(e.fieldTransforms,n,t),s=t.data;return(s.setAll(sp(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,n):so(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}function sc(e,t){var r,n;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||!(!r||!n)&&tR(r,n,(e,t)=>{var r,n;return e.field.isEqual(t.field)&&(r=e.transform,n=t.transform,r instanceof i5&&n instanceof i5||r instanceof i9&&n instanceof i9?tR(r.elements,n.elements,nK):r instanceof st&&n instanceof st?nK(r.Ae,n.Ae):r instanceof i4&&n instanceof i4)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class sd extends su{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class sf extends su{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function sp(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=e.data.field(r);t.set(r,n)}}),t}function sg(e,t,r){let n=new Map;tm(e.length===r.length,32656,{Ve:r.length,de:e.length});for(let s=0;s<r.length;s++){var i;let a=e[s],o=a.transform,u=t.data.field(a.field);n.set(a.field,(i=r[s],o instanceof i5?i7(o,u):o instanceof i9?se(o,u):i))}return n}function sm(e,t,r){let n=new Map;for(let i of e){let e=i.transform,s=r.data.field(i.field);n.set(i.field,function(e,t,r){var n;let i,s,a;return e instanceof i4?(n=t,i={fields:{[nD]:{stringValue:nA},[nN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},n&&nR(n)&&(n=nO(n)),n&&(i.fields[nk]=n),{mapValue:i}):e instanceof i5?i7(e,t):e instanceof i9?se(e,t):(a=sr(s=i6(e,t))+sr(e.Ae),nX(s)&&nX(e.Ae)?i3(a):i2(e.serializer,a))}(e,s,t))}return n}class sy extends su{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sw extends su{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class sv{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let n=this.mutations[t];n.key.isEqual(e.key)&&function(e,t,r){let n,i;e instanceof sd?(n=e.value.clone(),i=sg(e.fieldTransforms,t,r.transformResults),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()):e instanceof sf?function(e,t,r){if(!so(e.precondition,t))return t.convertToUnknownDocument(r.version);let n=sg(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(sp(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(e,t,r):t.convertToNoDocument(r.version).setHasCommittedMutations()}(n,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=sh(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=sh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=iY();return this.mutations.forEach(n=>{let i=e.get(n.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields),o=sl(s,a=t.has(n.key)?null:a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(tW.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),i0())}isEqual(e){return this.batchId===e.batchId&&tR(this.mutations,e.mutations,(e,t)=>sc(e,t))&&tR(this.baseMutations,e.baseMutations,(e,t)=>sc(e,t))}}class sb{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){tm(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let n=iX,i=e.mutations;for(let e=0;e<i.length;e++)n=n.insert(i[e].key,r[e].version);return new sb(e,t,r,n)}}class s_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class sE{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class sI{constructor(e,t){this.count=e,this.unchangedNames=t}}function sT(e){switch(e){case ty.OK:return tp(64938);case ty.CANCELLED:case ty.UNKNOWN:case ty.DEADLINE_EXCEEDED:case ty.RESOURCE_EXHAUSTED:case ty.INTERNAL:case ty.UNAVAILABLE:case ty.UNAUTHENTICATED:return!1;case ty.INVALID_ARGUMENT:case ty.NOT_FOUND:case ty.ALREADY_EXISTS:case ty.PERMISSION_DENIED:case ty.FAILED_PRECONDITION:case ty.ABORTED:case ty.OUT_OF_RANGE:case ty.UNIMPLEMENTED:case ty.DATA_LOSS:return!0;default:return tp(15467,{code:e})}}function sS(e){if(void 0===e)return tc("GRPC error has no .code"),ty.UNKNOWN;switch(e){case v.OK:return ty.OK;case v.CANCELLED:return ty.CANCELLED;case v.UNKNOWN:return ty.UNKNOWN;case v.DEADLINE_EXCEEDED:return ty.DEADLINE_EXCEEDED;case v.RESOURCE_EXHAUSTED:return ty.RESOURCE_EXHAUSTED;case v.INTERNAL:return ty.INTERNAL;case v.UNAVAILABLE:return ty.UNAVAILABLE;case v.UNAUTHENTICATED:return ty.UNAUTHENTICATED;case v.INVALID_ARGUMENT:return ty.INVALID_ARGUMENT;case v.NOT_FOUND:return ty.NOT_FOUND;case v.ALREADY_EXISTS:return ty.ALREADY_EXISTS;case v.PERMISSION_DENIED:return ty.PERMISSION_DENIED;case v.FAILED_PRECONDITION:return ty.FAILED_PRECONDITION;case v.ABORTED:return ty.ABORTED;case v.OUT_OF_RANGE:return ty.OUT_OF_RANGE;case v.UNIMPLEMENTED:return ty.UNIMPLEMENTED;case v.DATA_LOSS:return ty.DATA_LOSS;default:return tp(39323,{code:e})}}(b=v||(v={}))[b.OK=0]="OK",b[b.CANCELLED=1]="CANCELLED",b[b.UNKNOWN=2]="UNKNOWN",b[b.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",b[b.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",b[b.NOT_FOUND=5]="NOT_FOUND",b[b.ALREADY_EXISTS=6]="ALREADY_EXISTS",b[b.PERMISSION_DENIED=7]="PERMISSION_DENIED",b[b.UNAUTHENTICATED=16]="UNAUTHENTICATED",b[b.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",b[b.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",b[b.ABORTED=10]="ABORTED",b[b.OUT_OF_RANGE=11]="OUT_OF_RANGE",b[b.UNIMPLEMENTED=12]="UNIMPLEMENTED",b[b.INTERNAL=13]="INTERNAL",b[b.UNAVAILABLE=14]="UNAVAILABLE",b[b.DATA_LOSS=15]="DATA_LOSS";let sx=null;function sC(){return new TextEncoder}let sA=new l([0xffffffff,0xffffffff],0);function sD(e){let t=sC().encode(e),r=new h;return r.update(t),new Uint8Array(r.digest())}function sk(e){let t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new l([r,n],0),new l([i,s],0)]}class sN{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new sR(`Invalid padding: ${t}`);if(r<0||e.length>0&&0===this.hashCount)throw new sR(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new sR(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=l.fromNumber(this.ge)}ye(e,t,r){let n=e.add(t.multiply(l.fromNumber(r)));return 1===n.compare(sA)&&(n=new l([n.getBits(0),n.getBits(1)],0)),n.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;let[t,r]=sk(sD(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);if(!this.we(n))return!1}return!0}static create(e,t,r){let n=new sN(new Uint8Array(Math.ceil(e/8)),e%8==0?0:8-e%8,t);return r.forEach(e=>n.insert(e)),n}insert(e){if(0===this.ge)return;let[t,r]=sk(sD(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);this.be(n)}}be(e){let t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class sR extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class sO{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let n=new Map;return n.set(e,sL.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new sO(tW.min(),n,new ng(tD),iH,i0())}}class sL{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new sL(r,t,i0(),i0(),i0())}}class sM{constructor(e,t,r,n){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=n}}class sP{constructor(e,t){this.targetId=e,this.Ce=t}}class sF{constructor(e,t,r=nI.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class sV{constructor(){this.ve=0,this.Fe=sq(),this.Me=nI.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=i0(),t=i0(),r=i0();return this.Fe.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:tp(38017,{changeType:i})}}),new sL(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=sq()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,tm(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class sU{constructor(e){this.Ge=e,this.ze=new Map,this.je=iH,this.He=sB(),this.Je=sB(),this.Ze=new ng(tD)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:tp(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,r=e.Ce.count,n=this.ot(t);if(n){let a=n.target;if(iC(a))if(0===r){let e=new tV(a.path);this.et(t,e,ie.newNoDocument(e,tW.min()))}else tm(1===r,20013,{expectedCount:r});else{let n=this._t(t);if(n!==r){var i,s;let r,a,o=this.ut(e),u=o?this.ct(o,e,n):1;0!==u&&(this.it(t),this.Ze=this.Ze.insert(t,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),sx?.lt((i=e.Ce,s=this.Ge.ht(),r={localCacheCount:n,existenceFilterCount:i.count,databaseId:s.database,projectId:s.projectId},(a=i.unchangedNames)&&(r.bloomFilter={applied:0===u,hashCount:a?.hashCount??0,bitmapLength:a?.bits?.bitmap?.length??0,padding:a?.bits?.padding??0,mightContain:e=>o?.mightContain(e)??!1}),r))}}}}ut(e){let t,r,n=e.Ce.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=n;try{t=nC(i).toUint8Array()}catch(e){if(e instanceof nE)return td("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new sN(t,s,a)}catch(e){return td(e instanceof sR?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.ge?null:r}ct(e,t,r){return 2*(t.Ce.count!==r-this.Pt(e,t.targetId))}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),n=0;return r.forEach(r=>{let i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${r.path.canonicalString()}`;e.mightContain(s)||(this.et(t,r,null),n++)}),n}Tt(e){let t=new Map;this.ze.forEach((r,n)=>{let i=this.ot(n);if(i){if(r.current&&iC(i.target)){let t=new tV(i.target.path);this.It(t).has(n)||this.Et(n,t)||this.et(n,t,ie.newNoDocument(t,e))}r.Be&&(t.set(n,r.ke()),r.Ke())}});let r=i0();this.Je.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{let t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.je.forEach((t,r)=>r.setReadTime(e));let n=new sO(e,t,this.Ze,this.je,r);return this.je=iH,this.He=sB(),this.Je=sB(),this.Ze=new ng(tD),n}Ye(e,t){if(!this.rt(e))return;let r=2*!!this.Et(e,t.key);this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let n=this.nt(e);this.Et(e,t)?n.qe(t,1):n.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new sV,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new nw(tD),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new nw(tD),this.He=this.He.insert(e,t)),t}rt(e){let t=null!==this.ot(e);return t||th("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new sV),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function sB(){return new ng(tV.comparator)}function sq(){return new ng(tV.comparator)}let sj={asc:"ASCENDING",desc:"DESCENDING"},sz={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},s$={and:"AND",or:"OR"};class sK{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function sG(e,t){return e.useProto3Json||rg(t)?t:{value:t}}function sH(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function sQ(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function sW(e){let t;return tm(!!e,49232),tW.fromTimestamp(new tQ((t=nS(e)).seconds,t.nanos))}function sJ(e,t){return sY(e,t).canonicalString()}function sY(e,t){let r=new tM(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function sX(e){let t=tM.fromString(e);return tm(ai(t),10190,{key:t.toString()}),t}function sZ(e,t){return sJ(e.databaseId,t.path)}function s0(e,t){let r=sX(t);if(r.get(1)!==e.databaseId.projectId)throw new tw(ty.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new tw(ty.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new tV(s8(r))}function s1(e,t){return sJ(e.databaseId,t)}function s2(e){let t=sX(e);return 4===t.length?tM.emptyPath():s8(t)}function s3(e){return new tM(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function s8(e){return tm(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function s6(e,t,r){return{name:sZ(e,t),fields:r.value.mapValue.fields}}function s4(e,t,r){let n=s0(e,t.name),i=sW(t.updateTime),s=t.createTime?sW(t.createTime):tW.min(),a=new n9({mapValue:{fields:t.fields}}),o=ie.newFoundDocument(n,i,s,a);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function s5(e,t){var r,n;let i;if(t instanceof sd)i={update:s6(e,t.key,t.value)};else if(t instanceof sy)i={delete:sZ(e,t.key)};else if(t instanceof sf){let r;i={update:s6(e,t.key,t.data),updateMask:(n=t.fieldMask,r=[],n.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r})}}else{if(!(t instanceof sw))return tp(16599,{dt:t.type});i={verify:sZ(e,t.key)}}return t.fieldTransforms.length>0&&(i.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let r=t.transform;if(r instanceof i4)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof i5)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof i9)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof st)return{fieldPath:t.field.canonicalString(),increment:r.Ae};throw tp(20930,{transform:t.transform})})(0,e))),t.precondition.isNone||(i.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:sH(e,r.updateTime.toTimestamp())}:void 0!==r.exists?{exists:r.exists}:tp(27497)),i}function s7(e,t){var r;let n=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?sa.updateTime(sW(r.updateTime)):void 0!==r.exists?sa.exists(r.exists):sa.none():sa.none(),i=t.updateTransforms?t.updateTransforms.map(t=>{let r;return r=null,"setToServerValue"in t?(tm("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new i4):"appendMissingElements"in t?r=new i5(t.appendMissingElements.values||[]):"removeAllFromArray"in t?r=new i9(t.removeAllFromArray.values||[]):"increment"in t?r=new st(e,t.increment):tp(16584,{proto:t}),new si(tF.fromServerFormat(t.fieldPath),r)}):[];if(t.update){t.update.name;let r=s0(e,t.update.name),s=new n9({mapValue:{fields:t.update.fields}});return t.updateMask?new sf(r,s,new n_((t.updateMask.fieldPaths||[]).map(e=>tF.fromServerFormat(e))),n,i):new sd(r,s,n,i)}return t.delete?new sy(s0(e,t.delete),n):t.verify?new sw(s0(e,t.verify),n):tp(1463,{proto:t})}function s9(e,t){return{documents:[s1(e,t.path)]}}function ae(e,t){var r,n;let i,s={structuredQuery:{}},a=t.path;null!==t.collectionGroup?(i=a,s.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=s1(e,i);let o=function(e){if(0!==e.length)return function e(t){var r;let n;return t instanceof io?function(e){if("=="===e.op){if(n1(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NAN"}};if(n0(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(n1(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NOT_NAN"}};if(n0(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ar(e.field),op:sz[e.op],value:e.value}}}(t):t instanceof iu?1===(n=(r=t).getFilters().map(t=>e(t))).length?n[0]:{compositeFilter:{op:s$[r.op],filters:n}}:tp(54877,{filter:t})}(iu.create(e,"and"))}(t.filters);o&&(s.structuredQuery.where=o);let u=function(e){if(0!==e.length)return e.map(e=>({field:ar(e.field),direction:sj[e.dir]}))}(t.orderBy);u&&(s.structuredQuery.orderBy=u);let l=sG(e,t.limit);return null!==l&&(s.structuredQuery.limit=l),t.startAt&&(s.structuredQuery.startAt={before:(r=t.startAt).inclusive,values:r.position}),t.endAt&&(s.structuredQuery.endAt={before:!(n=t.endAt).inclusive,values:n.position}),{ft:s,parent:i}}function at(e){var t,r,n;let i,s,a,o,u=s2(e.parent),l=e.structuredQuery,h=l.from?l.from.length:0,c=null;if(h>0){tm(1===h,65062);let e=l.from[0];e.allDescendants?c=e.collectionId:u=u.child(e.collectionId)}let d=[];l.where&&(d=(i=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=an(e.unaryFilter.field);return io.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=an(e.unaryFilter.field);return io.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=an(e.unaryFilter.field);return io.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=an(e.unaryFilter.field);return io.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return tp(61313);default:return tp(60726)}}(t):void 0!==t.fieldFilter?io.create(an(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return tp(58110);default:return tp(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?iu.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return tp(1026)}}(t.compositeFilter.op)):tp(30097,{filter:t})}(l.where))instanceof iu&&ic(i)?i.getFilters():[i]);let f=[];l.orderBy&&(f=l.orderBy.map(e=>new is(an(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let p=null;l.limit&&(p=rg(s="object"==typeof(t=l.limit)?t.value:t)?null:s);let g=null;l.startAt&&(a=!!(r=l.startAt).before,g=new it(r.values||[],a));let m=null;return l.endAt&&(o=!(n=l.endAt).before,m=new it(n.values||[],o)),new iN(u,c,f,d,p,"F",g,m)}function ar(e){return{fieldPath:e.canonicalString()}}function an(e){return tF.fromServerFormat(e.fieldPath)}function ai(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function as(e){return!!e&&"function"==typeof e._toProto&&"ProtoValue"===e._protoValueType}class aa{constructor(e,t,r,n,i=tW.min(),s=tW.min(),a=nI.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new aa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new aa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ao{constructor(e){this.yt=e}}function au(e,t){let r=t.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:al(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument()){var i;n.document={name:sZ(i=e.yt,t.key),fields:t.data.value.mapValue.fields,updateTime:sH(i,t.version.toTimestamp()),createTime:sH(i,t.createTime.toTimestamp())}}else if(t.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:ah(t.version)};else{if(!t.isUnknownDocument())return tp(57904,{document:t});n.unknownDocument={path:r.path.toArray(),version:ah(t.version)}}return n}function al(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ah(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function ac(e){let t=new tQ(e.seconds,e.nanoseconds);return tW.fromTimestamp(t)}function ad(e,t){let r=(t.baseMutations||[]).map(t=>s7(e.yt,t));for(let e=0;e<t.mutations.length-1;++e){let r=t.mutations[e];e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform&&(r.updateTransforms=t.mutations[e+1].transform.fieldTransforms,t.mutations.splice(e+1,1),++e)}let n=t.mutations.map(t=>s7(e.yt,t)),i=tQ.fromMillis(t.localWriteTimeMs);return new sv(t.batchId,i,r,n)}function af(e){var t;let r,n=ac(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?ac(e.lastLimboFreeSnapshotVersion):tW.min();return new aa(void 0!==e.query.documents?(tm(1===(r=(t=e.query).documents.length),1966,{count:r}),iP(iR(s2(t.documents[0])))):iP(at(e.query)),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,n,i,nI.fromBase64String(e.resumeToken))}function ap(e,t){let r,n=ah(t.snapshotVersion),i=ah(t.lastLimboFreeSnapshotVersion);r=iC(t.target)?s9(e.yt,t.target):ae(e.yt,t.target).ft;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:iS(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function ag(e){let t=at({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?iU(t,t.limit,"L"):t}function am(e,t){return new s_(t.largestBatchId,s7(e.yt,t.overlayMutation))}function ay(e,t){let r=t.path.lastSegment();return[e,rw(t.path.popLast()),r]}function aw(e,t,r,n){return{indexId:e,uid:t,sequenceNumber:r,readTime:ah(n.readTime),documentKey:rw(n.documentKey.path),largestBatchId:n.largestBatchId}}class av{getBundleMetadata(e,t){return nc(e,rJ).get(t).next(e=>{if(e)return{id:e.bundleId,createTime:ac(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return nc(e,rJ).put({bundleId:t.id,createTime:ah(sW(t.createTime)),version:t.version})}getNamedQuery(e,t){return nc(e,rY).get(t).next(e=>{if(e)return{name:e.name,query:ag(e.bundledQuery),readTime:ac(e.readTime)}})}saveNamedQuery(e,t){return nc(e,rY).put({name:t.name,readTime:ah(sW(t.readTime)),bundledQuery:t.bundledQuery})}}class ab{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){return new ab(e,t.uid||"")}getOverlay(e,t){return nc(e,r7).get(ay(this.userId,t)).next(e=>e?am(this.serializer,e):null)}getOverlays(e,t){let r=iY();return t9.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){let n=[];return r.forEach((r,i)=>{let s=new s_(t,i);n.push(this.bt(e,s))}),t9.waitFor(n)}removeOverlaysForBatchId(e,t,r){let n=new Set;t.forEach(e=>n.add(rw(e.getCollectionPath())));let i=[];return n.forEach(t=>{let n=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);i.push(nc(e,r7).X(ne,n))}),t9.waitFor(i)}getOverlaysForCollection(e,t,r){let n=iY(),i=rw(t),s=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,1/0],!0);return nc(e,r7).H(ne,s).next(e=>{for(let t of e){let e=am(this.serializer,t);n.set(e.getKey(),e)}return n})}getOverlaysForCollectionGroup(e,t,r,n){let i,s=iY(),a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,1/0],!0);return nc(e,r7).ee({index:nr,range:a},(e,t,r)=>{let a=am(this.serializer,t);s.size()<n||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):r.done()}).next(()=>s)}bt(e,t){return nc(e,r7).put(function(e,t,r){let[n,i,s]=ay(t,r.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:s5(e.yt,r.mutation)}}(this.serializer,this.userId,t))}}class a_{St(e){return nc(e,ni)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{let t=e?.value;return t?nI.fromUint8Array(t):nI.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class aE{Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(+!!e.booleanValue);else if("integerValue"in e)this.Ft(t,15),t.Mt(nx(e.integerValue));else if("doubleValue"in e){let r=nx(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),rm(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=nS(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(nC(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?n6(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):n3(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):tp(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};for(let e of(this.Ft(t,55),Object.keys(r)))this.Ot(e,t),this.Ct(r[e],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let n=r[nj].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(nx(n)),this.Ot(nj,t),this.Ct(r[nj],t)}qt(e,t){let r=e.values||[];for(let e of(this.Ft(t,50),r))this.Ct(e,t)}Lt(e,t){this.Ft(t,37),tV.fromName(e).path.forEach(e=>{this.Ft(t,60),this.$t(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}function aI(e){return Math.ceil((64-function(e){let t=0;for(let r=0;r<8;++r){let n=function(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}(255&e[r]);if(t+=n,8!==n)break}return t}(e))/8)}aE.Wt=new aE;class aT{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{let e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Xt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Ht(e);else if(e<2048)this.Ht(960|e>>>6),this.Ht(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e);else{let e=t.codePointAt(0);this.Ht(240|e>>>18),this.Ht(128|63&e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e)}}this.Jt()}Yt(e){let t=this.en(e),r=aI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=255&t[e]}nn(e){let t=this.en(e),r=aI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}rn(){this.sn(255),this.sn(255)}_n(){this.an(255),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t,r=((t=new DataView(new ArrayBuffer(8))).setFloat64(0,e,!1),new Uint8Array(t.buffer)),n=!!(128&r[0]);r[0]^=n?255:128;for(let e=1;e<r.length;++e)r[e]^=255*!!n;return r}Gt(e){let t=255&e;0===t?(this.sn(0),this.sn(255)):255===t?(this.sn(255),this.sn(0)):this.sn(t)}Ht(e){let t=255&e;0===t?(this.an(0),this.an(255)):255===t?(this.an(255),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let n=new Uint8Array(r);n.set(this.buffer),this.buffer=n}}class aS{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class ax{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class aC{constructor(){this.cn=new aT,this.ascending=new aS(this.cn),this.descending=new ax(this.cn)}seed(e){this.cn.seed(e)}ln(e){return 0===e?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class aA{constructor(e,t,r,n){this.hn=e,this.Pn=t,this.Tn=r,this.In=n}En(){let e=this.In.length,t=0===e||255===this.In[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new aA(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:aN(this.Tn),directionalValue:aN(this.In),orderedDocumentKey:aN(t),documentKey:r.path.toArray()}}An(e,t,r){let n=this.Rn(e,t,r);return[n.indexId,n.uid,n.arrayValue,n.directionalValue,n.orderedDocumentKey,n.documentKey]}}function aD(e,t){let r=e.hn-t.hn;return 0!==r||0!==(r=ak(e.Tn,t.Tn))||0!==(r=ak(e.In,t.In))?r:tV.comparator(e.Pn,t.Pn)}function ak(e,t){for(let r=0;r<e.length&&r<t.length;++r){let n=e[r]-t[r];if(0!==n)return n}return e.length-t.length}function aN(e){return Q()?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):e}function aR(e){return"string"!=typeof e?e:function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)}class aO{constructor(e){for(const t of(this.Vn=new nw((e,t)=>tF.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[],e.filters))t.isInequality()?this.Vn=this.Vn.add(t):this.mn.push(t)}get fn(){return this.Vn.size>1}gn(e){if(tm(e.collectionGroup===this.collectionId,49279),this.fn)return!1;let t=tY(e);if(void 0!==t&&!this.pn(t))return!1;let r=tX(e),n=new Set,i=0,s=0;for(;i<r.length&&this.pn(r[i]);++i)n=n.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){let e=this.Vn.getIterator().getNext();if(!n.has(e.field.canonicalString())){let t=r[i];if(!this.yn(e,t)||!this.wn(this.dn[s++],t))return!1}++i}for(;i<r.length;++i){let e=r[i];if(s>=this.dn.length||!this.wn(this.dn[s++],e))return!1}return!0}bn(){if(this.fn)return null;let e=new nw(tF.comparator),t=[];for(let r of this.mn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new t0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new t0(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new t0(r.field,+("asc"!==r.dir))));return new tJ(tJ.UNKNOWN_ID,this.collectionId,t,t1.empty())}pn(e){for(let t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function aL(e){return e instanceof io}function aM(e){return e instanceof iu&&ic(e)}function aP(e){return aL(e)||aM(e)||function(e){if(e instanceof iu&&ih(e)){for(let t of e.getFilters())if(!aL(t)&&!aM(t))return!1;return!0}return!1}(e)}function aF(e,t){return tm(e instanceof io||e instanceof iu,38388),tm(t instanceof io||t instanceof iu,25473),aU(e instanceof io?t instanceof io?iu.create([e,t],"and"):aV(e,t):t instanceof io?aV(t,e):function(e,t){if(tm(e.filters.length>0&&t.filters.length>0,48005),il(e)&&il(t))return ip(e,t.getFilters());let r=ih(e)?e:t,n=ih(e)?t:e,i=r.filters.map(e=>aF(e,n));return iu.create(i,"or")}(e,t))}function aV(e,t){if(il(t))return ip(t,e.getFilters());{let r=t.filters.map(t=>aF(e,t));return iu.create(r,"or")}}function aU(e){if(tm(e instanceof io||e instanceof iu,11850),e instanceof io)return e;let t=e.getFilters();if(1===t.length)return aU(t[0]);if(id(e))return e;let r=t.map(e=>aU(e)),n=[];return r.forEach(t=>{t instanceof io?n.push(t):t instanceof iu&&(t.op===e.op?n.push(...t.filters):n.push(t))}),1===n.length?n[0]:iu.create(n,e.op)}class aB{constructor(){this.Sn=new aq}addToCollectionParentIndex(e,t){return this.Sn.add(t),t9.resolve()}getCollectionParents(e,t){return t9.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return t9.resolve()}deleteFieldIndex(e,t){return t9.resolve()}deleteAllFieldIndexes(e){return t9.resolve()}createTargetIndexes(e,t){return t9.resolve()}getDocumentsMatchingTarget(e,t){return t9.resolve(null)}getIndexType(e,t){return t9.resolve(0)}getFieldIndexes(e,t){return t9.resolve([])}getNextCollectionGroupToUpdate(e){return t9.resolve(null)}getMinOffset(e,t){return t9.resolve(t8.min())}getMinOffsetFromCollectionGroup(e,t){return t9.resolve(t8.min())}updateCollectionGroup(e,t,r){return t9.resolve()}updateIndexEntries(e,t){return t9.resolve()}}class aq{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new nw(tM.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new nw(tM.comparator)).toArray()}}let aj="IndexedDbIndexManager",az=new Uint8Array(0);class a${constructor(e,t){this.databaseId=t,this.Dn=new aq,this.Cn=new iG(e=>iS(e),(e,t)=>ix(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){let r=t.lastSegment(),n=t.popLast();e.addOnCommittedListener(()=>{this.Dn.add(t)});let i={collectionId:r,parent:rw(n)};return nc(e,rH).put(i)}return t9.resolve()}getCollectionParents(e,t){let r=[],n=IDBKeyRange.bound([t,""],[t+"\0",""],!1,!0);return nc(e,rH).H(n).next(e=>{for(let n of e){if(n.collectionId!==t)break;r.push(rv(n.parent))}return r})}addFieldIndex(e,t){let r=nc(e,rX),n={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete n.indexId;let i=r.add(n);if(t.indexState){let r=nc(e,r0);return i.next(e=>{r.put(aw(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let r=nc(e,rX),n=nc(e,r0),i=nc(e,r8);return r.delete(t.indexId).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=nc(e,rX),r=nc(e,r8),n=nc(e,r0);return t.X().next(()=>r.X()).next(()=>n.X())}createTargetIndexes(e,t){return t9.forEach(this.vn(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){let r=new aO(t).bn();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){let r=nc(e,r8),n=!0,i=new Map;return t9.forEach(this.vn(t),t=>this.Fn(e,t).next(e=>{n&&(n=!!e),i.set(t,e)})).next(()=>{if(n){let e=i0(),n=[];return t9.forEach(i,(i,s)=>{th(aj,`Using index id=${i.indexId}|cg=${i.collectionGroup}|f=${i.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${iS(t)}`);let a=function(e,t){let r=tY(t);if(void 0===r)return null;for(let t of iA(e,r.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),o=function(e,t){let r=new Map;for(let n of tX(t))for(let t of iA(e,n.fieldPath))switch(t.op){case"==":case"in":r.set(n.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(n.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}(s,i),u=function(e,t){let r=[],n=!0;for(let i of tX(t)){let t=0===i.kind?iD(e,i.fieldPath,e.startAt):ik(e,i.fieldPath,e.startAt);r.push(t.value),n&&(n=t.inclusive)}return new it(r,n)}(s,i),l=function(e,t){let r=[],n=!0;for(let i of tX(t)){let t=0===i.kind?ik(e,i.fieldPath,e.endAt):iD(e,i.fieldPath,e.endAt);r.push(t.value),n&&(n=t.inclusive)}return new it(r,n)}(s,i),h=this.Mn(i,s,u),c=this.Mn(i,s,l),d=this.xn(i,s,o),f=this.On(i.indexId,a,h,u.inclusive,c,l.inclusive,d);return t9.forEach(f,i=>r.Z(i,t.limit).next(t=>{t.forEach(t=>{let r=tV.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),n.push(r))})}))}).next(()=>n)}return t9.resolve(null)})}vn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let t=function e(t){if(tm(t instanceof io||t instanceof iu,34018),t instanceof io)return t;if(1===t.filters.length)return e(t.filters[0]);let r=t.filters.map(t=>e(t)),n=iu.create(r,t.op);return aP(n=aU(n))?n:(tm(n instanceof iu,64498),tm(il(n),40251),tm(n.filters.length>1,57927),n.filters.reduce((e,t)=>aF(e,t)))}(function e(t){if(tm(t instanceof io||t instanceof iu,20012),t instanceof io){if(t instanceof ib){let e=t.value.arrayValue?.values?.map(e=>io.create(t.field,"==",e))||[];return iu.create(e,"or")}return t}let r=t.filters.map(t=>e(t));return iu.create(r,t.op)}(e));return tm(aP(t),7391),aL(t)||aM(t)?[t]:t.getFilters()})(iu.create(e.filters,"and")).map(t=>iT(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t)),t}On(e,t,r,n,i,s,a){let o=(null!=t?t.length:1)*Math.max(r.length,i.length),u=o/(null!=t?t.length:1),l=[];for(let h=0;h<o;++h){let o=t?this.Nn(t[h/u]):az,c=this.Bn(e,o,r[h%u],n),d=this.Ln(e,o,i[h%u],s),f=a.map(t=>this.Bn(e,o,t,!0));l.push(...this.createRange(c,d,f))}return l}Bn(e,t,r,n){let i=new aA(e,tV.empty(),t,r);return n?i:i.En()}Ln(e,t,r,n){let i=new aA(e,tV.empty(),t,r);return n?i.En():i}Fn(e,t){let r=new aO(t),n=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,n).next(e=>{let t=null;for(let n of e)r.gn(n)&&(!t||n.fields.length>t.fields.length)&&(t=n);return t})}getIndexType(e,t){let r=2,n=this.vn(t);return t9.forEach(n,t=>this.Fn(e,t).next(e=>{e?0!==r&&e.fields.length<function(e){let t=new nw(tF.comparator),r=!1;for(let n of e.filters)for(let e of n.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(let r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+ +!!r}(t)&&(r=1):r=0})).next(()=>null!==t.limit&&n.length>1&&2===r?1:r)}kn(e,t){let r=new aC;for(let n of tX(e)){let e=t.data.field(n.fieldPath);if(null==e)return null;let i=r.ln(n.kind);aE.Wt.Dt(e,i)}return r.un()}Nn(e){let t=new aC;return aE.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){let r,n=new aC;return aE.Wt.Dt(nY(this.databaseId,t),n.ln(0===(r=tX(e)).length?0:r[r.length-1].kind)),n.un()}xn(e,t,r){if(null===r)return[];let n=[];n.push(new aC);let i=0;for(let s of tX(e)){let e=r[i++];for(let r of n)if(this.qn(t,s.fieldPath)&&nZ(e))n=this.Un(n,s,e);else{let t=r.ln(s.kind);aE.Wt.Dt(e,t)}}return this.$n(n)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){let n=[...e],i=[];for(let e of r.arrayValue.values||[])for(let r of n){let n=new aC;n.seed(r.un()),aE.Wt.Dt(e,n.ln(t.kind)),i.push(n)}return i}qn(e,t){return!!e.filters.find(e=>e instanceof io&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let r=nc(e,rX),n=nc(e,r0);return(t?r.H(rZ,IDBKeyRange.bound(t,t)):r.H()).next(e=>{let t=[];return t9.forEach(e,e=>n.get([e.indexId,this.uid]).next(r=>{let n,i;t.push((n=r?new t1(r.sequenceNumber,new t8(ac(r.readTime),new tV(rv(r.documentKey)),r.largestBatchId)):t1.empty(),i=e.fields.map(([e,t])=>new t0(tF.fromServerFormat(e),t)),new tJ(e.indexId,e.collectionGroup,i,n)))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:tD(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){let n=nc(e,rX),i=nc(e,r0);return this.Wn(e).next(e=>n.H(rZ,IDBKeyRange.bound(t,t)).next(t=>t9.forEach(t,t=>i.put(aw(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){let r=new Map;return t9.forEach(t,(t,n)=>{let i=r.get(t.collectionGroup);return(i?t9.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(r.set(t.collectionGroup,i),t9.forEach(i,r=>this.Qn(e,t,r).next(t=>{let i=this.Gn(n,r);return t.isEqual(i)?t9.resolve():this.zn(e,n,r,t,i)}))))})}jn(e,t,r,n){return nc(e,r8).put(n.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,n){return nc(e,r8).delete(n.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){let n=nc(e,r8),i=new nw(aD);return n.ee({index:r4,range:IDBKeyRange.only([r.indexId,this.uid,aN(this.Kn(r,t))])},(e,n)=>{i=i.add(new aA(r.indexId,t,aR(n.arrayValue),aR(n.directionalValue)))}).next(()=>i)}Gn(e,t){let r=new nw(aD),n=this.kn(t,e);if(null==n)return r;let i=tY(t);if(null!=i){let s=e.data.field(i.fieldPath);if(nZ(s))for(let i of s.arrayValue.values||[])r=r.add(new aA(t.indexId,e.key,this.Nn(i),n))}else r=r.add(new aA(t.indexId,e.key,az,n));return r}zn(e,t,r,n,i){th(aj,"Updating index entries for document '%s'",t.key);let s=[];return function(e,t,r,n,i){let s=e.getIterator(),a=t.getIterator(),o=nb(s),u=nb(a);for(;o||u;){let e=!1,t=!1;if(o&&u){let n=r(o,u);n<0?t=!0:n>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(n(u),u=nb(a)):t?(i(o),o=nb(s)):(o=nb(s),u=nb(a))}}(n,i,aD,n=>{s.push(this.jn(e,t,r,n))},n=>{s.push(this.Hn(e,t,r,n))}),t9.waitFor(s)}Wn(e){let t=1;return nc(e,r0).ee({index:r2,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,n)=>{n.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>aD(e,t)).filter((e,t,r)=>!t||0!==aD(e,r[t-1]));let n=[];for(let i of(n.push(e),r)){let r=aD(i,e),s=aD(i,t);if(0===r)n[0]=e.En();else if(r>0&&s<0)n.push(i),n.push(i.En());else if(s>0)break}n.push(t);let i=[];for(let e=0;e<n.length;e+=2){if(this.Jn(n[e],n[e+1]))return[];let t=n[e].An(this.uid,az,tV.empty()),r=n[e+1].An(this.uid,az,tV.empty());i.push(IDBKeyRange.bound(t,r))}return i}Jn(e,t){return aD(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(aK)}getMinOffset(e,t){return t9.mapArray(this.vn(t),t=>this.Fn(e,t).next(e=>e||tp(44426))).next(aK)}}function aK(e){tm(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let n=1;n<e.length;n++){let i=e[n].indexState.offset;0>t6(i,t)&&(t=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new t8(t.readTime,t.documentKey,r)}let aG={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class aH{static withCacheSize(e){return new aH(e,aH.DEFAULT_COLLECTION_PERCENTILE,aH.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function aQ(e,t,r){let n=e.store(rT),i=e.store(rD),s=[],a=IDBKeyRange.only(r.batchId),o=0,u=n.ee({range:a},(e,t,r)=>(o++,r.delete()));s.push(u.next(()=>{tm(1===o,47070,{batchId:r.batchId})}));let l=[];for(let e of r.mutations){var h,c;let n=(h=e.key.path,c=r.batchId,[t,rw(h),c]);s.push(i.delete(n)),l.push(e.key)}return t9.waitFor(s).next(()=>l)}function aW(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw tp(14731);t=e.noDocument}return JSON.stringify(t).length}aH.DEFAULT_COLLECTION_PERCENTILE=10,aH.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,aH.DEFAULT=new aH(0x2800000,aH.DEFAULT_COLLECTION_PERCENTILE,aH.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),aH.DISABLED=new aH(-1,0,0);class aJ{constructor(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.Zn={}}static wt(e,t,r,n){return tm(""!==e.uid,64387),new aJ(e.isAuthenticated()?e.uid:"",t,r,n)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return aX(e).ee({index:rx,range:r},(e,r,n)=>{t=!1,n.done()}).next(()=>t)}addMutationBatch(e,t,r,n){let i=nc(e,rD),s=aX(e);return s.add({}).next(a=>{var o,u,l,h;let c,d;tm("number"==typeof a,49019);let f=new sv(a,t,r,n),p=(o=this.serializer,u=this.userId,c=f.baseMutations.map(e=>s5(o.yt,e)),d=f.mutations.map(e=>s5(o.yt,e)),{userId:u,batchId:f.batchId,localWriteTimeMs:f.localWriteTime.toMillis(),baseMutations:c,mutations:d}),g=[],m=new nw((e,t)=>tD(e.canonicalString(),t.canonicalString()));for(let e of n){let t=(l=this.userId,h=e.key.path,[l,rw(h),a]);m=m.add(e.key.path.popLast()),g.push(s.put(p)),g.push(i.put(t,rA))}return m.forEach(t=>{g.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[a]=f.keys()}),t9.waitFor(g).next(()=>f)})}lookupMutationBatch(e,t){return aX(e).get(t).next(e=>e?(tm(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),ad(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?t9.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){let r=e.keys();return this.Zn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,n=IDBKeyRange.lowerBound([this.userId,r]),i=null;return aX(e).ee({index:rx,range:n},(e,t,n)=>{t.userId===this.userId&&(tm(t.batchId>=r,47524,{Yn:r}),i=ad(this.serializer,t)),n.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,1/0]),r=-1;return aX(e).ee({index:rx,range:t,reverse:!0},(e,t,n)=>{r=t.batchId,n.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,1/0]);return aX(e).H(rx,t).next(e=>e.map(e=>ad(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=[this.userId,rw(t.path)],n=IDBKeyRange.lowerBound(r),i=[];return nc(e,rD).ee({range:n},(r,n,s)=>{let[a,o,u]=r,l=rv(o);if(a===this.userId&&t.path.isEqual(l))return aX(e).get(u).next(e=>{if(!e)throw tp(61480,{er:r,batchId:u});tm(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:u}),i.push(ad(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new nw(tD),n=[];return t.forEach(t=>{let i=[this.userId,rw(t.path)],s=IDBKeyRange.lowerBound(i),a=nc(e,rD).ee({range:s},(e,n,i)=>{let[s,a,o]=e,u=rv(a);s===this.userId&&t.path.isEqual(u)?r=r.add(o):i.done()});n.push(a)}),t9.waitFor(n).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=[this.userId,rw(r)],s=IDBKeyRange.lowerBound(i),a=new nw(tD);return nc(e,rD).ee({range:s},(e,t,i)=>{let[s,o,u]=e,l=rv(o);s===this.userId&&r.isPrefixOf(l)?l.length===n&&(a=a.add(u)):i.done()}).next(()=>this.tr(e,a))}tr(e,t){let r=[],n=[];return t.forEach(t=>{n.push(aX(e).get(t).next(e=>{if(null===e)throw tp(35274,{batchId:t});tm(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(ad(this.serializer,e))}))}),t9.waitFor(n).next(()=>r)}removeMutationBatch(e,t){return aQ(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.nr(t.batchId)}),t9.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return t9.resolve();let r=IDBKeyRange.lowerBound([this.userId]),n=[];return nc(e,rD).ee({range:r},(e,t,r)=>{if(e[0]===this.userId){let t=rv(e[1]);n.push(t)}else r.done()}).next(()=>{tm(0===n.length,56720,{rr:n.map(e=>e.canonicalString())})})})}containsKey(e,t){return aY(e,this.userId,t)}ir(e){return nc(e,rI).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function aY(e,t,r){let n=[t,rw(r.path)],i=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return nc(e,rD).ee({range:s,Y:!0},(e,r,n)=>{let[s,o,u]=e;s===t&&o===i&&(a=!0),n.done()}).next(()=>a)}function aX(e){return nc(e,rT)}class aZ{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new aZ(0)}static ar(){return new aZ(-1)}}class a0{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next(t=>{let r=new aZ(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(e=>tW.fromTimestamp(new tQ(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.ur(e).next(n=>(n.highestListenSequenceNumber=t,r&&(n.lastRemoteSnapshotVersion=r.toTimestamp()),t>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t),this.cr(e,n)))}addTargetData(e,t){return this.lr(e,t).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>nc(e,rV).delete(t.targetId)).next(()=>this.ur(e)).next(t=>(tm(t.targetCount>0,8065),t.targetCount-=1,this.cr(e,t)))}removeTargets(e,t,r){let n=0,i=[];return nc(e,rV).ee((s,a)=>{let o=af(a);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(n++,i.push(this.removeTargetData(e,o)))}).next(()=>t9.waitFor(i)).next(()=>n)}forEachTarget(e,t){return nc(e,rV).ee((e,r)=>{t(af(r))})}ur(e){return nc(e,rG).get(rK).next(e=>(tm(null!==e,2888),e))}cr(e,t){return nc(e,rG).put(rK,t)}lr(e,t){return nc(e,rV).put(ap(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(e=>e.targetCount)}getTargetData(e,t){let r=iS(t),n=IDBKeyRange.bound([r,-1/0],[r,1/0]),i=null;return nc(e,rV).ee({range:n,index:rU},(e,r,n)=>{let s=af(r);ix(t,s.target)&&(i=s,n.done())}).next(()=>i)}addMatchingKeys(e,t,r){let n=[],i=a1(e);return t.forEach(t=>{let s=rw(t.path);n.push(i.put({targetId:r,path:s})),n.push(this.referenceDelegate.addReference(e,r,t))}),t9.waitFor(n)}removeMatchingKeys(e,t,r){let n=a1(e);return t9.forEach(t,t=>{let i=rw(t.path);return t9.waitFor([n.delete([r,i]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){let r=a1(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),n=a1(e),i=i0();return n.ee({range:r,Y:!0},(e,t,r)=>{let n=new tV(rv(e[1]));i=i.add(n)}).next(()=>i)}containsKey(e,t){let r=rw(t.path),n=IDBKeyRange.bound([r],[r+"\0"],!1,!0),i=0;return a1(e).ee({index:rz,Y:!0,range:n},([e,t],r,n)=>{0!==e&&(i++,n.done())}).next(()=>i>0)}At(e,t){return nc(e,rV).get(t).next(e=>e?af(e):null)}}function a1(e){return nc(e,rq)}let a2="LruGarbageCollector";function a3([e,t],[r,n]){let i=tD(e,r);return 0===i?tD(t,n):i}class a8{constructor(e){this.Pr=e,this.buffer=new nw(a3),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>a3(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class a6{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Ar(e){th(a2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ra(e)?th(a2,"Ignoring IndexedDB error during garbage collection: ",e):await t7(e)}await this.Ar(3e5)})}}class a4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return t9.resolve(rp.ce);let r=new a8(t);return this.Vr.forEachTarget(e,e=>r.Er(e.sequenceNumber)).next(()=>this.Vr.mr(e,e=>r.Er(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(th("LruGarbageCollector","Garbage collection skipped; disabled"),t9.resolve(aG)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(th("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aG):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,n,i,s,a,o,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(th("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,s=Date.now(),this.nthSequenceNumber(e,n))).next(n=>(r=n,a=Date.now(),this.removeTargets(e,r,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(l=Date.now(),tl()<=u.DEBUG&&th("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${n} in `+(a-s)+"ms\n"+`	Removed ${i} targets in `+(o-a)+"ms\n"+`	Removed ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-h}ms`),t9.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})))}}class a5{constructor(e,t){this.db=e,this.garbageCollector=new a4(this,t)}dr(e){let t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,(e,r)=>t(r))}addReference(e,t,r){return a7(e,r)}removeReference(e,t,r){return a7(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return a7(e,t)}wr(e,t){let r;return r=!1,nc(e,rI).te(n=>aY(e,n,t).next(e=>(e&&(r=!0),t9.resolve(!e)))).next(()=>r)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),n=[],i=0;return this.yr(e,(s,a)=>{if(a<=t){let t=this.wr(e,s).next(t=>{if(!t)return i++,r.getEntry(e,s).next(()=>(r.removeEntry(s,tW.min()),a1(e).delete([0,rw(s.path)])))});n.push(t)}}).next(()=>t9.waitFor(n)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return a7(e,t)}yr(e,t){let r=a1(e),n,i=rp.ce;return r.ee({index:rz},([e,r],{path:s,sequenceNumber:a})=>{0===e?(i!==rp.ce&&t(new tV(rv(n)),i),i=a,n=s):i=rp.ce}).next(()=>{i!==rp.ce&&t(new tV(rv(n)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function a7(e,t){var r;return a1(e).put((r=e.currentSequenceNumber,{targetId:0,path:rw(t.path),sequenceNumber:r}))}class a9{constructor(){this.changes=new iG(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ie.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?t9.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class oe{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return nc(e,rk).put(r)}removeEntry(e,t,r){let n;return nc(e,rk).delete([(n=t.path.toArray()).slice(0,n.length-2),n[n.length-2],al(r),n[n.length-1]])}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=ie.newInvalidDocument(t);return nc(e,rk).ee({index:rR,range:IDBKeyRange.only(or(t))},(e,n)=>{r=this.Sr(t,n)}).next(()=>r)}Dr(e,t){let r={size:0,document:ie.newInvalidDocument(t)};return nc(e,rk).ee({index:rR,range:IDBKeyRange.only(or(t))},(e,n)=>{r={document:this.Sr(t,n),size:aW(n)}}).next(()=>r)}getEntries(e,t){let r=iH;return this.Cr(e,t,(e,t)=>{let n=this.Sr(e,t);r=r.insert(e,n)}).next(()=>r)}vr(e,t){let r=iH,n=new ng(tV.comparator);return this.Cr(e,t,(e,t)=>{let i=this.Sr(e,t);r=r.insert(e,i),n=n.insert(e,aW(t))}).next(()=>({documents:r,Fr:n}))}Cr(e,t,r){if(t.isEmpty())return t9.resolve();let n=new nw(oi);t.forEach(e=>n=n.add(e));let i=IDBKeyRange.bound(or(n.first()),or(n.last())),s=n.getIterator(),a=s.getNext();return nc(e,rk).ee({index:rR,range:i},(e,t,n)=>{let i=tV.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>oi(a,i);)r(a,null),a=s.getNext();a&&a.isEqual(i)&&(r(a,t),a=s.hasNext()?s.getNext():null),a?n.j(or(a)):n.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,n,i){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),al(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return nc(e,rk).H(IDBKeyRange.bound(a,o,!0)).next(e=>{i?.incrementDocumentReadCount(e.length);let r=iH;for(let i of e){let e=this.Sr(tV.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(iz(t,e)||n.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,n){let i=iH,s=on(t,r),a=on(t,t8.max());return nc(e,rk).ee({index:rL,range:IDBKeyRange.bound(s,a,!0)},(e,t,r)=>{let s=this.Sr(tV.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===n&&r.done()}).next(()=>i)}newChangeBuffer(e){return new ot(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return nc(e,rP).get(rF).next(e=>(tm(!!e,20021),e))}br(e,t){return nc(e,rP).put(rF,t)}Sr(e,t){if(t){let e=function(e,t){var r;let n,i;if(t.document)n=s4(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=tV.fromSegments(t.noDocument.path),r=ac(t.noDocument.readTime);n=ie.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return tp(56709);{let e=tV.fromSegments(t.unknownDocument.path),r=ac(t.unknownDocument.version);n=ie.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime((i=new tQ((r=t.readTime)[0],r[1]),tW.fromTimestamp(i))),n}(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(tW.min())))return e}return ie.newInvalidDocument(e)}}class ot extends a9{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new iG(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],r=0,n=new nw((e,t)=>tD(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.Or.get(i);if(t.push(this.Mr.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=au(this.Mr.serializer,s);n=n.add(i.path.popLast());let u=aW(o);r+=u-a.size,t.push(this.Mr.addEntry(e,i,o))}else if(r-=a.size,this.trackRemovals){let r=au(this.Mr.serializer,s.convertToNoDocument(tW.min()));t.push(this.Mr.addEntry(e,i,r))}}),n.forEach(r=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.Mr.updateMetadata(e,r)),t9.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next(e=>(this.Or.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Mr.vr(e,t).next(({documents:e,Fr:t})=>(t.forEach((t,r)=>{this.Or.set(t,{size:r,readTime:e.get(t).readTime})}),e))}}function or(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function on(e,t){let r=t.documentKey.path.toArray();return[e,al(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function oi(e,t){let r=e.path.toArray(),n=t.path.toArray(),i=0;for(let e=0;e<r.length-2&&e<n.length-2;++e)if(i=tD(r[e],n[e]))return i;return(i=tD(r.length,n.length))||(i=tD(r[r.length-2],n[n.length-2]))||tD(r[r.length-1],n[n.length-1])}class os{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oa{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&sh(r.mutation,e,n_.empty(),tQ.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,i0()).next(()=>t))}getLocalViewOfDocuments(e,t,r=i0()){let n=iY();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=iW();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=iY();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i0()))}populateOverlays(e,t,r){let n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let i=iH,s=iY(),a=iY();return t.forEach((e,t)=>{let a=r.get(t.key);n.has(t.key)&&(void 0===a||a.mutation instanceof sf)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),sh(a.mutation,t,a.mutation.getFieldMask(),tQ.now())):s.set(t.key,n_.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>a.set(e,new os(t,s.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){let r=iY(),n=new ng((e,t)=>e-t),i=i0();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||n_.empty();a=i.applyToLocalView(s,a),r.set(e,a);let o=(n.get(i.batchId)||i0()).add(e);n=n.insert(i.batchId,o)})}).next(()=>{let s=[],a=n.getReverseIterator();for(;a.hasNext();){let n=a.getNext(),o=n.key,u=n.value,l=iY();u.forEach(e=>{if(!i.has(e)){let n=sl(t.get(e),r.get(e));null!==n&&l.set(e,n),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,l))}return t9.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return tV.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):iL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(i=>{let s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):t9.resolve(iY()),a=-1,o=i;return s.next(t=>t9.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(t)?t9.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,i0())).next(e=>({batchId:a,changes:iJ(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new tV(t)).next(e=>{let t=iW();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){let i=t.collectionGroup,s=iW();return this.indexManager.getCollectionParents(e,i).next(a=>t9.forEach(a,a=>{let o=new iN(a.child(i),null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n))).next(e=>{i.forEach((t,r)=>{let n=r.getKey();null===e.get(n)&&(e=e.insert(n,ie.newInvalidDocument(n)))});let r=iW();return e.forEach((e,n)=>{let s=i.get(e);void 0!==s&&sh(s.mutation,n,n_.empty(),tQ.now()),iz(t,n)&&(r=r.insert(e,n))}),r})}}class oo{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return t9.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,{id:t.id,version:t.version,createTime:sW(t.createTime)}),t9.resolve()}getNamedQuery(e,t){return t9.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,{name:t.name,query:ag(t.bundledQuery),readTime:sW(t.readTime)}),t9.resolve()}}class ou{constructor(){this.overlays=new ng(tV.comparator),this.Lr=new Map}getOverlay(e,t){return t9.resolve(this.overlays.get(t))}getOverlays(e,t){let r=iY();return t9.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.bt(e,t,n)}),t9.resolve()}removeOverlaysForBatchId(e,t,r){let n=this.Lr.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Lr.delete(r)),t9.resolve()}getOverlaysForCollection(e,t,r){let n=iY(),i=t.length+1,s=new tV(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return t9.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new ng((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=iY(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=iY(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=n)););return t9.resolve(a)}bt(e,t,r){let n=this.overlays.get(r.key);if(null!==n){let e=this.Lr.get(n.largestBatchId).delete(r.key);this.Lr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new s_(t,r));let i=this.Lr.get(t);void 0===i&&(i=i0(),this.Lr.set(t,i)),this.Lr.set(t,i.add(r.key))}}class ol{constructor(){this.sessionToken=nI.EMPTY_BYTE_STRING}getSessionToken(e){return t9.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,t9.resolve()}}class oh{constructor(){this.kr=new nw(oc.Kr),this.qr=new nw(oc.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new oc(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new oc(e,t))}Qr(e,t){e.forEach(e=>this.removeReference(e,t))}Gr(e){let t=new tV(new tM([])),r=new oc(t,e),n=new oc(t,e+1),i=[];return this.qr.forEachInRange([r,n],e=>{this.Wr(e),i.push(e.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new tV(new tM([])),r=new oc(t,e),n=new oc(t,e+1),i=i0();return this.qr.forEachInRange([r,n],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new oc(e,0),r=this.kr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class oc{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return tV.comparator(e.key,t.key)||tD(e.Hr,t.Hr)}static Ur(e,t){return tD(e.Hr,t.Hr)||tV.comparator(e.key,t.key)}}class od{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new nw(oc.Kr)}checkEmpty(e){return t9.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){let i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new sv(i,t,r,n);for(let t of(this.mutationQueue.push(s),n))this.Jr=this.Jr.add(new oc(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return t9.resolve(s)}lookupMutationBatch(e,t){return t9.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=this.Xr(t+1),n=r<0?0:r;return t9.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return t9.resolve(0===this.mutationQueue.length?-1:this.Yn-1)}getAllMutationBatches(e){return t9.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new oc(t,0),n=new oc(t,1/0),i=[];return this.Jr.forEachInRange([r,n],e=>{let t=this.Zr(e.Hr);i.push(t)}),t9.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new nw(tD);return t.forEach(e=>{let t=new oc(e,0),n=new oc(e,1/0);this.Jr.forEachInRange([t,n],e=>{r=r.add(e.Hr)})}),t9.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;tV.isDocumentKey(i)||(i=i.child(""));let s=new oc(new tV(i),0),a=new nw(tD);return this.Jr.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.Hr)),!0)},s),t9.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(e=>{let r=this.Zr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){tm(0===this.ei(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Jr;return t9.forEach(t.mutations,n=>{let i=new oc(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new oc(t,0),n=this.Jr.firstAfterOrEqual(r);return t9.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,t9.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class of{constructor(e){this.ti=e,this.docs=new ng(tV.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return t9.resolve(r?r.document.mutableCopy():ie.newInvalidDocument(t))}getEntries(e,t){let r=iH;return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():ie.newInvalidDocument(e))}),t9.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=iH,s=t.path,a=new tV(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=t6(t3(a),r)||(n.has(a.key)||iz(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return t9.resolve(i)}getAllFromCollectionGroup(e,t,r,n){tp(9500)}ni(e,t){return t9.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new op(this)}getSize(e){return t9.resolve(this.size)}}class op extends a9{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.Mr.addEntry(e,n)):this.Mr.removeEntry(r)}),t9.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class og{constructor(e){this.persistence=e,this.ri=new iG(e=>iS(e),ix),this.lastRemoteSnapshotVersion=tW.min(),this.highestTargetId=0,this.ii=0,this.si=new oh,this.targetCount=0,this.oi=aZ._r()}forEachTarget(e,t){return this.ri.forEach((e,r)=>t(r)),t9.resolve()}getLastRemoteSnapshotVersion(e){return t9.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return t9.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),t9.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),t9.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new aZ(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,t9.resolve()}updateTargetData(e,t){return this.lr(t),t9.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,t9.resolve()}removeTargets(e,t,r){let n=0,i=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.ri.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)}),t9.waitFor(i).next(()=>n)}getTargetCount(e){return t9.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return t9.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),t9.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(t=>{i.push(n.markPotentiallyOrphaned(e,t))}),t9.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),t9.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return t9.resolve(r)}containsKey(e,t){return t9.resolve(this.si.containsKey(t))}}class om{constructor(e,t){this._i={},this.overlays={},this.ai=new rp(0),this.ui=!1,this.ui=!0,this.ci=new ol,this.referenceDelegate=e(this),this.li=new og(this),this.indexManager=new aB,this.remoteDocumentCache=new of(e=>this.referenceDelegate.hi(e)),this.serializer=new ao(t),this.Pi=new oo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ou,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new od(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){th("MemoryPersistence","Starting transaction:",e);let n=new oy(this.ai.next());return this.referenceDelegate.Ti(),r(n).next(e=>this.referenceDelegate.Ii(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Ei(e,t){return t9.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}}class oy extends t5{constructor(e){super(),this.currentSequenceNumber=e}}class ow{constructor(e){this.persistence=e,this.Ri=new oh,this.Ai=null}static Vi(e){return new ow(e)}get di(){if(this.Ai)return this.Ai;throw tp(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),t9.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),t9.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),t9.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(e=>this.di.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.di.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return t9.forEach(this.di,r=>{let n=tV.fromPath(r);return this.mi(e,n).next(e=>{e||t.removeEntry(n,tW.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(e=>{e?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return t9.or([()=>t9.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ov{constructor(e,t){this.persistence=e,this.fi=new iG(e=>rw(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=new a4(this,t)}static Vi(e,t){return new ov(e,t)}Ti(){}Ii(e){return t9.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}mr(e,t){return t9.forEach(this.fi,(r,n)=>this.wr(e,r,n).next(e=>e?t9.resolve():t(n)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.ni(e,n=>this.wr(e,n,t).next(e=>{e||(r++,i.removeEntry(n,tW.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),t9.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),t9.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),t9.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),t9.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=function e(t){switch(n$(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=nO(t);return r?16+e(r):16;case 5:return 2*t.stringValue.length;case 6:return nC(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(t.arrayValue.values||[]).reduce((t,r)=>t+e(r),0);case 10:case 11:var n;let i;return n=t.mapValue,i=0,nf(n.fields,(t,r)=>{i+=t.length+e(r)}),i;default:throw tp(13486,{value:t})}}(e.data.value)),t}wr(e,t,r){return t9.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.fi.get(t);return t9.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ob{constructor(e){this.serializer=e}k(e,t,r,n){let i=new rt("createOrUpgrade",t);r<1&&n>=1&&(e.createObjectStore(r_),e.createObjectStore(rI,{keyPath:"userId"}),e.createObjectStore(rT,{keyPath:rS,autoIncrement:!0}).createIndex(rx,rC,{unique:!0}),e.createObjectStore(rD),o_(e),e.createObjectStore(rb));let s=t9.resolve();return r<3&&n>=3&&(0!==r&&(e.deleteObjectStore(rq),e.deleteObjectStore(rV),e.deleteObjectStore(rG),o_(e)),s=s.next(()=>{let e,t;return e=i.store(rG),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:tW.min().toTimestamp(),targetCount:0},e.put(rK,t)})),r<4&&n>=4&&(0!==r&&(s=s.next(()=>i.store(rT).H().next(t=>{e.deleteObjectStore(rT),e.createObjectStore(rT,{keyPath:rS,autoIncrement:!0}).createIndex(rx,rC,{unique:!0});let r=i.store(rT),n=t.map(e=>r.put(e));return t9.waitFor(n)}))),s=s.next(()=>{e.createObjectStore(rW,{keyPath:"clientId"})})),r<5&&n>=5&&(s=s.next(()=>this.gi(i))),r<6&&n>=6&&(s=s.next(()=>(e.createObjectStore(rP),this.pi(i)))),r<7&&n>=7&&(s=s.next(()=>this.yi(i))),r<8&&n>=8&&(s=s.next(()=>this.wi(e,i))),r<9&&n>=9&&(s=s.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),r<10&&n>=10&&(s=s.next(()=>this.bi(i))),r<11&&n>=11&&(s=s.next(()=>{e.createObjectStore(rJ,{keyPath:"bundleId"}),e.createObjectStore(rY,{keyPath:"name"})})),r<12&&n>=12&&(s=s.next(()=>{let t;(t=e.createObjectStore(r7,{keyPath:r9})).createIndex(ne,nt,{unique:!1}),t.createIndex(nr,nn,{unique:!1})})),r<13&&n>=13&&(s=s.next(()=>{let t;(t=e.createObjectStore(rk,{keyPath:rN})).createIndex(rR,rO),t.createIndex(rL,rM)}).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(rb))),r<14&&n>=14&&(s=s.next(()=>this.Di(e,i))),r<15&&n>=15&&(s=s.next(()=>{e.createObjectStore(rX,{keyPath:"indexId",autoIncrement:!0}).createIndex(rZ,"collectionGroup",{unique:!1}),e.createObjectStore(r0,{keyPath:r1}).createIndex(r2,r3,{unique:!1}),e.createObjectStore(r8,{keyPath:r6}).createIndex(r4,r5,{unique:!1})})),r<16&&n>=16&&(s=s.next(()=>{t.objectStore(r0).clear()}).next(()=>{t.objectStore(r8).clear()})),r<17&&n>=17&&(s=s.next(()=>{e.createObjectStore(ni,{keyPath:"name"})})),r<18&&n>=18&&Q()&&(s=s.next(()=>{t.objectStore(r0).clear()}).next(()=>{t.objectStore(r8).clear()})),s}pi(e){let t=0;return e.store(rb).ee((e,r)=>{t+=aW(r)}).next(()=>{let r={byteSize:t};return e.store(rP).put(rF,r)})}gi(e){let t=e.store(rI),r=e.store(rT);return t.H().next(t=>t9.forEach(t,t=>{let n=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return r.H(rx,n).next(r=>t9.forEach(r,r=>{tm(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});let n=ad(this.serializer,r);return aQ(e,t.userId,n).next(()=>{})}))}))}yi(e){let t=e.store(rq),r=e.store(rb);return e.store(rG).get(rK).next(e=>{let n=[];return r.ee((r,i)=>{let s=new tM(r),a=[0,rw(s)];n.push(t.get(a).next(r=>r?t9.resolve():t.put({targetId:0,path:rw(s),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>t9.waitFor(n))})}wi(e,t){e.createObjectStore(rH,{keyPath:rQ});let r=t.store(rH),n=new aq,i=e=>{if(n.add(e)){let t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:rw(n)})}};return t.store(rb).ee({Y:!0},(e,t)=>i(new tM(e).popLast())).next(()=>t.store(rD).ee({Y:!0},([e,t,r],n)=>i(rv(t).popLast())))}bi(e){let t=e.store(rV);return t.ee((e,r)=>{let n=af(r),i=ap(this.serializer,n);return t.put(i)})}Si(e,t){let r=t.store(rb),n=[];return r.ee((e,r)=>{let i=t.store(rk),s=(r.document?new tV(tM.fromString(r.document.name).popFirst(5)):r.noDocument?tV.fromSegments(r.noDocument.path):r.unknownDocument?tV.fromSegments(r.unknownDocument.path):tp(36783)).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};n.push(i.put(a))}).next(()=>t9.waitFor(n))}Di(e,t){let r=t.store(rT),n=new oe(this.serializer),i=new om(ow.Vi,this.serializer.yt);return r.H().next(e=>{let r=new Map;return e.forEach(e=>{let t=r.get(e.userId)??i0();ad(this.serializer,e).keys().forEach(e=>t=t.add(e)),r.set(e.userId,t)}),t9.forEach(r,(e,r)=>{let s=new ta(r),a=ab.wt(this.serializer,s),o=i.getIndexManager(s);return new oa(n,aJ.wt(s,this.serializer,o,i.referenceDelegate),a,o).recalculateAndSaveOverlaysForDocumentKeys(new nh(t,rp.ce),e).next()})})}}function o_(e){e.createObjectStore(rq,{keyPath:rj}).createIndex(rz,r$,{unique:!0}),e.createObjectStore(rV,{keyPath:"targetId"}).createIndex(rU,rB,{unique:!0}),e.createObjectStore(rG)}let oE="IndexedDbPersistence",oI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class oT{constructor(e,t,r,n,i,s,a,o,u,l,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=i,this.window=s,this.document=a,this.Fi=u,this.Mi=l,this.xi=h,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=-1/0,this.ki=e=>Promise.resolve(),!oT.v())throw new tw(ty.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new a5(this,n),this.Ki=t+"main",this.serializer=new ao(o),this.qi=new rr(this.Ki,this.xi,new ob(this.serializer)),this.ci=new a_,this.li=new a0(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new oe(this.serializer),this.Pi=new av,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===l&&tc(oE,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new tw(ty.FAILED_PRECONDITION,oI);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new rp(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>nc(e,rW).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(e=>{e||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Ji(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(ra(e))return th(oE,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return th(oE,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return nc(e,r_).get(rE).next(e=>t9.resolve(this.Xi(e)))}Yi(e){return nc(e,rW).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,18e5)){this.Li=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=nc(e,rW);return t.H().next(e=>{let r=this.ns(e,18e5),n=e.filter(e=>-1===r.indexOf(e));return t9.forEach(n,e=>t.delete(e.clientId)).next(()=>n)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?t9.resolve(!0):nc(e,r_).get(rE).next(t=>{if(null!==t&&this.ts(t.leaseTimestampMs,5e3)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new tw(ty.FAILED_PRECONDITION,oI);return!1}}return!(!this.networkEnabled||!this.inForeground)||nc(e,rW).H().next(e=>void 0===this.ns(e,5e3).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,n=this.networkEnabled===e.networkEnabled;if(t||r&&n)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&th(oE,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[r_,rW],e=>{let t=new nh(e,rp.ce);return this.Ji(t).next(()=>this.Yi(t))}),this.qi.close(),this.ls()}ns(e,t){return e.filter(e=>this.ts(e.updateTimeMs,t)&&!this.ss(e.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>nc(e,rW).H().next(e=>this.ns(e,18e5).map(e=>e.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return aJ.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new a$(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ab.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){var n;let i;th(oE,"Starting transaction:",e);let s=18===(n=this.xi)||17===n?nl:16===n||15===n?nu:14===n||13===n?no:12===n?na:11===n?ns:void tp(60245);return this.qi.runTransaction(e,"readonly"===t?"readonly":"readwrite",s,n=>(i=new nh(n,this.ai?this.ai.next():rp.ce),"readwrite-primary"===t?this.ji(i).next(e=>!!e||this.Hi(i)).next(t=>{if(!t)throw tc(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new tw(ty.FAILED_PRECONDITION,t4);return r(i)}).next(e=>this.Zi(i).next(()=>e)):this.Ps(i).next(()=>r(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}Ps(e){return nc(e,r_).get(rE).next(e=>{if(null!==e&&this.ts(e.leaseTimestampMs,5e3)&&!this.ss(e.ownerId)&&!this.Xi(e)&&!(this.Mi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new tw(ty.FAILED_PRECONDITION,oI)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return nc(e,r_).put(rE,t)}static v(){return rr.v()}Ji(e){let t=nc(e,r_);return t.get(rE).next(e=>this.Xi(e)?(th(oE,"Releasing primary lease."),t.delete(rE)):t9.resolve())}ts(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(tc(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){"function"==typeof this.window?.addEventListener&&(this.Oi=()=>{this._s();let e=/(?:Version|Mobile)\/1[456]/;H()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{let t=null!==this.Ui?.getItem(this.rs(e));return th(oE,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(e){return tc(oE,"Failed to get zombied client id.",e),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){tc("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch(e){}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function oS(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class ox{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=n}static Es(e,t){let r=i0(),n=i0();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new ox(e,t.fromCache,r,n)}}class oC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class oA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=H()?8:rn($())>0?6:4}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,n){let i={result:null};return this.gs(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ps(e,t,n,r).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let r=new oC;return this.ys(e,t,r).next(n=>{if(i.result=n,this.As)return this.ws(e,t,r,n.size)})}).next(()=>i.result)}ws(e,t,r,n){return r.documentReadCount<this.Vs?(tl()<=u.DEBUG&&th("QueryEngine","SDK will not create cache indexes for query:",ij(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),t9.resolve()):(tl()<=u.DEBUG&&th("QueryEngine","Query:",ij(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ds*n?(tl()<=u.DEBUG&&th("QueryEngine","The SDK decides to create cache indexes for query:",ij(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,iP(t))):t9.resolve())}gs(e,t){if(iO(t))return t9.resolve(null);let r=iP(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(r=iP(t=iU(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{let i=i0(...n);return this.fs.getDocuments(e,i).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.bs(t,n);return this.Ss(t,s,i,r.readTime)?this.gs(e,iU(t,null,"F")):this.Ds(e,s,t,r)}))})))}ps(e,t,r,n){return iO(t)||n.isEqual(tW.min())?t9.resolve(null):this.fs.getDocuments(e,r).next(i=>{let s=this.bs(t,i);return this.Ss(t,s,r,n)?t9.resolve(null):(tl()<=u.DEBUG&&th("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ij(t)),this.Ds(e,s,t,t2(n,-1)).next(e=>e))})}bs(e,t){let r=new nw(iK(e));return t.forEach((t,n)=>{iz(e,n)&&(r=r.add(n))}),r}Ss(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}ys(e,t,r){return tl()<=u.DEBUG&&th("QueryEngine","Using full collection scan to execute query:",ij(t)),this.fs.getDocumentsMatchingQuery(e,t,t8.min(),r)}Ds(e,t,r,n){return this.fs.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let oD="LocalStore";class ok{constructor(e,t,r,n){this.persistence=e,this.Cs=t,this.serializer=n,this.vs=new ng(tD),this.Fs=new iG(e=>iS(e),ix),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oa(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}}async function oN(e,t){return await e.persistence.runTransaction("Handle user change","readonly",r=>{let n;return e.mutationQueue.getAllMutationBatches(r).next(i=>(n=i,e.Os(t),e.mutationQueue.getAllMutationBatches(r))).next(t=>{let i=[],s=[],a=i0();for(let e of n)for(let t of(i.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return e.localDocuments.getDocuments(r,a).next(e=>({Ns:e,removedBatchIds:i,addedBatchIds:s}))})})}function oR(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function oO(e,t,r){let n=i0(),i=i0();return r.forEach(e=>n=n.add(e)),t.getEntries(e,n).next(e=>{let n=iH;return r.forEach((r,s)=>{let a=e.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(tW.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):th(oD,"Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)}),{Bs:n,Ls:i}})}function oL(e,t){return e.persistence.runTransaction("Allocate target","readwrite",r=>{let n;return e.li.getTargetData(r,t).next(i=>i?(n=i,t9.resolve(n)):e.li.allocateTargetId(r).next(i=>(n=new aa(t,i,"TargetPurposeListen",r.currentSequenceNumber),e.li.addTargetData(r,n).next(()=>n))))}).then(r=>{let n=e.vs.get(r.targetId);return(null===n||r.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(e.vs=e.vs.insert(r.targetId,r),e.Fs.set(t,r.targetId)),r})}async function oM(e,t,r){let n=e.vs.get(t);try{r||await e.persistence.runTransaction("Release target",r?"readwrite":"readwrite-primary",t=>e.persistence.referenceDelegate.removeTarget(t,n))}catch(e){if(!ra(e))throw e;th(oD,`Failed to update sequence numbers for target ${t}: ${e}`)}e.vs=e.vs.remove(t),e.Fs.delete(n.target)}function oP(e,t,r){let n=tW.min(),i=i0();return e.persistence.runTransaction("Execute query","readwrite",s=>{var a;let o;return(a=iP(t),void 0!==(o=e.Fs.get(a))?t9.resolve(e.vs.get(o)):e.li.getTargetData(s,a)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,e.li.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Cs.getDocumentsMatchingQuery(s,t,r?n:tW.min(),r?i:i0())).next(r=>(oU(e,i$(t),r),{documents:r,ks:i}))})}function oF(e,t){let r=e.li,n=e.vs.get(t);return n?Promise.resolve(n.target):e.persistence.runTransaction("Get target data","readonly",e=>r.At(e,t).next(e=>e?e.target:null))}function oV(e,t){let r=e.Ms.get(t)||tW.min();return e.persistence.runTransaction("Get new document changes","readonly",n=>e.xs.getAllFromCollectionGroup(n,t,t2(r,-1),Number.MAX_SAFE_INTEGER)).then(r=>(oU(e,t,r),r))}function oU(e,t,r){let n=e.Ms.get(t)||tW.min();r.forEach((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)}),e.Ms.set(t,n)}async function oB(e,t,r,n){let i=i0(),s=iH;for(let e of r){let r=t.Ks(e.metadata.name);e.document&&(i=i.add(r));let n=t.qs(e);n.setReadTime(t.Us(e.metadata.readTime)),s=s.insert(r,n)}let a=e.xs.newChangeBuffer({trackRemovals:!0}),o=await oL(e,iP(iR(tM.fromString(`__bundle__/docs/${n}`))));return e.persistence.runTransaction("Apply bundle documents","readwrite",t=>oO(t,a,s).next(e=>(a.apply(t),e)).next(r=>e.li.removeMatchingKeysForTargetId(t,o.targetId).next(()=>e.li.addMatchingKeys(t,i,o.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(t,r.Bs,r.Ls)).next(()=>r.Bs)))}async function oq(e,t,r=i0()){let n=await oL(e,iP(ag(t.bundledQuery)));return e.persistence.runTransaction("Save named query","readwrite",i=>{let s=sW(t.readTime);if(n.snapshotVersion.compareTo(s)>=0)return e.Pi.saveNamedQuery(i,t);let a=n.withResumeToken(nI.EMPTY_BYTE_STRING,s);return e.vs=e.vs.insert(a.targetId,a),e.li.updateTargetData(i,a).next(()=>e.li.removeMatchingKeysForTargetId(i,n.targetId)).next(()=>e.li.addMatchingKeys(i,r,n.targetId)).next(()=>e.Pi.saveNamedQuery(i,t))})}let oj="firestore_clients";function oz(e,t){return`${oj}_${e}_${t}`}let o$="firestore_mutations";function oK(e,t,r){let n=`${o$}_${e}_${r}`;return t.isAuthenticated()&&(n+=`_${t.uid}`),n}let oG="firestore_targets";function oH(e,t){return`${oG}_${e}_${t}`}let oQ="SharedClientState";class oW{constructor(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n}static $s(e,t,r){let n=JSON.parse(r),i,s="object"==typeof n&&-1!==["pending","acknowledged","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new tw(n.error.code,n.error.message)),s?new oW(e,t,n.state,i):(tc(oQ,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class oJ{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){let r=JSON.parse(t),n,i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new tw(r.error.code,r.error.message)),i?new oJ(e,r.state,n):(tc(oQ,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class oY{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){let r=JSON.parse(t),n="object"==typeof r&&r.activeTargetIds instanceof Array,i=i1;for(let e=0;n&&e<r.activeTargetIds.length;++e)n=ry(r.activeTargetIds[e]),i=i.add(r.activeTargetIds[e]);return n?new oY(e,i):(tc(oQ,`Failed to parse client data for instance '${e}': ${t}`),null)}}class oX{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new oX(t.clientId,t.onlineState):(tc(oQ,`Failed to parse online state: ${e}`),null)}}class oZ{constructor(){this.activeTargetIds=i1}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class o0{constructor(e,t,r,n,i){var s,a,o;this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new ng(tD),this.started=!1,this.Zs=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=oz(this.persistenceKey,this.zs),this.Ys=(s=this.persistenceKey,`firestore_sequence_number_${s}`),this.Js=this.Js.insert(this.zs,new oZ),this.eo=RegExp(`^${oj}_${u}_([^_]*)$`),this.no=RegExp(`^${o$}_${u}_(\\d+)(?:_(.*))?$`),this.ro=RegExp(`^${oG}_${u}_(\\d+)$`),this.io=(a=this.persistenceKey,`firestore_online_state_${a}`),this.so=(o=this.persistenceKey,`firestore_bundle_loaded_v2_${o}`),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){for(let e of(await this.syncEngine.hs())){if(e===this.zs)continue;let t=this.getItem(oz(this.persistenceKey,e));if(t){let r=oY.$s(e,t);r&&(this.Js=this.Js.insert(r.clientId,r))}}this.oo();let e=this.storage.getItem(this.io);if(e){let t=this._o(e);t&&this.ao(t)}for(let e of this.Zs)this.Hs(e);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach((r,n)=>{n.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let t=this.storage.getItem(oH(this.persistenceKey,e));if(t){let n=oJ.$s(e,t);n&&(r=n.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(oH(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.lo(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return th(oQ,"READ",e,t),t}setItem(e,t){th(oQ,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){th(oQ,"REMOVE",e),this.storage.removeItem(e)}Hs(e){if(e.storageArea===this.storage){if(th(oQ,"EVENT",e.key,e.newValue),e.key===this.Xs)return void tc("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(null!==e.key){if(this.eo.test(e.key)){if(null==e.newValue){let t=this.Eo(e.key);return this.Ro(t,null)}{let t=this.Ao(e.key,e.newValue);if(t)return this.Ro(t.clientId,t)}}else if(this.no.test(e.key)){if(null!==e.newValue){let t=this.Vo(e.key,e.newValue);if(t)return this.mo(t)}}else if(this.ro.test(e.key)){if(null!==e.newValue){let t=this.fo(e.key,e.newValue);if(t)return this.po(t)}}else if(e.key===this.io){if(null!==e.newValue){let t=this._o(e.newValue);if(t)return this.ao(t)}}else if(e.key===this.Ys){let t=function(e){let t=rp.ce;if(null!=e)try{let r=JSON.parse(e);tm("number"==typeof r,30636,{yo:e}),t=r}catch(e){tc(oQ,"Failed to read sequence number from WebStorage",e)}return t}(e.newValue);t!==rp.ce&&this.sequenceNumberHandler(t)}else if(e.key===this.so){let t=this.wo(e.newValue);await Promise.all(t.map(e=>this.syncEngine.bo(e)))}}}else this.Zs.push(e)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){let n=new oW(this.currentUser,e,t,r),i=oK(this.persistenceKey,this.currentUser,e);this.setItem(i,n.Ws())}lo(e){let t=oK(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){let t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){let n=oH(this.persistenceKey,e),i=new oJ(e,t,r);this.setItem(n,i.Ws())}Io(e){let t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){let t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){let r=this.Eo(e);return oY.$s(r,t)}Vo(e,t){let r=this.no.exec(e),n=Number(r[1]),i=void 0!==r[2]?r[2]:null;return oW.$s(new ta(i),n,t)}fo(e,t){let r=Number(this.ro.exec(e)[1]);return oJ.$s(r,t)}_o(e){return oX.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);th(oQ,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Js.insert(e,t):this.Js.remove(e),n=this.uo(this.Js),i=this.uo(r),s=[],a=[];return i.forEach(e=>{n.has(e)||s.push(e)}),n.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.Co(s,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=i1;return e.forEach((e,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class o1{constructor(){this.vo=new oZ,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new oZ,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class o2{Mo(e){}shutdown(){}}let o3="ConnectivityMonitor";class o8{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){for(let e of(th(o3,"Network connectivity changed: AVAILABLE"),this.Lo))e(0)}Bo(){for(let e of(th(o3,"Network connectivity changed: UNAVAILABLE"),this.Lo))e(1)}static v(){return"u">typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let o6=null;function o4(){return null===o6?o6=0x10000000+Math.round(0x80000000*Math.random()):o6++,"0x"+o6.toString(16)}let o5="RestConnection",o7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class o9{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${n}`,this.$o=this.databaseId.database===nP?`project_id=${r}`:`project_id=${r}&database_id=${n}`}Wo(e,t,r,n,i){let s=o4(),a=this.Qo(e,t.toUriEncodedString());th(o5,`Sending RPC '${e}' ${s}:`,a,r);let o={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(o,n,i);let{host:u}=new URL(a),l=V(u);return this.zo(e,a,o,r,l).then(t=>(th(o5,`Received RPC '${e}' ${s}: `,t),t),t=>{throw td(o5,`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",r),t})}jo(e,t,r,n,i,s){return this.Wo(e,t,r,n,i)}Go(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+to,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}Qo(e,t){let r=o7[e],n=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(n=`${n}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),n}terminate(){}}class ue{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}let ut="WebChannelConnection",ur=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};class un extends o9{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){un.c_||(ur(y(),m.STAT_EVENT,e=>{e.stat===g.PROXY?th(ut,"STAT_EVENT: detected buffering proxy"):e.stat===g.NOPROXY&&th(ut,"STAT_EVENT: detected no buffering proxy")}),un.c_=!0)}zo(e,t,r,n,i){let s=o4();return new Promise((i,a)=>{let o=new c;o.setWithCredentials(!0),o.listenOnce(f.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case p.NO_ERROR:let t=o.getResponseJson();th(ut,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case p.TIMEOUT:th(ut,`RPC '${e}' ${s} timed out`),a(new tw(ty.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:let r=o.getStatus();if(th(ut,`RPC '${e}' ${s} failed with status:`,r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;if(t&&t.status&&t.message){let e,r=(e=t.status.toLowerCase().replace(/_/g,"-"),Object.values(ty).indexOf(e)>=0?e:ty.UNKNOWN);a(new tw(r,t.message))}else a(new tw(ty.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new tw(ty.UNAVAILABLE,"Connection failed."));break;default:tp(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{th(ut,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(n);th(ut,`RPC '${e}' ${s} sending request:`,n),o.send(t,"POST",u,r,15)})}T_(e,t,r){let n=o4(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},o=this.longPollingOptions.timeoutSeconds;void 0!==o&&(a.longPollingTimeout=Math.round(1e3*o)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;let u=i.join("");th(ut,`Creating RPC '${e}' stream ${n}: ${u}`,a);let l=s.createWebChannel(u,a);this.I_(l);let h=!1,c=!1,f=new ue({Ho:t=>{c?th(ut,`Not sending because RPC '${e}' stream ${n} is closed:`,t):(h||(th(ut,`Opening RPC '${e}' stream ${n} transport.`),l.open(),h=!0),th(ut,`RPC '${e}' stream ${n} sending:`,t),l.send(t))},Jo:()=>l.close()});return ur(l,d.EventType.OPEN,()=>{c||(th(ut,`RPC '${e}' stream ${n} transport opened.`),f.i_())}),ur(l,d.EventType.CLOSE,()=>{c||(c=!0,th(ut,`RPC '${e}' stream ${n} transport closed`),f.o_(),this.E_(l))}),ur(l,d.EventType.ERROR,t=>{c||(c=!0,td(ut,`RPC '${e}' stream ${n} transport errored. Name:`,t.name,"Message:",t.message),f.o_(new tw(ty.UNAVAILABLE,"The operation could not be completed")))}),ur(l,d.EventType.MESSAGE,t=>{if(!c){let r=t.data[0];tm(!!r,16349);let i=r?.error||r[0]?.error;if(i){th(ut,`RPC '${e}' stream ${n} received error:`,i);let t=i.status,r=function(e){let t=v[e];if(void 0!==t)return sS(t)}(t),s=i.message;void 0===r&&(r=ty.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),c=!0,f.o_(new tw(r,s)),l.close()}else th(ut,`RPC '${e}' stream ${n} received:`,r),f.__(r)}}),un.u_(),setTimeout(()=>{f.s_()},0),f}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return w()}}function ui(){return"u">typeof window?window:null}function us(){return"u">typeof document?document:null}function ua(e){return new sK(e,!0)}un.c_=!1;class uo{constructor(e,t,r=1e3,n=1.5,i=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=n,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),n=Math.max(0,t-r);n>0&&th("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,n,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}let uu="PersistentStream";class ul{constructor(e,t,r,n,i,s,a,o){this.Ci=e,this.b_=r,this.S_=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new uo(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===ty.RESOURCE_EXHAUSTED?(tc(t.toString()),tc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ty.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.D_===t&&this.G_(e,r)},t=>{e(()=>{let e=new tw(ty.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(e=>{r(()=>this.z_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.F_?this.H_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return th(uu,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(th(uu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class uh extends ul{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=function(e,t){let r;if("targetChange"in t){var n,i;t.targetChange;let s="NO_CHANGE"===(n=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===n?1:"REMOVE"===n?2:"CURRENT"===n?3:"RESET"===n?4:tp(39313,{state:n}),a=t.targetChange.targetIds||[],o=(i=t.targetChange.resumeToken,e.useProto3Json?(tm(void 0===i||"string"==typeof i,58123),nI.fromBase64String(i||"")):(tm(void 0===i||i instanceof tt.Buffer||i instanceof Uint8Array,16193),nI.fromUint8Array(i||new Uint8Array))),u=t.targetChange.cause;r=new sF(s,a,o,u&&new tw(void 0===u.code?ty.UNKNOWN:sS(u.code),u.message||"")||null)}else if("documentChange"in t){t.documentChange;let n=t.documentChange;n.document,n.document.name,n.document.updateTime;let i=s0(e,n.document.name),s=sW(n.document.updateTime),a=n.document.createTime?sW(n.document.createTime):tW.min(),o=new n9({mapValue:{fields:n.document.fields}}),u=ie.newFoundDocument(i,s,a,o);r=new sM(n.targetIds||[],n.removedTargetIds||[],u.key,u)}else if("documentDelete"in t){t.documentDelete;let n=t.documentDelete;n.document;let i=s0(e,n.document),s=n.readTime?sW(n.readTime):tW.min(),a=ie.newNoDocument(i,s);r=new sM([],n.removedTargetIds||[],a.key,a)}else if("documentRemove"in t){t.documentRemove;let n=t.documentRemove;n.document;let i=s0(e,n.document);r=new sM([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return tp(11601,{Vt:t});{t.filter;let e=t.filter;e.targetId;let{count:n=0,unchangedNames:i}=e,s=new sI(n,i);r=new sP(e.targetId,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return tW.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?tW.min():t.readTime?sW(t.readTime):tW.min()}(e);return this.listener.J_(t,r)}Z_(e){let t,r={};r.database=s3(this.serializer),r.addTarget=function(e,t){let r,n=t.target;if((r=iC(n)?{documents:s9(e,n)}:{query:ae(e,n).ft}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=sQ(e,t.resumeToken);let n=sG(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(tW.min())>0){r.readTime=sH(e,t.snapshotVersion.toTimestamp());let n=sG(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);let n=(this.serializer,null==(t=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tp(28987,{purpose:e})}}(e.purpose))?null:{"goog-listen-tags":t});n&&(r.labels=n),this.K_(r)}X_(e){let t={};t.database=s3(this.serializer),t.removeTarget=e,this.K_(t)}}class uc extends ul{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return tm(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tm(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){var t,r;tm(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let n=(t=e.writeResults,r=e.commitTime,t&&t.length>0?(tm(void 0!==r,14353),t.map(e=>{let t;return(t=e.updateTime?sW(e.updateTime):sW(r)).isEqual(tW.min())&&(t=sW(r)),new ss(t,e.transformResults||[])})):[]),i=sW(e.commitTime);return this.listener.na(i,n)}ra(){let e={};e.database=s3(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>s5(this.serializer,e))};this.K_(t)}}class ud{}class uf extends ud{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.ia=!1}sa(){if(this.ia)throw new tw(ty.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Wo(e,sY(t,r),n,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===ty.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new tw(ty.UNKNOWN,e.toString())})}jo(e,t,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,sY(t,r),n,s,a,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===ty.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new tw(ty.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class up{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(tc(t),this.aa=!1):th("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}let ug="RemoteStore";class um{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(e=>{r.enqueueAndForget(async()=>{uS(this)&&(th(ug,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await uw(e),e.Va.set("Unknown"),e.Ea.delete(4),await uy(e)}(this))})}),this.Va=new up(r,n)}}async function uy(e){if(uS(e))for(let t of e.Ra)await t(!0)}async function uw(e){for(let t of e.Ra)await t(!1)}function uv(e,t){e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),uT(e)?uI(e):uq(e).O_()&&u_(e,t))}function ub(e,t){let r=uq(e);e.Ia.delete(t),r.O_()&&uE(e,t),0===e.Ia.size&&(r.O_()?r.L_():uS(e)&&e.Va.set("Unknown"))}function u_(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(tW.min())>0){let r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}uq(e).Z_(t)}function uE(e,t){e.da.$e(t),uq(e).X_(t)}function uI(e){e.da=new sU({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),uq(e).start(),e.Va.ua()}function uT(e){return uS(e)&&!uq(e).x_()&&e.Ia.size>0}function uS(e){return 0===e.Ea.size}async function ux(e){e.Va.set("Online")}async function uC(e){e.Ia.forEach((t,r)=>{u_(e,t)})}async function uA(e,t){e.da=void 0,uT(e)?(e.Va.ha(t),uI(e)):e.Va.set("Unknown")}async function uD(e,t,r){if(e.Va.set("Online"),t instanceof sF&&2===t.state&&t.cause)try{await async function(e,t){let r=t.cause;for(let n of t.targetIds)e.Ia.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.Ia.delete(n),e.da.removeTarget(n))}(e,t)}catch(r){th(ug,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await uk(e,r)}else if(t instanceof sM?e.da.Xe(t):t instanceof sP?e.da.st(t):e.da.tt(t),!r.isEqual(tW.min()))try{let t,n=await oR(e.localStore);r.compareTo(n)>=0&&await ((t=e.da.Tt(r)).targetChanges.forEach((t,n)=>{if(t.resumeToken.approximateByteSize()>0){let i=e.Ia.get(n);i&&e.Ia.set(n,i.withResumeToken(t.resumeToken,r))}}),t.targetMismatches.forEach((t,r)=>{let n=e.Ia.get(t);if(!n)return;e.Ia.set(t,n.withResumeToken(nI.EMPTY_BYTE_STRING,n.snapshotVersion)),uE(e,t);let i=new aa(n.target,t,r,n.sequenceNumber);u_(e,i)}),e.remoteSyncer.applyRemoteEvent(t))}catch(t){th(ug,"Failed to raise snapshot:",t),await uk(e,t)}}async function uk(e,t,r){if(!ra(t))throw t;e.Ea.add(1),await uw(e),e.Va.set("Offline"),r||(r=()=>oR(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{th(ug,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await uy(e)})}function uN(e,t){return t().catch(r=>uk(e,r,t))}async function uR(e){var t;let r=uj(e),n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;uS(t=e)&&t.Ta.length<10;)try{let t=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}(e.localStore,n);if(null===t){0===e.Ta.length&&r.L_();break}n=t.batchId,function(e,t){e.Ta.push(t);let r=uj(e);r.O_()&&r.Y_&&r.ea(t.mutations)}(e,t)}catch(t){await uk(e,t)}uO(e)&&uL(e)}function uO(e){return uS(e)&&!uj(e).x_()&&e.Ta.length>0}function uL(e){uj(e).start()}async function uM(e){uj(e).ra()}async function uP(e){let t=uj(e);for(let r of e.Ta)t.ea(r.mutations)}async function uF(e,t,r){let n=e.Ta.shift(),i=sb.from(n,t,r);await uN(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await uR(e)}async function uV(e,t){t&&uj(e).Y_&&await async function(e,t){var r;if(sT(r=t.code)&&r!==ty.ABORTED){let r=e.Ta.shift();uj(e).B_(),await uN(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await uR(e)}}(e,t),uO(e)&&uL(e)}async function uU(e,t){e.asyncQueue.verifyOperationInProgress(),th(ug,"RemoteStore received new credentials");let r=uS(e);e.Ea.add(3),await uw(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await uy(e)}async function uB(e,t){t?(e.Ea.delete(2),await uy(e)):t||(e.Ea.add(2),await uw(e),e.Va.set("Unknown"))}function uq(e){var t,r,n;return e.ma||(t=e.datastore,r=e.asyncQueue,n={Zo:ux.bind(null,e),Yo:uC.bind(null,e),t_:uA.bind(null,e),J_:uD.bind(null,e)},t.sa(),e.ma=new uh(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.ma.B_(),uT(e)?uI(e):e.Va.set("Unknown")):(await e.ma.stop(),e.da=void 0)})),e.ma}function uj(e){var t,r,n;return e.fa||(t=e.datastore,r=e.asyncQueue,n={Zo:()=>Promise.resolve(),Yo:uM.bind(null,e),t_:uV.bind(null,e),ta:uP.bind(null,e),na:uF.bind(null,e)},t.sa(),e.fa=new uc(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.fa.B_(),await uR(e)):(await e.fa.stop(),e.Ta.length>0&&(th(ug,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class uz{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new tv,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){let s=new uz(e,t,Date.now()+r,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new tw(ty.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function u$(e,t){if(tc("AsyncQueue",`${t}: ${e}`),ra(e))return new tw(ty.UNAVAILABLE,`${t}: ${e}`);throw e}class uK{static emptySet(e){return new uK(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||tV.comparator(t.key,r.key):(e,t)=>tV.comparator(e.key,t.key),this.keyedMap=iW(),this.sortedSet=new ng(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof uK)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let r=new uK;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class uG{constructor(){this.ga=new ng(tV.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?0!==e.type&&3===r.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==r.type?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.ga=this.ga.remove(t):1===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):tp(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class uH{constructor(e,t,r,n,i,s,a,o,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new uH(e,t,uK.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&iB(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class uQ{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class uW{constructor(){this.queries=uJ(),this.onlineState="Unknown",this.Ca=new Set}terminate(){var e;let t;e=new tw(ty.ABORTED,"Firestore shutting down"),t=this.queries,this.queries=uJ(),t.forEach((t,r)=>{for(let t of r.ba)t.onError(e)})}}function uJ(){return new iG(e=>iq(e),iB)}async function uY(e,t){let r=3,n=t.query,i=e.queries.get(n);i?!i.Sa()&&t.Da()&&(r=2):(i=new uQ,r=+!t.Da());try{switch(r){case 0:i.wa=await e.onListen(n,!0);break;case 1:i.wa=await e.onListen(n,!1);break;case 2:await e.onFirstRemoteStoreListen(n)}}catch(r){let e=u$(r,`Initialization of query '${ij(t.query)}' failed`);return void t.onError(e)}e.queries.set(n,i),i.ba.push(t),t.va(e.onlineState),i.wa&&t.Fa(i.wa)&&u1(e)}async function uX(e,t){let r=t.query,n=3,i=e.queries.get(r);if(i){let e=i.ba.indexOf(t);e>=0&&(i.ba.splice(e,1),0===i.ba.length?n=+!t.Da():!i.Sa()&&t.Da()&&(n=2))}switch(n){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function uZ(e,t){let r=!1;for(let n of t){let t=n.query,i=e.queries.get(t);if(i){for(let e of i.ba)e.Fa(n)&&(r=!0);i.wa=n}}r&&u1(e)}function u0(e,t,r){let n=e.queries.get(t);if(n)for(let e of n.ba)e.onError(r);e.queries.delete(t)}function u1(e){e.Ca.forEach(e=>{e.next()})}(E=_||(_={})).Ma="default",E.Cache="cache";class u2{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let r of e.docChanges)3!==r.type&&t.push(r);e=new uH(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){return!(e.fromCache&&this.Da())||(!this.options.Ka||"Offline"===t)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=uH.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_.Cache}}class u3{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class u8{constructor(e){this.serializer=e}Ks(e){return s0(this.serializer,e)}qs(e){return e.metadata.exists?s4(this.serializer,e.document,!1):ie.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return sW(e)}}class u6{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=u4(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=tM.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){let t=new Map,r=new u8(this.serializer);for(let n of e)if(n.metadata.queries){let e=r.Ks(n.metadata.name);for(let r of n.metadata.queries){let n=(t.get(r)||i0()).add(e);t.set(r,n)}}return t}async ja(e){let t=await oB(e,new u8(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(let t of this.Wa)await oq(e,t,r.get(t.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function u4(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class u5{constructor(e){this.key=e}}class u7{constructor(e){this.key=e}}class u9{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=i0(),this.mutatedKeys=i0(),this.eu=iK(e),this.tu=new uK(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new uG,n=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,s=n,a=!1,o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,u="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{let l=n.get(e),h=iz(this.query,t)?t:null,c=!!l&&this.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations),f=!1;l&&h?l.data.isEqual(h.data)?c!==d&&(r.track({type:3,doc:h}),f=!0):this.su(l,h)||(r.track({type:2,doc:h}),f=!0,(o&&this.eu(h,o)>0||u&&0>this.eu(h,u))&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),f=!0):l&&!h&&(r.track({type:1,doc:l}),f=!0,(o||u)&&(a=!0)),f&&(h?(s=s.add(h),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{tu:s,iu:r,Ss:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((e,t)=>{var r,n;let i;return r=e.type,n=t.type,(i=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tp(20277,{Vt:e})}})(r)-i(n)||this.eu(e.doc,t.doc)}),this.ou(r),n=n??!1;let a=t&&!n?this._u():[],o=0===this.Ya.size&&this.current&&!n?1:0,u=o!==this.Xa;return(this.Xa=o,0!==s.length||u)?{snapshot:new uH(this.query,e.tu,i,s,e.mutatedKeys,0===o,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new uG,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Za=this.Za.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Za=this.Za.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=i0(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Ya=this.Ya.add(e.key))});let t=[];return e.forEach(e=>{this.Ya.has(e)||t.push(new u7(e))}),this.Ya.forEach(r=>{e.has(r)||t.push(new u5(r))}),t}cu(e){this.Za=e.ks,this.Ya=i0();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return uH.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Xa,this.hasCachedResults)}}let le="SyncEngine";class lt{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class lr{constructor(e){this.key=e,this.hu=!1}}class ln{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new iG(e=>iq(e),iB),this.Iu=new Map,this.Eu=new Set,this.Ru=new ng(tV.comparator),this.Au=new Map,this.Vu=new oh,this.du={},this.mu=new Map,this.fu=aZ.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function li(e,t,r=!0){let n,i=lL(e),s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.lu()):n=await la(i,t,r,!0),n}async function ls(e,t){let r=lL(e);await la(r,t,!0,!1)}async function la(e,t,r,n){let i,s=await oL(e.localStore,iP(t)),a=s.targetId,o=e.sharedClientState.addLocalQueryTarget(a,r);return n&&(i=await lo(e,t,a,"current"===o,s.resumeToken)),e.isPrimaryClient&&r&&uv(e.remoteStore,s),i}async function lo(e,t,r,n,i){e.pu=(t,r,n)=>(async function(e,t,r,n){let i=t.view.ru(r);i.Ss&&(i=await oP(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,i)));let s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return lb(e,t.targetId,o.au),o.snapshot})(e,t,r,n);let s=await oP(e.localStore,t,!0),a=new u9(t,s.ks),o=a.ru(s.documents),u=sL.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),l=a.applyChanges(o,e.isPrimaryClient,u);lb(e,r,l.au);let h=new lt(t,r,a);return e.Tu.set(t,h),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),l.snapshot}async function lu(e,t,r){let n=e.Tu.get(t),i=e.Iu.get(n.targetId);i.length>1?(e.Iu.set(n.targetId,i.filter(e=>!iB(e,t))),e.Tu.delete(t)):e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await oM(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),r&&ub(e.remoteStore,n.targetId),lw(e,n.targetId)}).catch(t7)):(lw(e,n.targetId),await oM(e.localStore,n.targetId,!0))}async function ll(e,t){let r=e.Tu.get(t),n=e.Iu.get(r.targetId);e.isPrimaryClient&&1===n.length&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),ub(e.remoteStore,r.targetId))}async function lh(e,t,r){let n=lM(e);try{var i,s;let e,a,o,u,l,h=await (i=n.localStore,o=tQ.now(),u=t.reduce((e,t)=>e.add(t.key),i0()),i.persistence.runTransaction("Locally write mutations","readwrite",r=>{let n=iH,s=i0();return i.xs.getEntries(r,u).next(e=>{(n=e).forEach((e,t)=>{t.isValidDocument()||(s=s.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(r,n)).next(n=>{e=n;let s=[];for(let r of t){let t=function(e,t){let r=null;for(let n of e.fieldTransforms){let e=t.data.field(n.field),i=i6(n.transform,e||null);null!=i&&(null===r&&(r=n9.empty()),r.set(n.field,i))}return r||null}(r,e.get(r.key).overlayedDocument);null!=t&&s.push(new sf(r.key,t,function e(t){let r=[];return nf(t.fields,(t,n)=>{let i=new tF([t]);if(n2(n)){let t=e(n.mapValue).fields;if(0===t.length)r.push(i);else for(let e of t)r.push(i.child(e))}else r.push(i)}),new n_(r)}(t.value.mapValue),sa.exists(!0)))}return i.mutationQueue.addMutationBatch(r,o,s,t)}).next(t=>{a=t;let n=t.applyToLocalDocumentSet(e,s);return i.documentOverlayCache.saveOverlays(r,t.batchId,n)})}).then(()=>({batchId:a.batchId,changes:iJ(e)})));n.sharedClientState.addPendingMutation(h.batchId),s=h.batchId,(l=n.du[n.currentUser.toKey()])||(l=new ng(tD)),l=l.insert(s,r),n.du[n.currentUser.toKey()]=l,await lE(n,h.changes),await uR(n.remoteStore)}catch(t){let e=u$(t,"Failed to persist write");r.reject(e)}}async function lc(e,t){var r;try{let n,i,s=await (r=e.localStore,n=t.snapshotVersion,i=r.vs,r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=r.xs.newChangeBuffer({trackRemovals:!0});i=r.vs;let a=[];t.targetChanges.forEach((s,o)=>{var u;let l=i.get(o);if(!l)return;a.push(r.li.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.li.addMatchingKeys(e,s.addedDocuments,o)));let h=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?h=h.withResumeToken(nI.EMPTY_BYTE_STRING,tW.min()).withLastLimboFreeSnapshotVersion(tW.min()):s.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(s.resumeToken,n)),i=i.insert(o,h),u=h,(0===l.resumeToken.approximateByteSize()||u.snapshotVersion.toMicroseconds()-l.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&a.push(r.li.updateTargetData(e,h))});let o=iH,u=i0();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),a.push(oO(e,s,t.documentUpdates).next(e=>{o=e.Bs,u=e.Ls})),!n.isEqual(tW.min())){let t=r.li.getLastRemoteSnapshotVersion(e).next(t=>r.li.setTargetsMetadata(e,e.currentSequenceNumber,n));a.push(t)}return t9.waitFor(a).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,u)).next(()=>o)}).then(e=>(r.vs=i,e)));t.targetChanges.forEach((t,r)=>{let n=e.Au.get(r);n&&(tm(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?n.hu=!0:t.modifiedDocuments.size>0?tm(n.hu,14607):t.removedDocuments.size>0&&(tm(n.hu,42227),n.hu=!1))}),await lE(e,s,t)}catch(e){await t7(e)}}function ld(e,t,r){var n;if(e.isPrimaryClient&&0===r||!e.isPrimaryClient&&1===r){let r,i=[];e.Tu.forEach((e,r)=>{let n=r.view.va(t);n.snapshot&&i.push(n.snapshot)}),(n=e.eventManager).onlineState=t,r=!1,n.queries.forEach((e,n)=>{for(let e of n.ba)e.va(t)&&(r=!0)}),r&&u1(n),i.length&&e.Pu.J_(i),e.onlineState=t,e.isPrimaryClient&&e.sharedClientState.setOnlineState(t)}}async function lf(e,t,r){e.sharedClientState.updateQueryState(t,"rejected",r);let n=e.Au.get(t),i=n&&n.key;if(i){let r=new ng(tV.comparator);r=r.insert(i,ie.newNoDocument(i,tW.min()));let n=i0().add(i),s=new sO(tW.min(),new Map,new ng(tD),r,n);await lc(e,s),e.Ru=e.Ru.remove(i),e.Au.delete(t),l_(e)}else await oM(e.localStore,t,!1).then(()=>lw(e,t,r)).catch(t7)}async function lp(e,t){var r;let n=t.batch.batchId;try{let i=await (r=e.localStore,r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let n,i,s,a=t.batch.keys(),o=r.xs.newChangeBuffer({trackRemovals:!0});return(i=(n=t.batch).keys(),s=t9.resolve(),i.forEach(r=>{s=s.next(()=>o.getEntry(e,r)).next(e=>{let i=t.docVersions.get(r);tm(null!==i,48541),0>e.version.compareTo(i)&&(n.applyToRemoteDocument(e,t),e.isValidDocument()&&(e.setReadTime(t.commitVersion),o.addEntry(e)))})}),s.next(()=>r.mutationQueue.removeMutationBatch(e,n))).next(()=>o.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=i0();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,a))}));ly(e,n,null),lm(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await lE(e,i)}catch(e){await t7(e)}}async function lg(e,t,r){var n;try{let i=await (n=e.localStore,n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(tm(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))}));ly(e,t,r),lm(e,t),e.sharedClientState.updateMutationState(t,"rejected",r),await lE(e,i)}catch(e){await t7(e)}}function lm(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function ly(e,t,r){let n=e.du[e.currentUser.toKey()];if(n){let i=n.get(t);i&&(r?i.reject(r):i.resolve(),n=n.remove(t)),e.du[e.currentUser.toKey()]=n}}function lw(e,t,r=null){for(let n of(e.sharedClientState.removeLocalQueryTarget(t),e.Iu.get(t)))e.Tu.delete(n),r&&e.Pu.yu(n,r);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach(t=>{e.Vu.containsKey(t)||lv(e,t)})}function lv(e,t){e.Eu.delete(t.path.canonicalString());let r=e.Ru.get(t);null!==r&&(ub(e.remoteStore,r),e.Ru=e.Ru.remove(t),e.Au.delete(r),l_(e))}function lb(e,t,r){for(let n of r)n instanceof u5?(e.Vu.addReference(n.key,t),function(e,t){let r=t.key,n=r.path.canonicalString();e.Ru.get(r)||e.Eu.has(n)||(th(le,"New document in limbo: "+r),e.Eu.add(n),l_(e))}(e,n)):n instanceof u7?(th(le,"Document no longer in limbo: "+n.key),e.Vu.removeReference(n.key,t),e.Vu.containsKey(n.key)||lv(e,n.key)):tp(19791,{wu:n})}function l_(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let r=new tV(tM.fromString(t)),n=e.fu.next();e.Au.set(n,new lr(r)),e.Ru=e.Ru.insert(r,n),uv(e.remoteStore,new aa(iP(iR(r.path)),n,"TargetPurposeLimboResolution",rp.ce))}}async function lE(e,t,r){let n=[],i=[],s=[];e.Tu.isEmpty()||(e.Tu.forEach((a,o)=>{s.push(e.pu(o,t,r).then(t=>{if((t||r)&&e.isPrimaryClient){let n=t?!t.fromCache:r?.targetChanges.get(o.targetId)?.current;e.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(t){n.push(t);let e=ox.Es(o.targetId,t);i.push(e)}}))}),await Promise.all(s),e.Pu.J_(n),await async function(e,t){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>t9.forEach(t,t=>t9.forEach(t.Ts,n=>e.persistence.referenceDelegate.addReference(r,t.targetId,n)).next(()=>t9.forEach(t.Is,n=>e.persistence.referenceDelegate.removeReference(r,t.targetId,n)))))}catch(e){if(!ra(e))throw e;th(oD,"Failed to update sequence numbers: "+e)}for(let r of t){let t=r.targetId;if(!r.fromCache){let r=e.vs.get(t),n=r.snapshotVersion,i=r.withLastLimboFreeSnapshotVersion(n);e.vs=e.vs.insert(t,i)}}}(e.localStore,i))}async function lI(e,t){if(!e.currentUser.isEqual(t)){th(le,"User change. New user:",t.toKey());let r=await oN(e.localStore,t);e.currentUser=t,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new tw(ty.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await lE(e,r.Ns)}}function lT(e,t){let r=e.Au.get(t);if(r&&r.hu)return i0().add(r.key);{let r=i0(),n=e.Iu.get(t);if(!n)return r;for(let t of n){let n=e.Tu.get(t);r=r.unionWith(n.view.nu)}return r}}async function lS(e,t){let r=await oP(e.localStore,t.query,!0),n=t.view.cu(r);return e.isPrimaryClient&&lb(e,t.targetId,n.au),n}async function lx(e,t){return oV(e.localStore,t).then(t=>lE(e,t))}async function lC(e,t,r,n){var i,s;let a,o=await (i=e.localStore,a=i.mutationQueue,i.persistence.runTransaction("Lookup mutation documents","readonly",e=>a.Xn(e,t).next(t=>t?i.localDocuments.getDocuments(e,t):t9.resolve(null))));null!==o?("pending"===r?await uR(e.remoteStore):"acknowledged"===r||"rejected"===r?(ly(e,t,n||null),lm(e,t),s=e.localStore,s.mutationQueue.nr(t)):tp(6720,"Unknown batchState",{bu:r}),await lE(e,o)):th(le,"Cannot apply mutation batch with id: "+t)}async function lA(e,t){if(lL(e),lM(e),!0===t&&!0!==e.gu){let t=e.sharedClientState.getAllActiveQueryTargets(),r=await lD(e,t.toArray());for(let t of(e.gu=!0,await uB(e.remoteStore,!0),r))uv(e.remoteStore,t)}else if(!1===t&&!1!==e.gu){let t=[],r=Promise.resolve();e.Iu.forEach((n,i)=>{e.sharedClientState.isLocalQueryTarget(i)?t.push(i):r=r.then(()=>(lw(e,i),oM(e.localStore,i,!0))),ub(e.remoteStore,i)}),await r,await lD(e,t),e.Au.forEach((t,r)=>{ub(e.remoteStore,r)}),e.Vu.zr(),e.Au=new Map,e.Ru=new ng(tV.comparator),e.gu=!1,await uB(e.remoteStore,!1)}}async function lD(e,t,r){let n=[],i=[];for(let r of t){let t,s=e.Iu.get(r);if(s&&0!==s.length)for(let r of(t=await oL(e.localStore,iP(s[0])),s)){let t=e.Tu.get(r),n=await lS(e,t);n.snapshot&&i.push(n.snapshot)}else{let n=await oF(e.localStore,r);t=await oL(e.localStore,n),await lo(e,lk(n),r,!1,t.resumeToken)}n.push(t)}return e.Pu.J_(i),n}function lk(e){var t,r,n,i,s;return t=e.path,r=e.collectionGroup,n=e.orderBy,i=e.filters,s=e.limit,new iN(t,r,n,i,s,"F",e.startAt,e.endAt)}function lN(e){return e.localStore.persistence.hs()}async function lR(e,t,r,n){if(e.gu)return void th(le,"Ignoring unexpected query state notification.");let i=e.Iu.get(t);if(i&&i.length>0)switch(r){case"current":case"not-current":{let n=await oV(e.localStore,i$(i[0])),s=sO.createSynthesizedRemoteEventForCurrentChange(t,"current"===r,nI.EMPTY_BYTE_STRING);await lE(e,n,s);break}case"rejected":await oM(e.localStore,t,!0),lw(e,t,n);break;default:tp(64155,r)}}async function lO(e,t,r){let n=lL(e);if(n.gu){for(let e of t){if(n.Iu.has(e)&&n.sharedClientState.isActiveQueryTarget(e)){th(le,"Adding an already active target "+e);continue}let t=await oF(n.localStore,e),r=await oL(n.localStore,t);await lo(n,lk(t),r.targetId,!1,r.resumeToken),uv(n.remoteStore,r)}for(let e of r)n.Iu.has(e)&&await oM(n.localStore,e,!1).then(()=>{ub(n.remoteStore,e),lw(n,e)}).catch(t7)}}function lL(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=lc.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lf.bind(null,e),e.Pu.J_=uZ.bind(null,e.eventManager),e.Pu.yu=u0.bind(null,e.eventManager),e}function lM(e){return e.remoteStore.remoteSyncer.applySuccessfulWrite=lp.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lg.bind(null,e),e}class lP{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ua(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){var t,r;return t=this.persistence,r=new oA,new ok(t,r,e.initialUser,this.serializer)}Cu(e){return new om(ow.Vi,this.serializer)}Du(e){return new o1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}lP.provider={build:()=>new lP};class lF extends lP{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){return tm(this.persistence.referenceDelegate instanceof ov,46915),new a6(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Cu(e){let t=void 0!==this.cacheSizeBytes?aH.withCacheSize(this.cacheSizeBytes):aH.DEFAULT;return new om(e=>ov.Vi(e,t),this.serializer)}}class lV extends lP{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await lM(this.xu.syncEngine),await uR(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){var t,r;return t=this.persistence,r=new oA,new ok(t,r,e.initialUser,this.serializer)}Fu(e,t){return new a6(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Mu(e,t){let r=new rf(t,this.persistence);return new rd(e.asyncQueue,r)}Cu(e){let t=oS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?aH.withCacheSize(this.cacheSizeBytes):aH.DEFAULT;return new oT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,ui(),us(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new o1}}class lU extends lV{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.xu.syncEngine;this.sharedClientState instanceof o0&&(this.sharedClientState.syncEngine={So:lC.bind(null,t),Do:lR.bind(null,t),Co:lO.bind(null,t),hs:lN.bind(null,t),bo:lx.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi(async e=>{await lA(this.xu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Du(e){let t=ui();if(!o0.v(t))throw new tw(ty.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=oS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new o0(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class lB{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ld(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=lI.bind(null,this.syncEngine),await uB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new uW}createDatastore(e){var t;let r=ua(e.databaseInfo.databaseId),n=new un(e.databaseInfo);return t=e.authCredentials,new uf(t,e.appCheckCredentials,n,r)}createRemoteStore(e){var t,r;return t=this.localStore,r=this.datastore,new um(t,r,e.asyncQueue,e=>ld(this.syncEngine,e,0),o8.v()?new o8:new o2)}createSyncEngine(e,t){var r,n,i,s,a,o;let u;return r=this.localStore,n=this.remoteStore,i=this.eventManager,s=this.sharedClientState,a=e.initialUser,o=e.maxConcurrentLimboResolutions,u=new ln(r,n,i,s,a,o),t&&(u.gu=!0),u}async terminate(){await async function(e){th(ug,"RemoteStore shutting down."),e.Ea.add(5),await uw(e),e.Aa.shutdown(),e.Va.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}function lq(e,t=10240){let r=0;return{async read(){if(r<e.byteLength){let n={value:e.slice(r,r+t),done:!1};return r+=t,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}lB.provider={build:()=>new lB};class lj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):tc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class lz{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new tv,this.buffer=new Uint8Array,this.Lu=new TextDecoder("utf-8"),this.ku().then(e=>{e&&e.Ua()?this.metadata.resolve(e.qa.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(e?.qa)}`))},e=>this.metadata.reject(e))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){let e=await this.Ku();if(null===e)return null;let t=this.Lu.decode(e),r=Number(t);return isNaN(r)&&this.qu(`length string (${t}) is not valid number`),new u3(JSON.parse(await this.Uu(r)),e.length+r)}$u(){return this.buffer.findIndex(e=>123===e)}async Ku(){for(;0>this.$u()&&!await this.Wu(););if(0===this.buffer.length)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");let t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),Error(`Invalid bundle format: ${e}`)}async Wu(){let e=await this.Bu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class l${constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Ua())throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do null!==(r=this.Su())&&this.elements.push(r);while(null!==r)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.Ku();return new u3(JSON.parse(this.Uu(e)),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new tw(ty.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw Error("Reached the end of bundle when more is expected.")}}class lK{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new tw(ty.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await async function(e,t){let r={documents:t.map(t=>sZ(e.serializer,t))},n=await e.jo("BatchGetDocuments",e.serializer.databaseId,tM.emptyPath(),r,t.length),i=new Map;n.forEach(t=>{var r;let n,s,a,o,u,l,h=(r=e.serializer,"found"in t?(tm(!!t.found,43571),t.found.name,t.found.updateTime,n=s0(r,t.found.name),s=sW(t.found.updateTime),a=t.found.createTime?sW(t.found.createTime):tW.min(),o=new n9({mapValue:{fields:t.found.fields}}),ie.newFoundDocument(n,s,a,o)):"missing"in t?(tm(!!t.missing,3894),tm(!!t.readTime,22933),u=s0(r,t.missing),l=sW(t.readTime),ie.newNoDocument(u,l)):tp(7234,{result:t}));i.set(h.key.toString(),h)});let s=[];return t.forEach(e=>{let t=i.get(e.toString());tm(!!t,55234,{key:e}),s.push(t)}),s}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new sy(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let r=tV.fromPath(t);this.mutations.push(new sw(r,this.precondition(r)))}),await async function(e,t){let r={writes:t.map(t=>s5(e.serializer,t))};await e.Wo("Commit",e.serializer.databaseId,tM.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw tp(50498,{Gu:e.constructor.name});t=tW.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new tw(ty.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(tW.min())?sa.exists(!1):sa.updateTime(t):sa.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(tW.min()))throw new tw(ty.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return sa.updateTime(t)}return sa.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class lG{constructor(e,t,r,n,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=n,this.deferred=i,this.zu=r.maxAttempts,this.M_=new uo(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_(async()=>{let e=new lK(this.datastore),t=this.Ju(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Zu(e)}))}).catch(e=>{this.Zu(e)})})}Ju(e){try{let t=this.updateFunction(e);return!rg(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Hu(),Promise.resolve()))):this.deferred.reject(e)}Xu(e){if("FirebaseError"===e?.name){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!sT(t)}return!1}}let lH="FirestoreClient";class lQ{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=n,this.user=ta.UNAUTHENTICATED,this.clientId=tA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{th(lH,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(th(lH,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new tv;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=u$(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function lW(e,t){e.asyncQueue.verifyOperationInProgress(),th(lH,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await oN(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function lJ(e,t){e.asyncQueue.verifyOperationInProgress();let r=await lY(e);th(lH,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>uU(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>uU(t.remoteStore,r)),e._onlineComponents=t}async function lY(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){th(lH,"Using user provided OfflineComponentProvider");try{await lW(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!("FirebaseError"===t.name?t.code===ty.FAILED_PRECONDITION||t.code===ty.UNIMPLEMENTED:!("u">typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw t;td("Error using user provided cache. Falling back to memory cache: "+t),await lW(e,new lP)}}else th(lH,"Using default OfflineComponentProvider"),await lW(e,new lF(void 0));return e._offlineComponents}async function lX(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(th(lH,"Using user provided OnlineComponentProvider"),await lJ(e,e._uninitializedComponentsProvider._online)):(th(lH,"Using default OnlineComponentProvider"),await lJ(e,new lB))),e._onlineComponents}function lZ(e){return lY(e).then(e=>e.localStore)}function l0(e){return lX(e).then(e=>e.syncEngine)}function l1(e){return lX(e).then(e=>e.datastore)}async function l2(e){let t=await lX(e),r=t.eventManager;return r.onListen=li.bind(null,t.syncEngine),r.onUnlisten=lu.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=ls.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=ll.bind(null,t.syncEngine),r}function l3(e,t,r={}){let n=new tv;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await l2(e),s=e.asyncQueue,a=new lj({next:e=>{a.Nu(),s.enqueueAndForget(()=>uX(i,o));let u=e.docs.has(t);!u&&e.fromCache?n.reject(new tw(ty.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&e.fromCache&&r&&"server"===r.source?n.reject(new tw(ty.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(e)},error:e=>n.reject(e)}),uY(i,o=new u2(iR(t.path),a,{includeMetadataChanges:!0,Ka:!0}))}),n.promise}function l8(e,t,r={}){let n=new tv;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await l2(e),s=e.asyncQueue,o=new u2(t,a=new lj({next:e=>{a.Nu(),s.enqueueAndForget(()=>uX(i,o)),e.fromCache&&"server"===r.source?n.reject(new tw(ty.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(e)},error:e=>n.reject(e)}),{includeMetadataChanges:!0,Ka:!0}),uY(i,o)}),n.promise}function l6(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let l4=new Map,l5="firestore.googleapis.com";class l7{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new tw(ty.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=l5,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new tw(ty.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new tw(ty.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l6(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new tw(ty.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new tw(ty.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new tw(ty.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class l9{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new l7({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tw(ty.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new tw(ty.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new l7(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new t_;switch(e.type){case"firstParty":return new tS(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new tw(ty.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=l4.get(this))&&(th("ComponentProvider","Removing Datastore"),l4.delete(this),e.terminate()),Promise.resolve()}}class he{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new he(this.firestore,e,this._query)}}class ht{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ht(this.firestore,e,this._key)}toJSON(){return{type:ht._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(tH(t,ht._jsonSchema))return new ht(e,r||null,new tV(tM.fromString(t.referencePath)))}}ht._jsonSchemaVersion="firestore/documentReference/1.0",ht._jsonSchema={type:tG("string",ht._jsonSchemaVersion),referencePath:tG("string")};class hr extends he{constructor(e,t,r){super(e,t,iR(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ht(this.firestore,null,new tV(e))}withConverter(e){return new hr(this.firestore,e,this._path)}}function hn(e,t,...r){if(e=et(e),tU("collection","path",t),e instanceof l9){let n=tM.fromString(t,...r);return tq(n),new hr(e,null,n)}{if(!(e instanceof ht||e instanceof hr))throw new tw(ty.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(tM.fromString(t,...r));return tq(n),new hr(e.firestore,null,n)}}function hi(e,t,...r){if(e=et(e),1==arguments.length&&(t=tA.newId()),tU("doc","path",t),e instanceof l9){let n=tM.fromString(t,...r);return tB(n),new ht(e,null,new tV(n))}{if(!(e instanceof ht||e instanceof hr))throw new tw(ty.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(tM.fromString(t,...r));return tB(n),new ht(e.firestore,e instanceof hr?e.converter:null,new tV(n))}}function hs(e,t){return e=et(e),t=et(t),e instanceof he&&t instanceof he&&e.firestore===t.firestore&&iB(e._query,t._query)&&e.converter===t.converter}let ha="AsyncQueue";class ho{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new uo(this,"async_queue_retry"),this._c=()=>{let e=us();e&&th(ha,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=us();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=us();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new tv;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(0!==this.Yu.length){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ra(e))throw e;th(ha,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,tc("INTERNAL UNHANDLED ERROR: ",hu(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let n=uz.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(n),n}uc(){this.nc&&tp(47125,{Pc:hu(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let t of(this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.tc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}}function hu(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class hl{constructor(){this._progressObserver={},this._taskCompletionResolver=new tv,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class hh extends l9{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new ho,this._persistenceKey=n?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ho(e),this._firestoreClient=void 0,await e}}}function hc(e,t){let r=eP("object"==typeof e?e:eW(),"firestore").getImmediate({identifier:"string"==typeof e?e:t||nP});if(!r._initialized){let e=M("firestore");e&&function(e,t,r,n={}){e=t$(e,l9);let i=V(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;i&&(U(`https://${o}`),z("Firestore",!0)),s.host!==l5&&s.host!==o&&td("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u={...s,host:o,ssl:i,emulatorOptions:n};if(!Z(u,a)&&(e._setSettings(u),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=ta.MOCK_USER;else{t=B(n.mockUserToken,e._app?.options.projectId);let i=n.mockUserToken.sub||n.mockUserToken.user_id;if(!i)throw new tw(ty.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new ta(i)}e._authCredentials=new tE(new tb(t,r))}}(r,...e)}return r}function hd(e){if(e._terminated)throw new tw(ty.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,r,n,i,s;let a,o=e._freezeSettings(),u=(t=e._databaseId,r=e._app?.options.appId||"",n=e._persistenceKey,i=e._app?.options.apiKey,new nM(t,r,n,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,l6(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,i));e._componentsProvider||o.localCache?._offlineComponentProvider&&o.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),e._firestoreClient=new lQ(e._authCredentials,e._appCheckCredentials,e._queue,u,e._componentsProvider&&(s=e._componentsProvider,a=s?._online.build(),{_offline:s?._offline.build(a),_online:a}))}(e),e._firestoreClient}function hf(e,t){let r=hd(e=t$(e,hh)),n=new hl;return function(e,t,r,n){var i;let s=(i=ua(t),new lz(function(e,t){if(e instanceof Uint8Array)return lq(e,void 0);if(e instanceof ArrayBuffer)return lq(new Uint8Array(e),void 0);if(e instanceof ReadableStream)return e.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof r?sC().encode(r):r),i));e.asyncQueue.enqueueAndForget(async()=>{var t;(async function(e,t,r){try{var n,i;let s,a=await t.getMetadata();if(await (n=e.localStore,s=sW(a.createTime),n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Pi.getBundleMetadata(e,a.id)).then(e=>!!e&&e.createTime.compareTo(s)>=0)))return await t.close(),r._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}),Promise.resolve(new Set);r._updateProgress(u4(a));let o=new u6(a,t.serializer),u=await t.Su();for(;u;){let e=await o.Ga(u);e&&r._updateProgress(e),u=await t.Su()}let l=await o.ja(e.localStore);return await lE(e,l.Ja,void 0),await (i=e.localStore,i.persistence.runTransaction("Save bundle","readwrite",e=>i.Pi.saveBundleMetadata(e,a))),r._completeWith(l.progress),Promise.resolve(l.Ha)}catch(e){return td(le,`Loading bundle failed with ${e}`),r._failWith(e),Promise.resolve(new Set)}})(t=await l0(e),s,n).then(e=>{t.sharedClientState.notifyBundleLoaded(e)})})}(r,e._databaseId,t,n),n}class hp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hp(nI.fromBase64String(e))}catch(e){throw new tw(ty.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new hp(nI.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:hp._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(tH(e,hp._jsonSchema))return hp.fromBase64String(e.bytes)}}hp._jsonSchemaVersion="firestore/bytes/1.0",hp._jsonSchema={type:tG("string",hp._jsonSchemaVersion),bytes:tG("string")};class hg{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new tw(ty.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tF(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hm{constructor(e){this._methodName=e}}class hy{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new tw(ty.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new tw(ty.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tD(this._lat,e._lat)||tD(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hy._jsonSchemaVersion}}static fromJSON(e){if(tH(e,hy._jsonSchema))return new hy(e.latitude,e.longitude)}}hy._jsonSchemaVersion="firestore/geoPoint/1.0",hy._jsonSchema={type:tG("string",hy._jsonSchemaVersion),latitude:tG("number"),longitude:tG("number")};class hw{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:hw._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(tH(e,hw._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new hw(e.vectorValues);throw new tw(ty.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}hw._jsonSchemaVersion="firestore/vectorValue/1.0",hw._jsonSchema={type:tG("string",hw._jsonSchemaVersion),vectorValues:tG("object")};let hv=/^__.*__$/;class hb{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new sf(e,this.data,this.fieldMask,t,this.fieldTransforms):new sd(e,this.data,t,this.fieldTransforms)}}class h_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new sf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hE(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw tp(40011,{dataSource:e})}}class hI{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new hI({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return hV(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(hE(this.dataSource)&&hv.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class hT{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ua(e)}createContext(e,t,r,n=!1){return new hI({dataSource:e,methodName:t,targetDoc:r,path:tF.emptyPath(),arrayElement:!1,hasConverter:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hS(e){let t=e._freezeSettings(),r=ua(e._databaseId);return new hT(e._databaseId,!!t.ignoreUndefinedProperties,r)}function hx(e,t,r,n,i,s={}){let a,o,u=e.createContext(s.merge||s.mergeFields?2:0,t,r,i);hL("Data must be an object, but it was:",u,n);let l=hR(n,u);if(s.merge)a=new n_(u.fieldMask),o=u.fieldTransforms;else if(s.mergeFields){let e=[];for(let n of s.mergeFields){let i=hM(t,n,r);if(!u.contains(i))throw new tw(ty.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);hU(e,i)||e.push(i)}a=new n_(e),o=u.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=u.fieldTransforms;return new hb(new n9(l),a,o)}class hC extends hm{_toFieldTransform(e){if(2!==e.dataSource)throw 1===e.dataSource?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hC}}function hA(e,t,r,n){let i=e.createContext(1,t,r);hL("Data must be an object, but it was:",i,n);let s=[],a=n9.empty();return nf(n,(e,n)=>{let o=hF(t,e,r);n=et(n);let u=i.childContextForFieldPath(o);if(n instanceof hC)s.push(o);else{let e=hN(n,u);null!=e&&(s.push(o),a.set(o,e))}}),new h_(a,new n_(s),i.fieldTransforms)}function hD(e,t,r,n,i,s){let a=e.createContext(1,t,r),o=[hM(t,n,r)],u=[i];if(s.length%2!=0)throw new tw(ty.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(hM(t,s[e])),u.push(s[e+1]);let l=[],h=n9.empty();for(let e=o.length-1;e>=0;--e)if(!hU(l,o[e])){let t=o[e],r=u[e];r=et(r);let n=a.childContextForFieldPath(t);if(r instanceof hC)l.push(t);else{let e=hN(r,n);null!=e&&(l.push(t),h.set(t,e))}}return new h_(h,new n_(l),a.fieldTransforms)}function hk(e,t,r,n=!1){return hN(r,e.createContext(n?4:3,t))}function hN(e,t){if(hO(e=et(e)))return hL("Unsupported field value:",t,e),hR(e,t);if(e instanceof hm)return function(e,t){if(!hE(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");let r=[],n=0;for(let i of e){let e=hN(i,t.childContextForArray(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}return function(e,t){var r,n,i;if(null===(e=et(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return r=t.serializer,ry(n=e)?i3(n):i2(r,n);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=tQ.fromDate(e);return{timestampValue:sH(t.serializer,r)}}if(e instanceof tQ){let r=new tQ(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:sH(t.serializer,r)}}if(e instanceof hy)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof hp)return{bytesValue:sQ(t.serializer,e._byteString)};if(e instanceof ht){let r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:sJ(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof hw)return{mapValue:{fields:{[nV]:{stringValue:nq},[nj]:{arrayValue:{values:((i=e)instanceof hw?i.toArray():i).map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return i2(t.serializer,e)})}}}}};if(as(e))return e._toProto(t.serializer);throw t.createError(`Unsupported field value: ${tz(e)}`)}(e,t)}function hR(e,t){let r={};return np(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):nf(e,(e,n)=>{let i=hN(n,t.childContextForField(e));null!=i&&(r[e]=i)}),{mapValue:{fields:r}}}function hO(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof tQ||e instanceof hy||e instanceof hp||e instanceof ht||e instanceof hm||e instanceof hw||as(e))}function hL(e,t,r){if(!hO(r)||!tj(r)){let n=tz(r);throw"an object"===n?t.createError(e+" a custom object"):t.createError(e+" "+n)}}function hM(e,t,r){if((t=et(t))instanceof hg)return t._internalPath;if("string"==typeof t)return hF(e,t);throw hV("Field path arguments must be of type string or ",e,!1,void 0,r)}let hP=RegExp("[~\\*/\\[\\]]");function hF(e,t,r){if(t.search(hP)>=0)throw hV(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new hg(...t.split("."))._internalPath}catch(n){throw hV(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function hV(e,t,r,n,i){let s=n&&!n.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new tw(ty.INVALID_ARGUMENT,o+e+u)}function hU(e,t){return e.some(e=>e.isEqual(t))}class hB{convertValue(e,t="none"){switch(n$(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nx(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(nC(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw tp(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return nf(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){return new hw(e.fields?.[nj].arrayValue?.values?.map(e=>nx(e.doubleValue)))}convertGeoPoint(e){return new hy(nx(e.latitude),nx(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=nO(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(nL(e));default:return null}}convertTimestamp(e){let t=nS(e);return new tQ(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=tM.fromString(e);tm(ai(r),9688,{name:e});let n=new nF(r.get(1),r.get(3)),i=new tV(r.popFirst(5));return n.isEqual(t)||tc(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class hq extends hB{constructor(e){super(),this.firestore=e}convertBytes(e){return new hp(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ht(this.firestore,null,t)}}let hj="@firebase/firestore",hz="4.10.0";function h$(e){if("object"!=typeof e||null===e)return!1;for(let t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}class hK{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class hG{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new n9({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class hH{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ht(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new hQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(hM("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class hQ extends hH{data(){return super.data()}}function hW(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new tw(ty.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hJ{}class hY extends hJ{}function hX(e,t,...r){let n=[];for(let i of(t instanceof hJ&&n.push(t),function(e){let t=e.filter(e=>e instanceof h1).length,r=e.filter(e=>e instanceof hZ).length;if(t>1||t>0&&r>0)throw new tw(ty.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(r)),n))e=i._apply(e);return e}class hZ extends hY{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new hZ(e,t,r)}_apply(e){let t=this._parse(e);return cu(e._query,t),new he(e.firestore,e.converter,iV(e._query,t))}_parse(e){let t=hS(e.firestore);return function(e,t,r,n,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new tw(ty.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){co(a,s);let t=[];for(let r of a)t.push(ca(n,e,r));o={arrayValue:{values:t}}}else o=ca(n,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||co(a,s),o=hk(r,t,a,"in"===s||"not-in"===s);return io.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function h0(e,t,r){let n=hM("where",e);return hZ._create(n,t,r)}class h1 extends hJ{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new h1(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:iu.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;for(let e of t.getFlattenedFilters())cu(r,e),r=iV(r,e)}(e._query,t),new he(e.firestore,e.converter,iV(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function h2(...e){return e.forEach(e=>cl("or",e)),h1._create("or",e)}function h3(...e){return e.forEach(e=>cl("and",e)),h1._create("and",e)}class h8 extends hY{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new h8(e,t)}_apply(e){var t;let r,n=function(e,t,r){if(null!==e.startAt)throw new tw(ty.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new tw(ty.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new is(t,r)}(e._query,this._field,this._direction);return new he(e.firestore,e.converter,(t=e._query,r=t.explicitOrderBy.concat([n]),new iN(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}function h6(e,t="asc"){let r=hM("orderBy",e);return h8._create(r,t)}class h4 extends hY{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new h4(e,t,r)}_apply(e){return new he(e.firestore,e.converter,iU(e._query,this._limit,this._limitType))}}function h5(e){return tK("limit",e),h4._create("limit",e,"F")}function h7(e){return tK("limitToLast",e),h4._create("limitToLast",e,"L")}class h9 extends hY{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new h9(e,t,r)}_apply(e){var t;let r=cs(e,this.type,this._docOrFields,this._inclusive);return new he(e.firestore,e.converter,(t=e._query,new iN(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,r,t.endAt)))}}function ce(...e){return h9._create("startAt",e,!0)}function ct(...e){return h9._create("startAfter",e,!1)}class cr extends hY{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new cr(e,t,r)}_apply(e){var t;let r=cs(e,this.type,this._docOrFields,this._inclusive);return new he(e.firestore,e.converter,(t=e._query,new iN(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,r)))}}function cn(...e){return cr._create("endBefore",e,!1)}function ci(...e){return cr._create("endAt",e,!0)}function cs(e,t,r,n){if(r[0]=et(r[0]),r[0]instanceof hH)return function(e,t,r,n,i){if(!n)throw new tw(ty.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${r}().`);let s=[];for(let r of iM(e))if(r.field.isKeyField())s.push(nY(t,n.key));else{let e=n.data.field(r.field);if(nR(e))throw new tw(ty.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+r.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=r.field.canonicalString();throw new tw(ty.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new it(s,i)}(e._query,e.firestore._databaseId,t,r[0]._document,n);{let i=hS(e.firestore);return function(e,t,r,n,i,s){let a=e.explicitOrderBy;if(i.length>a.length)throw new tw(ty.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let s=0;s<i.length;s++){let u=i[s];if(a[s].field.isKeyField()){if("string"!=typeof u)throw new tw(ty.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof u}`);if(!iL(e)&&-1!==u.indexOf("/"))throw new tw(ty.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${u}' contains a slash.`);let r=e.path.child(tM.fromString(u));if(!tV.isDocumentKey(r))throw new tw(ty.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${r}' is not because it contains an odd number of segments.`);let i=new tV(r);o.push(nY(t,i))}else{let e=hk(r,n,u);o.push(e)}}return new it(o,s)}(e._query,e.firestore._databaseId,i,t,r,n)}}function ca(e,t,r){if("string"==typeof(r=et(r))){if(""===r)throw new tw(ty.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iL(t)&&-1!==r.indexOf("/"))throw new tw(ty.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let n=t.path.child(tM.fromString(r));if(!tV.isDocumentKey(n))throw new tw(ty.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return nY(e,new tV(n))}if(r instanceof ht)return nY(e,r._key);throw new tw(ty.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tz(r)}.`)}function co(e,t){if(!Array.isArray(e)||0===e.length)throw new tw(ty.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function cu(e,t){let r=function(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new tw(ty.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new tw(ty.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}function cl(e,t){if(!(t instanceof hZ||t instanceof h1))throw new tw(ty.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function ch(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class cc extends hB{constructor(e){super(),this.firestore=e}convertBytes(e){return new hp(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ht(this.firestore,null,t)}}function cd(e){return new hK("sum",hM("sum",e))}function cf(e){return new hK("avg",hM("average",e))}function cp(){return new hK("count")}function cg(e,t){return e instanceof hK&&t instanceof hK&&e.aggregateType===t.aggregateType&&e._internalFieldPath?.canonicalString()===t._internalFieldPath?.canonicalString()}function cm(e,t){return hs(e.query,t.query)&&Z(e.data(),t.data())}function cy(e){return cw(e,{count:cp()})}function cw(e,t){var r;let n,i=t$(e.firestore,hh),s=hd(i),a=function(e,t){let r=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.push(t(e[n],n,e));return r}(t,(e,t)=>new sE(t,e.aggregateType,e._internalFieldPath));return(r=e._query,n=new tv,s.asyncQueue.enqueueAndForget(async()=>{try{let e=await l1(s);n.resolve(async function(e,t,r){let{request:n,gt:i,parent:s}=function(e,t,r,n){let{ft:i,parent:s}=ae(e,t),a={},o=[],u=0;return r.forEach(e=>{let t="aggregate_"+u++;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:ar(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:ar(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},gt:a,parent:s}}(e.serializer,(t.Re||(t.Re=iF(t,t.explicitOrderBy)),t.Re),r);e.connection.Ko||delete n.parent;let a=(await e.jo("RunAggregationQuery",e.serializer.databaseId,s,n,1)).filter(e=>!!e.result);tm(1===a.length,64727);let o=a[0].result?.aggregateFields;return Object.keys(o).reduce((e,t)=>(e[i[t]]=o[t],e),{})}(e,r,a))}catch(e){n.reject(e)}}),n.promise).then(t=>new hG(e,new hq(i),t))}class cv{constructor(e){this.kind="memory",this._onlineComponentProvider=lB.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new lF(void 0)}}toJSON(){return{kind:this.kind}}}class cb{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=cD(void 0))._initialize(e),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class c_{constructor(){this.kind="memoryEager",this._offlineComponentProvider=lP.provider}toJSON(){return{kind:this.kind}}}class cE{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new lF(e)}}toJSON(){return{kind:this.kind}}}function cI(){return new c_}function cT(e){return new cE(e?.cacheSizeBytes)}function cS(e){return new cv(e)}function cx(e){return new cb(e)}class cC{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=lB.provider,this._offlineComponentProvider={build:t=>new lV(t,e?.cacheSizeBytes,this.forceOwnership)}}}class cA{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=lB.provider,this._offlineComponentProvider={build:t=>new lU(t,e?.cacheSizeBytes)}}}function cD(e){return new cC(e?.forceOwnership)}function ck(){return new cA}let cN="NOT SUPPORTED";class cR{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cO extends hH{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new cM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(hM("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new tw(ty.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=cO._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),this._firestore,this.ref.path,t.bundle="NOT SUPPORTED"),t}}function cL(e,t,r){if(tH(t,cO._jsonSchema)){var n;if(t.bundle===cN)throw new tw(ty.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let i=ua(e._databaseId),s=(n=t.bundle,new l$(n,i)),a=s.t(),o=new u6(s.getMetadata(),i);for(let e of a)o.o(e);let u=o.documents;if(1!==u.length)throw new tw(ty.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${u.length} documents.`);let l=s4(i,u[0].document),h=new tV(tM.fromString(t.bundleName));return new cO(e,new cc(e),h,l,new cR(!1,!1),r||null)}}cO._jsonSchemaVersion="firestore/documentSnapshot/1.0",cO._jsonSchema={type:tG("string",cO._jsonSchemaVersion),bundleSource:tG("string","DocumentSnapshot"),bundleName:tG("string"),bundle:tG("string")};class cM extends cO{data(e={}){return super.data(e)}}class cP{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new cR(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new cM(this._firestore,this._userDataWriter,r.key,r,new cR(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new tw(ty.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let n=new cM(e._firestore,e._userDataWriter,r.doc.key,r.doc,new cR(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new cM(e._firestore,e._userDataWriter,t.doc.key,t.doc,new cR(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tp(61501,{type:e})}}(t.type),doc:n,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new tw(ty.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=cP._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=tA.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],n=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),n.push(e.ref.path))}),this._firestore,this.query._query,e.bundleName,e.bundle="NOT SUPPORTED",e}}function cF(e,t,r){if(tH(t,cP._jsonSchema)){var n;if(t.bundle===cN)throw new tw(ty.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let i=ua(e._databaseId),s=(n=t.bundle,new l$(n,i)),a=s.t(),o=new u6(s.getMetadata(),i);for(let e of a)o.o(e);if(1!==o.queries.length)throw new tw(ty.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);let u=ag(o.queries[0].bundledQuery),l=o.documents,h=new uK;l.map(e=>{let t=s4(i,e.document);h=h.add(t)});let c=uH.fromInitialDocuments(u,h,i0(),!1,!1),d=new he(e,r||null,u);return new cP(e,new cc(e),d,c)}}function cV(e,t){return e instanceof cO&&t instanceof cO?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof cP&&t instanceof cP&&e._firestore===t._firestore&&hs(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}cP._jsonSchemaVersion="firestore/querySnapshot/1.0",cP._jsonSchema={type:tG("string",cP._jsonSchemaVersion),bundleSource:tG("string","QuerySnapshot"),bundleName:tG("string"),bundle:tG("string")};let cU={maxAttempts:5};class cB{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=hS(e)}set(e,t,r){this._verifyNotCommitted();let n=cq(e,this._firestore),i=ch(n.converter,t,r),s=hx(this._dataReader,"WriteBatch.set",n._key,i,null!==n.converter,r);return this._mutations.push(s.toMutation(n._key,sa.none())),this}update(e,t,r,...n){let i;this._verifyNotCommitted();let s=cq(e,this._firestore);return i="string"==typeof(t=et(t))||t instanceof hg?hD(this._dataReader,"WriteBatch.update",s._key,t,r,n):hA(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(i.toMutation(s._key,sa.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=cq(e,this._firestore);return this._mutations=this._mutations.concat(new sy(t._key,sa.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new tw(ty.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function cq(e,t){if((e=et(e)).firestore!==t)throw new tw(ty.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class cj{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=hS(e)}get(e){let t=cq(e,this._firestore),r=new cc(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return tp(24041);let n=e[0];if(n.isFoundDocument())return new hH(this._firestore,r,n.key,n,t.converter);if(n.isNoDocument())return new hH(this._firestore,r,t._key,null,t.converter);throw tp(18433,{doc:n})})}set(e,t,r){let n=cq(e,this._firestore),i=ch(n.converter,t,r),s=hx(this._dataReader,"Transaction.set",n._key,i,null!==n.converter,r);return this._transaction.set(n._key,s),this}update(e,t,r,...n){let i,s=cq(e,this._firestore);return i="string"==typeof(t=et(t))||t instanceof hg?hD(this._dataReader,"Transaction.update",s._key,t,r,n):hA(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,i),this}delete(e){let t=cq(e,this._firestore);return this._transaction.delete(t._key),this}}class cz extends cj{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=cq(e,this._firestore),r=new hq(this._firestore);return super.get(e).then(e=>new cO(this._firestore,r,t._key,e._document,new cR(!1,!1),t.converter))}}function c$(e,t,r){var n,i;let s;e=t$(e,hh);let a={...cU,...r};if(a.maxAttempts<1)throw new tw(ty.INVALID_ARGUMENT,"Max attempts must be at least 1");return n=hd(e),i=r=>t(new cz(e,r)),s=new tv,n.asyncQueue.enqueueAndForget(async()=>{let e=await l1(n);new lG(n.asyncQueue,e,a,i,s).ju()}),s.promise}function cK(e){e=t$(e,ht);let t=t$(e.firestore,hh);return l3(hd(t),e._key).then(r=>c6(t,e,r))}function cG(e){var t;let r;e=t$(e,ht);let n=t$(e.firestore,hh),i=hd(n),s=new hq(n);return(t=e._key,r=new tv,i.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await e.persistence.runTransaction("read document","readonly",r=>e.localDocuments.getDocument(r,t));n.isFoundDocument()?r.resolve(n):n.isNoDocument()?r.resolve(null):r.reject(new tw(ty.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let e=u$(n,`Failed to get document '${t} from cache`);r.reject(e)}})(await lZ(i),t,r)),r.promise).then(t=>new cO(n,s,e._key,t,new cR(null!==t&&t.hasLocalMutations,!0),e.converter))}function cH(e){e=t$(e,ht);let t=t$(e.firestore,hh);return l3(hd(t),e._key,{source:"server"}).then(r=>c6(t,e,r))}function cQ(e){e=t$(e,he);let t=t$(e.firestore,hh),r=hd(t),n=new hq(t);return hW(e._query),l8(r,e._query).then(r=>new cP(t,n,e,r))}function cW(e){var t;let r;e=t$(e,he);let n=t$(e.firestore,hh),i=hd(n),s=new hq(n);return(t=e._query,r=new tv,i.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await oP(e,t,!0),i=new u9(t,n.ks),s=i.ru(n.documents),a=i.applyChanges(s,!1);r.resolve(a.snapshot)}catch(n){let e=u$(n,`Failed to execute query '${t} against cache`);r.reject(e)}})(await lZ(i),t,r)),r.promise).then(t=>new cP(n,s,e,t))}function cJ(e){e=t$(e,he);let t=t$(e.firestore,hh),r=hd(t),n=new hq(t);return l8(r,e._query,{source:"server"}).then(r=>new cP(t,n,e,r))}function cY(e,t,r){e=t$(e,ht);let n=t$(e.firestore,hh),i=ch(e.converter,t,r),s=hS(n);return c8(n,[hx(s,"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,sa.none())])}function cX(e,t,r,...n){e=t$(e,ht);let i=t$(e.firestore,hh),s=hS(i);return c8(i,[("string"==typeof(t=et(t))||t instanceof hg?hD(s,"updateDoc",e._key,t,r,n):hA(s,"updateDoc",e._key,t)).toMutation(e._key,sa.exists(!0))])}function cZ(e){return c8(t$(e.firestore,hh),[new sy(e._key,sa.none())])}function c0(e,t){let r=t$(e.firestore,hh),n=hi(e),i=ch(e.converter,t);return c8(r,[hx(hS(e.firestore),"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,sa.exists(!1))]).then(()=>n)}function c1(e,...t){var r;let n,i,s,a,o;e=et(e);let u={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof t[0]||h$(t[l])||(u=t[l++]);let h={includeMetadataChanges:u.includeMetadataChanges,source:u.source};if(h$(t[l])){let e=t[l];t[l]=e.next?.bind(e),t[l+1]=e.error?.bind(e),t[l+2]=e.complete?.bind(e)}if(e instanceof ht)i=t$(e.firestore,hh),s=iR(e._key.path),n={next:r=>{t[l]&&t[l](c6(i,e,r))},error:t[l+1],complete:t[l+2]};else{let r=t$(e,he);i=t$(r.firestore,hh),s=r._query;let a=new hq(i);n={next:e=>{t[l]&&t[l](new cP(i,a,r,e))},error:t[l+1],complete:t[l+2]},hW(e._query)}return r=hd(i),o=new u2(s,a=new lj(n),h),r.asyncQueue.enqueueAndForget(async()=>uY(await l2(r),o)),()=>{a.Nu(),r.asyncQueue.enqueueAndForget(async()=>uX(await l2(r),o))}}function c2(e,t,...r){var n,i,s,a,o,u;let l=et(e),h=function(e){let t={bundle:"",bundleName:"",bundleSource:""};for(let r of["bundle","bundleName","bundleSource"]){if(!(r in e)){t.error=`snapshotJson missing required field: ${r}`;break}let n=e[r];if("string"!=typeof n){t.error=`snapshotJson field '${r}' must be a string.`;break}if(0===n.length){t.error=`snapshotJson field '${r}' cannot be an empty string.`;break}"bundle"===r?t.bundle=n:"bundleName"===r?t.bundleName=n:"bundleSource"===r&&(t.bundleSource=n)}return t}(t);if(h.error)throw new tw(ty.INVALID_ARGUMENT,h.error);let c,d=0;if("object"!=typeof r[0]||h$(r[d])||(c=r[d++]),"QuerySnapshot"===h.bundleSource){let e,t,a=null;if("object"==typeof r[d]&&h$(r[d])){let e=r[d++];a={next:e.next,error:e.error,complete:e.complete}}else a={next:r[d++],error:r[d++],complete:r[d++]};return n=c,i=a,s=r[d],t=!1,hf(l,h.bundle).then(()=>{var e,t,r;return e=l,t=h.bundleName,(r=hd(e=t$(e,hh)),r.asyncQueue.enqueue(async()=>{var e;return e=await lZ(r),e.persistence.runTransaction("Get named query","readonly",r=>e.Pi.getNamedQuery(r,t))})).then(t=>t?new he(e,null,t.query):null)}).then(r=>{r&&!t&&(s&&r.withConverter(s),e=c1(r,n||{},i))}).catch(e=>(i.error&&i.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}if("DocumentSnapshot"===h.bundleSource){let e,t,n=null;if("object"==typeof r[d]&&h$(r[d])){let e=r[d++];n={next:e.next,error:e.error,complete:e.complete}}else n={next:r[d++],error:r[d++],complete:r[d++]};return a=c,o=n,u=r[d],t=!1,hf(l,h.bundle).then(()=>{t||(e=c1(new ht(l,u||null,tV.fromPath(h.bundleName)),a||{},o))}).catch(e=>(o.error&&o.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}throw new tw(ty.INVALID_ARGUMENT,`unsupported bundle source: ${h.bundleSource}`)}function c3(e,t){let r,n=hd(e=t$(e,hh));return r=new lj(h$(t)?t:{next:t}),n.asyncQueue.enqueueAndForget(async()=>{var e;return e=await l2(n),void(e.Ca.add(r),r.next())}),()=>{r.Nu(),n.asyncQueue.enqueueAndForget(async()=>{var e;return e=await l2(n),void e.Ca.delete(r)})}}function c8(e,t){var r;let n;return r=hd(e),n=new tv,r.asyncQueue.enqueueAndForget(async()=>lh(await l0(r),t,n)),n.promise}function c6(e,t,r){let n=r.docs.get(t._key),i=new hq(e);return new cO(e,i,t._key,n,new cR(r.hasPendingWrites,r.fromCache),t.converter)}function c4(e){return hd(e=t$(e,hh)),new cB(e,t=>c8(e,t))}function c5(e,t){let r=hd(e=t$(e,hh));if(!r._uninitializedComponentsProvider||"memory"===r._uninitializedComponentsProvider._offline.kind)return td("Cannot enable indexes when persistence is disabled"),Promise.resolve();let n=function(e){let t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new tw(ty.INVALID_ARGUMENT,"Failed to parse JSON: "+e?.message)}}(e):e,r=[];if(Array.isArray(t.indexes))for(let e of t.indexes){let t=c7(e,"collectionGroup"),n=[];if(Array.isArray(e.fields))for(let t of e.fields){let e=hF("setIndexConfiguration",c7(t,"fieldPath"));"CONTAINS"===t.arrayConfig?n.push(new t0(e,2)):"ASCENDING"===t.order?n.push(new t0(e,0)):"DESCENDING"===t.order&&n.push(new t0(e,1))}r.push(new tJ(tJ.UNKNOWN_ID,t,n,t1.empty()))}return r}(t);return r.asyncQueue.enqueue(async()=>(async function(e,t){let r=e.indexManager,n=[];return e.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(i=>(function(e,t,r,n,i){t=[...t],(e=[...e]).sort(r),t.sort(r);let s=e.length,a=t.length,o=0,u=0;for(;o<a&&u<s;){let s=r(e[u],t[o]);s<0?i(e[u++]):s>0?n(t[o++]):(o++,u++)}for(;o<a;)n(t[o++]);for(;u<s;)i(e[u++])})(i,t,tZ,t=>{n.push(r.addFieldIndex(e,t))},t=>{n.push(r.deleteFieldIndex(e,t))})).next(()=>t9.waitFor(n)))})(await lZ(r),n))}function c7(e,t){if("string"!=typeof e[t])throw new tw(ty.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class c9{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function de(e){e=t$(e,hh);let t=ds.get(e);if(t)return t;let r=hd(e);if("persistent"!==r._uninitializedComponentsProvider?._offline.kind)return null;let n=new c9(e);return ds.set(e,n),n}function dt(e){di(e,!0)}function dr(e){di(e,!1)}function dn(e){var t;(t=hd(e._firestore)).asyncQueue.enqueue(async()=>{var e;let r;return r=(e=await lZ(t)).indexManager,e.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))}).then(e=>th("deleting all persistent cache indexes succeeded")).catch(e=>td("deleting all persistent cache indexes failed",e))}function di(e,t){var r;(r=hd(e._firestore),r.asyncQueue.enqueue(async()=>{var e;return e=await lZ(r),void(e.Cs.As=t)})).then(e=>th(`setting persistent cache index auto creation isEnabled=${t} succeeded`)).catch(e=>td(`setting persistent cache index auto creation isEnabled=${t} failed`,e))}let ds=new WeakMap;class da{constructor(){throw Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return du.instance.onExistenceFilterMismatch(e)}}class du{constructor(){this.i=new Map}static get instance(){return dl||function(e){if(sx)throw Error("a TestingHooksSpi instance is already set");sx=e}(dl=new du),dl}u(e){this.i.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.i;return r.set(t,e),()=>r.delete(t)}}let dl=null;!function(e=!0){to=eG,eM(new er("firestore",(t,{instanceIdentifier:r,options:n})=>{let i=t.getProvider("app").getImmediate(),s=new hh(new tI(t.getProvider("auth-internal")),new tC(i,t.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new tw(ty.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nF(e.options.projectId,t)}(i,r),i);return n={useFetchStreams:e,...n},s._setSettings(n),s},"PUBLIC").setMultipleInstances(!0)),eX(hj,hz,void 0),eX(hj,hz,"esm2020")}(),e.s(["AggregateField",()=>hK,"AggregateQuerySnapshot",()=>hG,"DocumentSnapshot",()=>cO,"PersistentCacheIndexManager",()=>c9,"QueryCompositeFilterConstraint",()=>h1,"QueryConstraint",()=>hY,"QueryDocumentSnapshot",()=>cM,"QueryEndAtConstraint",()=>cr,"QueryFieldFilterConstraint",()=>hZ,"QueryLimitConstraint",()=>h4,"QueryOrderByConstraint",()=>h8,"QuerySnapshot",()=>cP,"QueryStartAtConstraint",()=>h9,"SnapshotMetadata",()=>cR,"Transaction",()=>cz,"WriteBatch",()=>cB,"_TestingHooks",()=>da,"addDoc",()=>c0,"aggregateFieldEqual",()=>cg,"aggregateQuerySnapshotEqual",()=>cm,"and",()=>h3,"average",()=>cf,"count",()=>cp,"deleteAllPersistentCacheIndexes",()=>dn,"deleteDoc",()=>cZ,"disablePersistentCacheIndexAutoCreation",()=>dr,"documentSnapshotFromJSON",()=>cL,"enablePersistentCacheIndexAutoCreation",()=>dt,"endAt",()=>ci,"endBefore",()=>cn,"executeWrite",()=>c8,"getAggregateFromServer",()=>cw,"getCountFromServer",()=>cy,"getDoc",()=>cK,"getDocFromCache",()=>cG,"getDocFromServer",()=>cH,"getDocs",()=>cQ,"getDocsFromCache",()=>cW,"getDocsFromServer",()=>cJ,"getPersistentCacheIndexManager",()=>de,"limit",()=>h5,"limitToLast",()=>h7,"memoryEagerGarbageCollector",()=>cI,"memoryLocalCache",()=>cS,"memoryLruGarbageCollector",()=>cT,"onSnapshot",()=>c1,"onSnapshotResume",()=>c2,"onSnapshotsInSync",()=>c3,"or",()=>h2,"orderBy",()=>h6,"persistentLocalCache",()=>cx,"persistentMultipleTabManager",()=>ck,"persistentSingleTabManager",()=>cD,"query",()=>hX,"querySnapshotFromJSON",()=>cF,"runTransaction",()=>c$,"setDoc",()=>cY,"setIndexConfiguration",()=>c5,"snapshotEqual",()=>cV,"startAfter",()=>ct,"startAt",()=>ce,"sum",()=>cd,"updateDoc",()=>cX,"where",()=>h0,"writeBatch",()=>c4],63802),e.s([],36180),e.i(63802),e.s(["Timestamp",()=>tQ,"addDoc",()=>c0,"collection",()=>hn,"deleteDoc",()=>cZ,"doc",()=>hi,"getDoc",()=>cK,"getDocs",()=>cQ,"getFirestore",()=>hc,"orderBy",()=>h6,"query",()=>hX,"setDoc",()=>cY,"where",()=>h0],98925);let dh="firebasestorage.googleapis.com",dc="storageBucket";class dd extends J{constructor(e,t,r=0){super(df(e),`Firebase Storage: ${t} (${df(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return df(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function df(e){return"storage/"+e}function dp(){return new dd(I.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function dg(e){return new dd(I.INVALID_ARGUMENT,e)}function dm(){return new dd(I.APP_DELETED,"The Firebase app was deleted.")}function dy(e,t){return new dd(I.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function dw(e){throw new dd(I.INTERNAL_ERROR,"Internal error: "+e)}(a=I||(I={})).UNKNOWN="unknown",a.OBJECT_NOT_FOUND="object-not-found",a.BUCKET_NOT_FOUND="bucket-not-found",a.PROJECT_NOT_FOUND="project-not-found",a.QUOTA_EXCEEDED="quota-exceeded",a.UNAUTHENTICATED="unauthenticated",a.UNAUTHORIZED="unauthorized",a.UNAUTHORIZED_APP="unauthorized-app",a.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",a.INVALID_CHECKSUM="invalid-checksum",a.CANCELED="canceled",a.INVALID_EVENT_NAME="invalid-event-name",a.INVALID_URL="invalid-url",a.INVALID_DEFAULT_BUCKET="invalid-default-bucket",a.NO_DEFAULT_BUCKET="no-default-bucket",a.CANNOT_SLICE_BLOB="cannot-slice-blob",a.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",a.NO_DOWNLOAD_URL="no-download-url",a.INVALID_ARGUMENT="invalid-argument",a.INVALID_ARGUMENT_COUNT="invalid-argument-count",a.APP_DELETED="app-deleted",a.INVALID_ROOT_OPERATION="invalid-root-operation",a.INVALID_FORMAT="invalid-format",a.INTERNAL_ERROR="internal-error",a.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class dv{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=dv.makeFromUrl(e,t)}catch(t){return new dv(e,"")}if(""===r.path)return r;throw new dd(I.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let r=null,n="([A-Za-z0-9.\\-_]+)",i=RegExp("^gs://"+n+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}let a=t.replace(/[.]/g,"\\."),o=RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${n}/o(/([^?#]*).*)?$`,"i"),u=t===dh?"(?:storage.googleapis.com|storage.cloud.google.com)":t,l=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:o,indices:{bucket:1,path:3},postModify:s},{regex:RegExp(`^https?://${u}/${n}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<l.length;t++){let n=l[t],i=n.regex.exec(e);if(i){let e=i[n.indices.bucket],t=i[n.indices.path];t||(t=""),r=new dv(e,t),n.postModify(r);break}}if(null==r)throw new dd(I.INVALID_URL,"Invalid URL '"+e+"'.");return r}}class db{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function d_(e){return"string"==typeof e||e instanceof String}function dE(e){return dI()&&e instanceof Blob}function dI(){return"u">typeof Blob}function dT(e,t,r,n){if(n<t)throw dg(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw dg(`Invalid value for '${e}'. Expected ${r} or less.`)}function dS(e,t,r){let n=t;return null==r&&(n=`https://${t}`),`${r}://${n}/v0${e}`}function dx(e){let t=encodeURIComponent,r="?";for(let n in e)e.hasOwnProperty(n)&&(r=r+(t(n)+"=")+t(e[n])+"&");return r.slice(0,-1)}(o=T||(T={}))[o.NO_ERROR=0]="NO_ERROR",o[o.NETWORK_ERROR=1]="NETWORK_ERROR",o[o.ABORT=2]="ABORT";class dC{constructor(e,t,r,n,i,s,a,o,u,l,h,c=!0,d=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=n,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=o,this.timeout_=u,this.progressCallback_=l,this.connectionFactory_=h,this.retry=c,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){let e=(e,t)=>{if(t)return void e(!1,new dA(!1,null,!0));let r=this.connectionFactory_();this.pendingConnection_=r;let n=e=>{let t=e.loaded,r=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,r)};null!==this.progressCallback_&&r.addUploadProgressListener(n),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{var t;let i,s,a;null!==this.progressCallback_&&r.removeUploadProgressListener(n),this.pendingConnection_=null;let o=r.getErrorCode()===T.NO_ERROR,u=r.getStatus();!o||(t=this.additionalRetryCodes_,i=u>=500&&u<600,s=-1!==[408,429].indexOf(u),a=-1!==t.indexOf(u),(i||s||a)&&this.retry)?e(!1,new dA(!1,null,r.getErrorCode()===T.ABORT)):e(!0,new dA(-1!==this.successCodes_.indexOf(u),r))})},t=(e,t)=>{let r=this.resolve_,n=this.reject_,i=t.connection;if(t.wasSuccessCode)try{let e=this.callback_(i,i.getResponse());void 0!==e?r(e):r()}catch(e){n(e)}else if(null!==i){let e=dp();e.serverResponse=i.getErrorText(),n(this.errorCallback_?this.errorCallback_(i,e):e)}else n(t.canceled?this.appDelete_?dm():new dd(I.CANCELED,"User canceled the upload/download."):new dd(I.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(!1,new dA(!1,null,!0)):this.backoffId_=function(e,t,r){let n=1,i=null,s=null,a=!1,o=0,u=!1;function l(...e){u||(u=!0,t.apply(null,e))}function h(t){i=setTimeout(()=>{i=null,e(d,2===o)},t)}function c(){s&&clearTimeout(s)}function d(e,...t){let r;if(u)return void c();if(e||2===o||a){c(),l.call(null,e,...t);return}n<64&&(n*=2),1===o?(o=2,r=0):r=(n+Math.random())*1e3,h(r)}let f=!1;function p(e){f||(f=!0,c(),!u&&(null!==i?(e||(o=2),clearTimeout(i),h(0)):e||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,p(!0)},r),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class dA{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function dD(...e){let t="u">typeof BlobBuilder?BlobBuilder:"u">typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){let r=new t;for(let t=0;t<e.length;t++)r.append(e[t]);return r.getBlob()}if(dI())return new Blob(e);throw new dd(I.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}let dk="base64",dN="base64url",dR="data_url";class dO{constructor(e,t){this.data=e,this.contentType=t||null}}function dL(e,t){switch(e){case"raw":return new dO(dM(t));case dk:case dN:return new dO(dP(e,t));case dR:return new dO(function(e){let t,r=new dF(e);if(r.base64)return dP(dk,r.rest);var n=r.rest;try{t=decodeURIComponent(n)}catch(e){throw dy(dR,"Malformed data URL.")}return dM(t)}(t),new dF(t).contentType)}throw dp()}function dM(e){let t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);n<=127?t.push(n):n<=2047?t.push(192|n>>6,128|63&n):(64512&n)==55296?r<e.length-1&&(64512&e.charCodeAt(r+1))==56320?(n=65536|(1023&n)<<10|1023&e.charCodeAt(++r),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n)):t.push(239,191,189):(64512&n)==56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|63&n)}return new Uint8Array(t)}function dP(e,t){let r;switch(e){case dk:{let r=-1!==t.indexOf("-"),n=-1!==t.indexOf("_");if(r||n)throw dy(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case dN:{let r=-1!==t.indexOf("+"),n=-1!==t.indexOf("/");if(r||n)throw dy(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}}try{r=function(e){if("u"<typeof atob)throw new dd(I.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw dy(e,"Invalid character found")}let n=new Uint8Array(r.length);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);return n}class dF{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw dy(dR,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class dV{constructor(e,t){let r=0,n="";dE(e)?(this.data_=e,r=e.size,n=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=n}size(){return this.size_}type(){return this.type_}slice(e,t){if(!dE(this.data_))return new dV(new Uint8Array(this.data_.buffer,e,t-e),!0);{var r,n,i;let s=(r=this.data_,n=e,i=t,r.webkitSlice?r.webkitSlice(n,i):r.mozSlice?r.mozSlice(n,i):r.slice?r.slice(n,i):null);return null===s?null:new dV(s)}}static getBlob(...e){if(dI()){let t=e.map(e=>e instanceof dV?e.data_:e);return new dV(dD.apply(null,t))}{let t=e.map(e=>d_(e)?dL("raw",e).data:e.data_),r=0;t.forEach(e=>{r+=e.byteLength});let n=new Uint8Array(r),i=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)n[i++]=e[t]}),new dV(n,!0)}}uploadData(){return this.data_}}function dU(e){var t;let r;try{r=JSON.parse(e)}catch(e){return null}return"object"!=typeof(t=r)||Array.isArray(t)?null:r}function dB(e){let t=e.lastIndexOf("/",e.length-2);return -1===t?e:e.slice(t+1)}function dq(e,t){return t}class dj{constructor(e,t,r,n){this.server=e,this.local=t||e,this.writable=!!r,this.xform=n||dq}}let dz=null;function d$(){if(dz)return dz;let e=[];e.push(new dj("bucket")),e.push(new dj("generation")),e.push(new dj("metageneration")),e.push(new dj("name","fullPath",!0));let t=new dj("name");t.xform=function(e,t){return!d_(t)||t.length<2?t:dB(t)},e.push(t);let r=new dj("size");return r.xform=function(e,t){return void 0!==t?Number(t):t},e.push(r),e.push(new dj("timeCreated")),e.push(new dj("updated")),e.push(new dj("md5Hash",null,!0)),e.push(new dj("cacheControl",null,!0)),e.push(new dj("contentDisposition",null,!0)),e.push(new dj("contentEncoding",null,!0)),e.push(new dj("contentLanguage",null,!0)),e.push(new dj("contentType",null,!0)),e.push(new dj("metadata","customMetadata",!0)),dz=e}function dK(e,t,r){let n=dU(t);return null===n?null:function(e,t,r){let n={};n.type="file";let i=r.length;for(let e=0;e<i;e++){let i=r[e];n[i.local]=i.xform(n,t[i.server])}return Object.defineProperty(n,"ref",{get:function(){let t=new dv(n.bucket,n.fullPath);return e._makeStorageReference(t)}}),n}(e,n,r)}class dG{constructor(e,t,r,n){this.url=e,this.method=t,this.handler=r,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function dH(e){if(!e)throw dp()}function dQ(e){return function(t,r){var n,i;let s;return 401===t.getStatus()?s=t.getErrorText().includes("Firebase App Check token is invalid")?new dd(I.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new dd(I.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(n=e.bucket,s=new dd(I.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,s=new dd(I.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}}class dW{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=T.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=T.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=T.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,n,i){if(this.sent_)throw dw("cannot .send() more than once");if(V(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(let e in i)i.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,i[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw dw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw dw("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return -1}}getResponse(){if(!this.sent_)throw dw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw dw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class dJ extends dW{initXhr(){this.xhr_.responseType="text"}}function dY(){return new dJ}class dX{constructor(e,t){this._service=e,t instanceof dv?this._location=t:this._location=dv.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new dX(e,t)}get root(){let e=new dv(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dB(this._location.path)}get storage(){return this._service}get parent(){let e=function(e){if(0===e.length)return null;let t=e.lastIndexOf("/");return -1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;let t=new dv(this._location.bucket,e);return new dX(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw new dd(I.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}}function dZ(e,t){let r=t?.[dc];return null==r?null:dv.makeFromBucketSpec(r,e)}class d0{constructor(e,t,r,n,i,s=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=n,this._firebaseVersion=i,this._isUsingEmulator=s,this._bucket=null,this._host=dh,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=n?this._bucket=dv.makeFromBucketSpec(n,this._host):this._bucket=dZ(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=dv.makeFromBucketSpec(this._url,e):this._bucket=dZ(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dT("time",0,1/0,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dT("time",0,1/0,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(eB(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new dX(this,e)}_makeRequest(e,t,r,n,i=!0){if(this._deleted)return new db(dm());{let s=function(e,t,r,n,i,s,a=!0,o=!1){let u=dx(e.urlParams),l=e.url+u,h=Object.assign({},e.headers);return t&&(h["X-Firebase-GMPID"]=t),null!==r&&r.length>0&&(h.Authorization="Firebase "+r),h["X-Firebase-Storage-Version"]="webjs/"+(s??"AppManager"),null!==n&&(h["X-Firebase-AppCheck"]=n),new dC(l,e.method,h,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a,o)}(e,this._appId,r,n,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){let[r,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,n).getPromise()}}let d1="@firebase/storage",d2="0.14.0",d3="storage";function d8(e,t,r,n){return function(e,t,r="raw",n){var i;let s;e._throwIfRoot("uploadString");let a=dL(r,t),o={...n};return null==o.contentType&&null!=a.contentType&&(o.contentType=a.contentType),i=a.data,e._throwIfRoot("uploadBytes"),s=function(e,t,r,n,i){let s,a=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+u;let l=((s=Object.assign({},i)).fullPath=t.path,s.size=n.size(),s.contentType||(s.contentType=n&&n.type()||"application/octet-stream"),s),h="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(e,t){let r={},n=t.length;for(let i=0;i<n;i++){let n=t[i];n.writable&&(r[n.server]=e[n.local])}return JSON.stringify(r)}(l,r)+"\r\n--"+u+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",c=dV.getBlob(h,n,"\r\n--"+u+"--");if(null===c)throw new dd(I.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");let d={name:l.fullPath},f=dS(a,e.host,e._protocol),p=e.maxUploadRetryTime,g=new dG(f,"POST",function(t,n){let i=dK(e,n,r);return dH(null!==i),i},p);return g.urlParams=d,g.headers=o,g.body=c.uploadData(),g.errorHandler=dQ(t),g}(e.storage,e._location,d$(),new dV(i,!0),o),e.storage.makeRequestWithTokens(s,dY).then(t=>({metadata:t,ref:e}))}(e=et(e),t,r,n)}function d6(e){var t,r,n,i;let s,a,o,u,l;return(t=e=et(e))._throwIfRoot("getDownloadURL"),r=t.storage,n=t._location,i=d$(),s=dS(n.fullServerUrl(),r.host,r._protocol),a=r.maxOperationRetryTime,o=new dG(s,"GET",function(e,t){let n=dK(r,t,i);return dH(null!==n),function(e,t,r,n){let i=dU(t);if(null===i||!d_(i.downloadTokens))return null;let s=i.downloadTokens;if(0===s.length)return null;let a=encodeURIComponent;return s.split(",").map(t=>{let i=e.bucket,s=e.fullPath;return dS("/b/"+a(i)+"/o/"+a(s),r,n)+dx({alt:"media",token:t})})[0]}(n,t,r.host,r._protocol)},a),u=dQ(n),o.errorHandler=function(e,t){var r;let i=u(e,t);return 404===e.getStatus()&&(r=n.path,i=new dd(I.OBJECT_NOT_FOUND,"Object '"+r+"' does not exist.")),i.serverResponse=t.serverResponse,i},l=o,t.storage.makeRequestWithTokens(l,dY).then(e=>{if(null===e)throw new dd(I.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function d4(e,t){var r=e=et(e);if(!(t&&/^[A-Za-z]+:\/\//.test(t)))return function e(t,r){var n;let i,s,a;if(t instanceof d0){if(null==t._bucket)throw new dd(I.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dc+"' property when initializing the app?");let n=new dX(t,t._bucket);return null!=r?e(n,r):n}if(void 0===r)return t;return n=t._location.path,i=r.split("/").filter(e=>e.length>0).join("/"),s=0===n.length?i:n+"/"+i,a=new dv(t._location.bucket,s),new dX(t.storage,a)}(r,t);if(r instanceof d0)return new dX(r,t);throw dg("To use ref(service, url), the first argument must be a Storage instance.")}function d5(e=eW(),t){let r=eP(e=et(e),d3).getImmediate({identifier:t}),n=M("storage");return n&&function(e,t,r,n={}){!function(e,t,r,n={}){e.host=`${t}:${r}`;let i=V(t);i&&(U(`https://${e.host}/b`),z("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";let{mockUserToken:s}=n;s&&(e._overrideAuthToken="string"==typeof s?s:B(s,e.app.options.projectId))}(e,t,r,n)}(r,...n),r}eM(new er(d3,function(e,{instanceIdentifier:t}){return new d0(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t,eG)},"PUBLIC").setMultipleInstances(!0)),eX(d1,d2,""),eX(d1,d2,"esm2020"),e.s(["getDownloadURL",()=>d6,"getStorage",()=>d5,"ref",()=>d4,"uploadString",()=>d8],27215),e.s([],61086);let d7=0===eJ().length?eH({apiKey:"AIzaSyB9L73dyPoocEJ1_ApEmLuc5tjwixffwKc",authDomain:"me-do.firebaseapp.com",databaseURL:"https://me-do.firebaseio.com",projectId:"firebase-me-do",storageBucket:"firebase-me-do.appspot.com",messagingSenderId:"1012066892690",appId:"1:1012066892690:web:e63e369e7ad96d296edf4b",measurementId:"G-Z5GXRXQWKZ"}):eJ()[0],d9=hc(d7),fe=d5(d7);e.s(["db",0,d9,"storage",0,fe],59141);let ft={japan:"",japans:"",portugal:"",portugees:"",brazili:"",braziliaans:"",denemarken:"",deens:"",noorwegen:"",noors:"",zweden:"",zweeds:"",finland:"",fins:"",duitsland:"",duits:"",frankrijk:"",frans:"",spanje:"",spaans:"",itali:"",italiaans:"",griekenland:"",grieks:"",rusland:"",russisch:"",china:"",chinees:"",mandarijn:"",korea:"",koreaans:"","zuid-korea":"",india:"",hindi:"",arabisch:"","saoedi-arabi":"",turkije:"",turks:"",nederland:"",nederlands:"",belgi:"",ijsland:"",ijslands:"",ierland:"",iers:"",gaelic:"",schotland:"",schots:"",wales:"",welsh:"",engeland:"",engels:"","verenigd koninkrijk":"",hawaii:"",hawaaans:"",amerika:"",amerikaans:"",canada:"",mexico:"",mexicaans:"",argentini:"",chili:"",peru:"",colombia:"",indonesi:"",indonesisch:"",maleisi:"",maleis:"",thailand:"",thais:"",vietnam:"",vietnamees:"",filipijnen:"",filipijns:"",tagalog:"",polen:"",pools:"",tsjechi:"",tsjechisch:"",hongarije:"",hongaars:"",roemeni:"",roemeens:"",oekrane:"",oekraens:"",egypte:"",egyptisch:"",marokko:"",marokkaans:"","zuid-afrika":"",afrikaans:"",kenia:"",swahili:"",ethiopia:"",amhaars:"",nigeria:"",ghana:"",senegal:"",tanzania:"",australi:"","nieuw-zeeland":"",maori:"",hebreeuws:"",isral:"",perzisch:"",iran:"",farsi:"",pakistan:"",urdu:"",bangladesh:"",bengaals:"","sri lanka":"",singalees:"",tamil:"",nepal:"",tibetaans:"",mongools:"",mongoli:"",kazachstan:"",oezbekistan:"",georgi:"",georgisch:"",armeens:"",armeni:"",servi:"",servisch:"",kroati:"",kroatisch:"",sloveni:"",sloveens:"",oostenrijk:"",zwitserland:"",luxemburg:"",letland:"",lets:"",litouwen:"",litouws:"",estland:"",ests:"",sanskriet:"",latijn:"",yiddisch:"",inuit:"",inuktitut:"",navajo:"",cherokee:"",quechua:"",guarani:"",maya:"",azteken:"",nahuatl:""};function fr(e){let t=e.toLowerCase().trim();if(ft[t])return ft[t];for(let[e,r]of Object.entries(ft))if(t.includes(e)||e.includes(t))return r;return""}e.s(["getCountryFlag",()=>fr],77560);var fn=e.i(43476),fi=e.i(71645),fs=function(){var e={base:"https://twemoji.maxcdn.com/v/14.0.2/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var t="string"==typeof e?parseInt(e,16):e;return t<65536?o(t):o(55296+((t-=65536)>>10),56320+(1023&t))},toCodePoint:p},onerror:function(){this.parentNode&&this.parentNode.replaceChild(u(this.alt,!1),this)},parse:function(t,n){var i;return n&&"function"!=typeof n||(n={callback:n}),("string"==typeof t?function(e,t){return f(e,function(e){var r,n,i=e,a=h(e),o=t.callback(a,t);if(a&&o){for(n in i="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'"',' src="',o,'"'),r=t.attributes(e,a))r.hasOwnProperty(n)&&0!==n.indexOf("on")&&-1===i.indexOf(" "+n+"=")&&(i=i.concat(" ",n,'="',r[n].replace(s,c),'"'));i=i.concat("/>")}return i})}:function(e,t){for(var n,i,s,o,l,c,d,f,p,g,m,y,w,v=function e(t,r){for(var n,i,s=t.childNodes,o=s.length;o--;)3===(i=(n=s[o]).nodeType)?r.push(n):1!==i||"ownerSVGElement"in n||a.test(n.nodeName.toLowerCase())||e(n,r);return r}(e,[]),b=v.length;b--;){for(s=!1,o=document.createDocumentFragment(),c=(l=v[b]).nodeValue,f=0;d=r.exec(c);){if((p=d.index)!==f&&o.appendChild(u(c.slice(f,p),!0)),y=h(m=d[0]),f=p+m.length,w=t.callback(y,t),y&&w){for(i in(g=new Image).onerror=t.onerror,g.setAttribute("draggable","false"),n=t.attributes(m,y))n.hasOwnProperty(i)&&0!==i.indexOf("on")&&!g.hasAttribute(i)&&g.setAttribute(i,n[i]);g.className=t.className,g.alt=m,g.src=w,s=!0,o.appendChild(g)}g||o.appendChild(u(m,!1)),g=null}s&&(f<c.length&&o.appendChild(u(c.slice(f),!0)),l.parentNode.replaceChild(o,l))}return e})(t,{callback:n.callback||l,attributes:"function"==typeof n.attributes?n.attributes:d,base:"string"==typeof n.base?n.base:e.base,ext:n.ext||e.ext,size:n.folder||("number"==typeof(i=n.size||e.size)?i+"x"+i:i),className:n.className||e.className,onerror:n.onerror||e.onerror})},replace:f,test:function(e){r.lastIndex=0;var t=r.test(e);return r.lastIndex=0,t}},t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},r=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef0-\udef6]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedd-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7c\ude80-\ude86\ude90-\udeac\udeb0-\udeba\udec0-\udec2\uded0-\uded9\udee0-\udee7]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,n=/\uFE0F/g,i=String.fromCharCode(8205),s=/[&<>'"]/g,a=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,o=String.fromCharCode;return e;function u(e,t){return document.createTextNode(t?e.replace(n,""):e)}function l(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function h(e){return p(0>e.indexOf(i)?e.replace(n,""):e)}function c(e){return t[e]}function d(){return null}function f(e,t){return String(e).replace(r,t)}function p(e,t){for(var r=[],n=0,i=0,s=0;s<e.length;)n=e.charCodeAt(s++),i?(r.push((65536+(i-55296<<10)+(n-56320)).toString(16)),i=0):55296<=n&&n<=56319?i=n:r.push(n.toString(16));return r.join(t||"-")}}();function fa({emoji:e,className:t=""}){let r=(0,fi.useRef)(null);return(0,fi.useEffect)(()=>{r.current&&fs.parse(r.current,{folder:"svg",ext:".svg",base:"https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/"})},[e]),(0,fn.jsx)("span",{ref:r,className:`inline-flex items-center [&_img]:h-[1em] [&_img]:w-auto [&_img]:align-middle ${t}`,children:e})}e.s(["default",()=>fa],47104)}]);